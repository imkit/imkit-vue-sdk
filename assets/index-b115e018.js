var jt=Object.defineProperty;var Dt=(s,e,o)=>e in s?jt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o;var I=(s,e,o)=>(Dt(s,typeof e!="symbol"?e+"":e,o),o);import{d as L,r as Xt,o as i,c as u,a as j,u as v,W as Wt,F as N,A as zt,b as we,e as W,f as se,v as Ge,g as he,h as S,i as D,w as te,j as c,t as f,I as be,k as de,l as re,G as Ae,m as ae,n as Z,p as J,q as w,s as ee,x as ke,y as K,z as A,B as qe,C as mt,D as Jt,E as Ue,V as Ye,H as $e,J as gt,K as fe,L as ve,T as Oe,M as Qe,N as je,O as Ht,P as Zt,Q as De,R as pt,S as At,U as qt,X as He,Y as Le,Z as $t,_ as es,$ as ts,a0 as ss,a1 as os,a2 as as,a3 as ht,a4 as at,a5 as ns,a6 as rs,a7 as ls,a8 as is,a9 as cs,aa as nt,ab as ds,ac as us,ad as ms,ae as gs,af as ps,ag as As,ah as hs}from"./vendor-829a7e11.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function o(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(a){if(a.ep)return;a.ep=!0;const n=o(a);fetch(a.href,n)}})();const fs=L({__name:"App",setup(s){return(e,o)=>{const t=Xt("router-view");return i(),u(N,null,[j(t),j(v(Wt))],64)}}});const ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAExElEQVR4nO2bS4hcRRSGa4yOGkUMKKKiID6yUbIRH7iI7hSiQWV0IwYXtn2rbj9OtaMBF/+5PTPEGNQZIQufCxUkAQVFRIwustfBx8ZkY1ATVCRO8DE+xiinOyNOcuvenqT71u2Z+uBup/7+63XqnDNKBQKBQCAQCAQCPqjVpi6MbTKmCc9py3uM5a8M4bCxOGos/6otftCEWW35DU08bpq4fmxs9xq1kgEwGhMeEEM08d/G8j/L+3BIE+8wFteolQSA041lYwhfL9+UE79j5u6qNtrr1bCjW8mNhvizfhiTYtQfhniqVps5Uw0hI8Zyo/MjBmDOEqMsf6IJV6lhYWxs9xpD/PKgjVnyEQ7HzeQWVXYqlefP0MRv97hFvjGWd8aW7zfUvi7aum2drLxKBWvNOC6JKLlNbjBN+MBYLOT/PfwSUbJRlZgRQ3g1f7Z5b9xK7gBwWq9/uNKcvFjOG0OYy1lJczG1N6gyEls8ln1W4LuohXtOZYx6feoiiY1yTDpwbDWW7Lay+DNj+c9GduKyfo1nLGzWttMWb6kyxTna4tOMGX231dpxTr/H1YTbDfG8e9zkblUGIoLOWjmDMGcRicyztppE78onAEZdEbKcOfU6Lh+0Bk28PeOmfFj5JM6cweTe4kIL7E/XgS/ldlW+0N2XeOpVXqQOyQw4J6qR3Kx8pSy041UucU7BckbkyZG+1flZ5QPdxH2OZf2tj9yNthw5zsLPi9bSQZJdjmW9U3mgE213E27HT9hRL4Gjdpw/8rYqXMyiJuJ9pTmHjKRJU8RUW7hWeUIi6DRNEeFBD2L4pzQxjQbOV54wlmcc275RuBhN/FeaGHl6FC7mP02YdBj0RPFiLH5LE0P09NnKE8biKUdc9njxYoi/TxPzCE1eqjyhLV5yxEJR8WIIs6mz1cKtyhMSwTtis02Fi9GOxJUkzgoX03mTYa1r29fH21cXLkhLxTN9Oe/xknZpJnem6iE+6EOPknKwYzkvSFRbuB5XJYXwuvJW3rE45Lg1porUIulcZ3aR+CHlC92plafO2pwk2IvSYSxecGz3I7UazlO+qDba610pDznEi9AQE25wFgwIzyjfGMu7HNGrnEd2kGNXLC5wN0VgIW5NXKF8U+2uIkcNHgtSfRjEuNK0YAgfuieHZ1RZMFL1dAklnpfc9QCymR+5x8QBrXGuKgu17mx+nDGbEo9slwR7f1pqsnuNdDPZrMpG7dGJK7XFj9kmYb8k2E+m0iAlJE38oiuLcNw475Wyb6hKuEm6LHrq6bEc5QWUnU4Pi7skCNQWv+f93aEwKaJkY24XxtKtt88Qv6kJ09riSfk6UTHxXtfbauhNiqm9QQ7KU/lx/fpKa1K0dds6V464b5/cVs1ks5gwlCYJ0mXR/9XUaX2ZWbzK5ccPtUkARqWRwFmW6XW7WD4iz4e0CHnoTVpEalRSDjbEX6QX+k44xA9qy6/Jqzzv4bliTPr/OSWGmSZvkdKMJNfl65aRselk2ntXnEkD61uyeCfHpPe3AGep1QqCSfkEk3ogmNQD4eDun0nTajVTyzfpZ69Nn6U3iXh+Of9DsupM0hav+NZWNpOmZVvJyhFzSpXHLhFy5qzucycQCAQCgUBA9ca/01SgfkYyM0gAAAAASUVORK5CYII=",et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFSElEQVR4nO1azW9bRRBfia8jggKlfPSAACFF4f8AKkQ/0lYFxAFw6lnHeMYNCRdmbJqkEtAol6KKK4iqd+DAAYFEKyq+BEJUcKINLVAqoCQF0jageXYav33P4a3f87Mj/JNWSuzd2R3v7MxvdtaYAQYYYIAB/qew43wHVOVJIJkFlPct8Ukg+dWS/KMNSH4HlG+A5D2LfLBEsqtQ2b/JrCdYO73BEpNF/sQSL68ol7QByhWL8pElea4wceBG068Yxf13WuRDFuVPXyXXaH9YkrlyeWqj6Rcw8/UWWYD4YoaKhhvyBSCeLBQOX9dTZS3Wh4H4y/aL5ctAfMyiTBWrvA0q9aHi5MxNunBt+nfwWZW3aR8gOR6YdHvFT1ji+3uibIlkFyAvtFnYKYsyoWbuK3fseb5LdxNQTrc3c95i8gQgl+McEhD/bKtcUDPP5KhUeK9FORdnOfqdyQMWuRLrXUneROSbM5/PTm8AkrdilF4uoTxtugmo8o7oGeMlS/xM961KRhtzhXe6RPxYNx3UReeXXixVaw+ZnADID+ucjr/4rTxevy/TicbG5m6IemNeylPZFRSrtUfcnQbkz5j52swmAZJazBnquhm3Q+DMogytmonwcpk3R0wZ+Q3TYwDyETdcwT6+PQPB8roberrhjX1RIL4FiH9xdvnlVEL3Vvm2CDeucsH0CYrI4JzlBWVvHQu0KBMug8qCVGTqTB1GBiTFjgVaks/DCstE4rFY2wrEP1rieYu17Qn6b7fEZ7SpJ046j9JQR+HjphMUK3yPG+R9uLFF+SlEBZH3tO/Le4I+q2fxh8TrpJfuDpMhXh4bm7o16firsBV5ynFWx4wHwgpfVXp3tB/vblW22XfeZy4g+bh1fIlqIz7jAwDKYcecp4wHdFJXEUC5pFlWOOOSS9Ef5r+PQCssyozjaw76jA9gUT4IC6ltNZ6ACu+MUwhIHm/y8sh3JeQnvOep8g4nJr/tK8MAyfeh3anUh7yFNE3WVUz/j/sszuSTzVEfdsLTtx0IkVD8TUM24k23val3QkKc43fOW4h1Evy08bdhdm56t2riaeOx42D/8hIwMnL0GndhqRWOPc9N867wzp4qrHDvq9KZdG1kLZPu1Flla9LIp9ar07Ik33kLAeIPexGWtDSTNiwB8jud7Mwh51xM+40PuHEuxAOID4TXKrM+4wPojWAaUm5Rzqaglmf85tIL+tbj14ETLJd5s7M7V/SSPPEigsyns+TBR+HgRsZJHjSPTzo+BIvylWPWkyYhtDqwku75poc+lQWL8kIaSwwBUMadXT7dbxcAQb7dska9BelYYLk8tRFQ/g6dr7xKHAkAyCXHOy9opSKdUJLXHJM5r4He9EPhPVJ34ldSCy6r83ISCa31mB4DiI+GeQJfyOSaVmGRX4zhwKOmR7AktmsX8S23g1875rOktR6TM9SDR2gpyaeZvw6ASn0opgC+mKfSjVAXLqY1XgLxvV2ZsNSggtFyaQ6eW804loYSP5prKLCrIeFIN7y3XrlGHFSTUQHKsyavJw8Q8/hEaz0a+PXMZ+M3uKRhMEbZy7kpu4JGetfmUQvxvNJQvSQ3ntAxDboYZlCtZ7brZtwOJeIHgPiLeKUbCUdwSY4yE+SsWB/WmxOlp9r07+I+fjD48TTFQz6x1rMl9cZdc1BJoeFAnwlq4G+30Azaoj5+6yceb4KnhyRzkTcYKZoeGUB5NTMG1bVCtTo1p96TvPGypngahvqh8O6dbQWxm2TWkrzbfD58XjOwoAUemE/qd9pH+3acvA8wwAADDGDWP/4FAPVu0JK6ZhcAAAAASUVORK5CYII=",vs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFGklEQVR4nO2ca4hbVRDHz64rWuoLfNTWZCZd496ZVHbRbGZuVksQQRfEgh+sIvWTVPCLYhE/rfih+KIIVkRRKmgtgoqKVqwfRBRFxEJ9oKJQtfVVrM8WrA9cV84mWeM2ySYn99zN5uYPh4Vlyf753Zk5jzk3xvTVV19NlM1OHoe5wpnGmMFmf5dEDQDLrcByGFlnkHX3itHR5YttqmuEpNsqYGqG3L3YvrpCSHLz0XBmAX2T+FTLrJExIP2zPiCdQSoUTZILMrB80BAO60ya9SaTVCHpPc3glCNIt5kkKs2yFln+bgHQuyZpGh4tnmEL8IJwWGeA9ZBJlq48BklfbQVOdZyeK51gEqKB+uud5iOVC7MmCULSLe3CKc9kstb0flrJVhc4ZUDhetOrCoKJE5H1JVc4lUJ9o+lFIUmIpB91AmcWEOltppc0PJw/uZxSLaxzWho9smldMTq63G48gfRANGDmxgNmKQsoPB9J7keSnyIGU61Bj5mlpFQuzGJQuAZIHwLS/T6g/G+QPhOV9wH7NDOsVwHp9S4DuXhe9cPSQXg5kN4BJA8Cy7NA+l7NiV9sA0h2dQpmEFlvQNKvIwjnqeqHIsmOuGHUjyB505lMKhUuQ9adEeb7VNcBYt3tDAhYn4w0nLn7ANnUdoKDuXAycjPcfYCQ5UM3QB0u4XGpACL92IXPALIcSQIgYP2stua21OlYOZI/zZOZqW4DhCR7q55gJLwASPbYn00BnZWVVFIAAcuX/3kqFCu/+yMTFC7tA+LZWeyrKogMq9Y8zEPpYGJV4iMIWb+rQlidC2VedN2beEBA8n0VQjoojM9Lwc/7gFgOzhVp0vw8QP+YUmko2UWa9ECjFEPWaXvmnWhAWL7lcVSRLsOTT+qmGI6NnZLEWQwr03wNoNsbTvU+TvCgy9dBEBQnauDsy2blpMaAWB9P2ko6ndMLK1G1H84ZHzbNlKLxc6PrHOiS2IvNFmnSLauocGpTOHMhxzrV84CoQSFuUQO2UNn1APYoINt8NJ3KrjCB9PlOj0C6EZC9pmeivPeXXjNxtl1xuo38ytoal87pOmC5Fkk32Qae7TB4aAz6O5NeLA3n8gCsG5DkKbur9hpBpG+YpaxUKlxmowxY3/aTYvpKpIYzJJcgyc8uo+nKtAUBFy4GknciBvRcdHRMpVdG+puTIZKtEVgYBNKNwPprJJBIdpiohSQvOBp6ODIPgWaiiSZ5xEQtYLnO7Wnp9ih9lDu/8mKHEXSf8THLoBugpyM3UyoNAemjHdSgO40PAck+B0M7PV4B3u740DZ5cYQkTzjk+1tezBhj8vn8scD6mkMEbfBiCEg3Opj51HiU3YUj6xdt+cqFk17M4EiRHEL6R+NZtivazjGN3QL58jLosBaZtqlgPAtJNrfqyU443oyAQ86vpsKI8a3yzPZ+C9Hzl9cHhg7vR9i7iSYGVc6Xp30eli0oJL26/ULdoJ3rQfaCaKz7sLpXdtsH9DsGcpGJ61Y+y7cN/ZBs9u1hAEh/cYB0OBOMByYGAclljY6MY3kVCtt8w68m//fE9d663U7UeUgH67aVF+XtYm5QsHO6zsSjwYrPuaJtN9yx/Oc0h+tdAcX9WnaGi4hUuML24GP7pxhoxhUQsLxukiAk2etYh142yf4CEV0ogu4ySVDeHjWQ7GoT0A8NL0n2pEqlIWC5xV4GaA5GjtgubSx7sm4VYul4O2PYKyS1o/z1WDGsPfrqy3Sj/gV9hWpJG54kuwAAAABJRU5ErkJggg==",vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEJ0lEQVR4nO2bS4wbRRCGew3hJSQEKELZeKqdxcFVYyKQBldNlpX2BlwCOYQrF5QDSsIjVxRtlAiExOPChTPixhkkOAQukAVlw0uC5cBTKDxyIomWiEeM2rEQbNzttteemV76l/rmnun+XF011dWtVFRUVFRUVFRUVFRUVFTl1Gw+cC2k+SFAXtYoFzRJdwPtL038g0Z5tdHmu1Toqu/MtwPKxxuEYmn8p0Y5rIK2HJwWnP+0oypEAcnjBcAJFxIgf1AgoC4Qv6jUw1epUKSRzxcJqA/pkwT5ke1NrlceVtFwdFEN5QKQnATkg2maXhMBkcNikU8nrfnZaEHksipeGcuSSl8KVKDvQz4QAZEDEMnJCIhcjpvPR0DkXmYREEVA3Y046mhBFAF1owXR9L6F4hKjCKgbLYjiEuuWlY9FH0QRUDdaELkycr4IJCcA5Ygm3qvbQrBr4eYsy7aYCk2zubA1oU4bUt6niY9p4vd6paf/wRI7BSj75+aym0ad4yx2bu0XRT/fhIB4pYF8n5qMZjYRIF4zNbvSqx7lg5ArGpCs1lv5LlUFlQ1Dr28oHxpHq6qiSlkO8vLWdPFGr3Gnnbs1ydOA/AagfKRJzgDKj6YoCchvAvISoGRj+Z0qAgKSVRNtnINdXLwaiB/VJF/7Q5fvNclj5jMgYEC8NsznNFqd+w3EDbznq6SV7wkSEPSilVUzGvm4Jrk0gXddAuIXlFK1gADxiiOUzwDKKxN/J/Jr3pDKBtRwfAT2LWdaVvtSCIBOuXyO17JC/sPkZeYoDWC2zRz3A+LfPK13b6UBAcp+e7SSL8c9tZaQPOFnRfyNSXArCQiIL9oSTwPO9zlJe/729f3raX6Lr1MfEiDKBCQnLEOaAeRvfZ9Tr+fXD54Xr3k+44wz3ysNEMoRi/VkozxnAoC60No9XzlASSoPWsZztHBAKM9YAQHxuVIgtYUGj0feGhatrJOxzXFIdAPidxydebkMQLa8SxN/Oq0z1rboZiKmC9DBMgDZzgsC8S++0WpU2aIbkPxq7WQGCsiniwa0LctuGDQeTXJ24L+885656QHic86OSWt+tmhIc2kGFkCfDQSEvDStaxfOJbbOkg4AyftFnL7vb2YNAMRvW37/u9kgMzeTRgWz4065TSM/5XDS76pQpHu1rILDPMmzKhTtSHMuHNAd+b0qINV6txULAgTIP5VeWhpVxhd6//sDotsoyapGflKFpizLtpg9ZE8LWBr3kiCgfKf14nUqRCWtfI+PFfw7ug2LVlf0TXmfClka5flRHPaI7WW1CVQzV8snDgfl9eAcs0M1U6qZUNmnbzmbB84/ahA/ZPaQxwVjKqzB+xyvdCjND5ltUn8w/LNx3MFGKzWeaho7u02KYDa7gPiL3sbf5Yu8qya30sTPJaks+C6nvwHqSkKcY2gfKAAAAABJRU5ErkJggg==",ys="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsBAMAAAB9SEr+AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAbUExURUdwTP///////////////////////////////xb9HQ4AAAAIdFJOUwCAvz5nE+qvkBVomAAAAT1JREFUWMPtl70LwjAQxatWXP0aHHUQOlZxcFRcHIuIriIOHV0ER6ui+bMl2ErvcmlCEKQxb+tLf5RqLu/V85yc7NKkBRS+3docuB1MrRjUM+JuPUD2CWFntM763G1g9wqpGl5nN25PBTsEWEVYv3O7J9gzBZbQWLOk2CD7V4M8ds3ctgT7WL08ltD3OMxhDvsFZjjdlh54Po0tFZhh4ng4/9iRu1XsPlEsbnH+vdMUp+UQp/AIhHQ3y26Y6AvXcayuaqnW3Yim6KqWzUfMDjRGV7VUU3HrFw5Objz6FCapaqn49U4PSxB2KTcmHuZamBgdVmPjGJ6eoRbmF205ObbB2CPSwZY6Xx105Ctj8WtPM3w3w1/SG0NqH/7ZVjacbksPPL8Qi2WYYeJIqpoq3yRVTZmmkqqmym4np5LrBeYgWB5+6q94AAAAAElFTkSuQmCC";class pe{constructor(e){I(this,"id");I(this,"nickname");I(this,"avatarUrl");I(this,"country");I(this,"city");const{_id:o,nickname:t,avatarUrl:a,country:n,city:r}=e;this.id=o,this.nickname=t??o,this.avatarUrl=a,this.country=n??null,this.city=r??null}}var F=(s=>(s.Text="text",s.Image="image",s.Sticker="sticker",s.Video="video",s.File="file",s.Template="template",s.Flex="flex",s.Location="location",s.Audio="audio",s.Recall="recall",s.JoinRoom="joinRoom",s.LeaveRoom="leaveRoom",s.AddMember="addMember",s.DeleteMember="deleteMember",s.AddMembers="addMembers",s.Announcement="announcement",s))(F||{});class H{constructor(e){I(this,"id");I(this,"roomId");I(this,"senderId");I(this,"type");I(this,"createdAt");I(this,"updatedAt");I(this,"groupId");const{_id:o,room:t,sender:a,messageType:n,createdAtMS:r,updatedAtMS:l,extra:d}=e;this.id=o,this.roomId=t,this.senderId=(a==null?void 0:a._id)||"",n==="line"?this.type=d.type:this.type=n,this.createdAt=r,this.updatedAt=l,this.groupId=`${se(r).startOf("minute").unix()}-${this.senderId}`}_string(e,o){var n;const{t}=we();let a=t("message");switch(this.type){case"image":a=t("image");break;case"sticker":a=t("sticker");break;case"video":a=t("video");break;case"file":a=t("file");break;case"location":a=t("location");break;case"audio":a=t("audio");break}return this.senderId===e?t("youSent",[a]):t("someoneSent",[((n=o[this.senderId])==null?void 0:n.nickname)??"",a])}get string(){const{state:{imkit:{uid:e,users:o}}}=W();return this._string(e,o)}get isIncoming(){const{state:{imkit:{uid:e}}}=W();return this.senderId!==e}get isOutgoing(){const{state:{imkit:{uid:e}}}=W();return this.senderId===e}static fromRaw(e){if(!e)return null;switch(e.messageType){case"text":return new _e(e);case"image":return new ks(e);case"sticker":return new rt(e);case"video":return new ws(e);case"file":return new Is(e);case"template":return new bs(e);case"flex":return new xs(e);case"location":return new Cs(e);case"audio":return new Rs(e);case"announcement":return new _e(e);case"addMember":return new We(e);case"deleteMember":return new We(e);case"addMembers":return new We(e);case"line":switch(e.extra!=="object"&&(e.extra=JSON.parse(e.extra)),e.extra.type){case"sticker":return new rt(e);default:return new H(e)}default:return new H(e)}}static fromPayload(e,o){const t=Date.now(),{roomId:a}=e,n={_id:Ge(),room:a,sender:{_id:o},createdAtMS:t,updatedAtMS:t,...e};return H.fromRaw(n)}}const Re=class Re extends H{constructor(o){super(o);I(this,"text");I(this,"translatedText");I(this,"replyId");I(this,"urls");I(this,"html");const{message:t,reply:a}=o;this.text=t??"",this.translatedText=null,this.replyId=(a==null?void 0:a._id)??null;try{this.urls=Array.from(new Set(Re.autolinker.parse(t).map(n=>n.getUrl()))),this.html=Re.autolinker.link(t.replaceAll(`
`,"<br>"))}catch(n){this.urls=[],this.html="",console.log(o),console.error(n)}}get string(){return this.text}static linkfy(o){try{return Re.autolinker.link(o.replaceAll(`
`,"<br>"))}catch(t){return console.error(t),o}}};I(Re,"autolinker",new zt({className:"underline",email:!1,phone:!1,stripPrefix:!1,stripTrailingSlash:!1}));let _e=Re;class ks extends H{constructor(o){super(o);I(this,"images");const{images:t,width:a,height:n,thumbnailUrl:r,originalUrl:l}=o;t&&t.length>0?this.images=t:this.images=[{id:l,width:a,height:n,thumbnailUrl:r,originalUrl:l}]}}class rt extends H{constructor(o){super(o);I(this,"stickerId");I(this,"stickerUrl");const{sticker:t,extra:a}=o;t?(this.stickerId=t,this.stickerUrl=""):(this.stickerId="",this.stickerUrl=`https://stickershop.line-scdn.net/stickershop/v1/sticker/${a.stickerId}/ios/sticker.png`)}}class ws extends H{constructor(o){super(o);I(this,"video");const{id:t,width:a,height:n,thumbnailUrl:r,originalUrl:l,duration:d,thumbnailFile:g,video:p}=o;p?this.video=p:this.video={id:t||l,width:a,height:n,thumbnailUrl:r,originalUrl:l,duration:d,thumbnailFile:g}}}var ye=(s=>(s.Buttons="buttons",s.Confirm="confirm",s.Carousel="carousel",s.ImageCarousel="image_carousel",s))(ye||{});class bs extends H{constructor(o){super(o);I(this,"template");I(this,"templateType");const{template:t}=o;try{this.template=typeof t=="object"?t:JSON.parse(t);const{type:a}=this.template;this.templateType=a}catch(a){console.log(o),console.error(a),this.template={},this.templateType="buttons"}}}var Ze=(s=>(s.Bubble="bubble",s.Carousel="carousel",s))(Ze||{});class xs extends H{constructor(o){super(o);I(this,"contents");I(this,"flexType");const{contents:t}=o;try{this.contents=typeof t=="object"?t:JSON.parse(t);const{type:a}=this.contents;this.flexType=a}catch(a){console.log(o),console.error(a),this.contents={},this.flexType="bubble"}}}class Cs extends H{constructor(o){super(o);I(this,"address");I(this,"latitude");I(this,"longitude");const{message:t,latitude:a,longitude:n}=o;this.address=t,this.latitude=a,this.longitude=n}}class We extends H{constructor(o){super(o);I(this,"members");switch(o.messageType){case"addMember":this.members=[new pe(o.member)];break;case"deleteMember":this.members=o.extra.members.map(t=>new pe(t));break;case"addMembers":this.members=o.extra.invitees.map(t=>new pe(t));break;default:this.members=[]}}}class Is extends H{constructor(o){super(o);I(this,"url");I(this,"mimeType");I(this,"fileName");I(this,"bytes");I(this,"fileExtension");const{originalUrl:t,extra:a}=o;this.url=t;const{mimeType:n,fileName:r,bytes:l,fileExtension:d}=typeof a=="object"?a:JSON.parse(a);this.mimeType=n,this.fileName=r,this.bytes=l,this.fileExtension=d}}class Rs extends H{constructor(o){super(o);I(this,"url");I(this,"mimeType");I(this,"fileName");I(this,"bytes");I(this,"fileExtension");I(this,"duration");const{originalUrl:t,extra:a,duration:n}=o;this.url=t;const{mimeType:r,fileName:l,bytes:d,fileExtension:g}=typeof a=="object"?a:JSON.parse(a);this.mimeType=r,this.fileName=l,this.bytes=d,this.fileExtension=g,this.duration=n}}var yt=(s=>(s.Direct="direct",s.Group="group",s))(yt||{});class Te{constructor(e){I(this,"id");I(this,"name");I(this,"type");I(this,"createdAt");I(this,"updatedAt");I(this,"memberIds");I(this,"coverUrl");I(this,"lastMessage");I(this,"numberOfUnread");I(this,"lastReadMessageId");I(this,"pref");I(this,"roomTags");I(this,"extra");var y;const{_id:o,name:t,roomType:a,createdTimeMS:n,lastMessage:r,members:l,cover:d,unread:g,memberProperties:p,extParams:m,pref:h,roomTags:C}=e;if(this.id=o,this.name=t,this.type=a||"direct",this.createdAt=n,this.lastMessage=H.fromRaw(r),this.updatedAt=((y=this.lastMessage)==null?void 0:y.createdAt)??n,this.memberIds=l.map(M=>M._id),this.coverUrl=d??"",this.numberOfUnread=g??0,this.lastReadMessageId={},this.pref=h,this.roomTags=C??[],p)for(const{client:M,lastRead:E}of p)this.lastReadMessageId[M]=E;try{this.extra=JSON.parse(m)}catch{this.extra={}}a==="custom"&&(this.type=this.extra.roomType)}_displayName(e,o){if(this.name)return this.name;if(this.memberIds.filter(t=>t!==e).length===0){const{t}=we();return t("emptyChat")}else{if(this.type=="direct")return this.memberIds.filter(t=>t!==e).map(t=>o[t])[0].nickname;if(this.type=="group")return this.memberIds.filter(t=>t!==e).map(t=>o[t].nickname).join(", ")}return""}get displayName(){const{state:{imkit:{uid:e,users:o}}}=W();return this._displayName(e,o)}get avatars(){const{state:{imkit:{uid:e,users:o}}}=W();return this.coverUrl&&this.coverUrl.length>0?[{url:this.coverUrl,name:this.displayName??""}]:this.type=="direct"&&this.memberIds.filter(t=>t!==e).length===1?this.memberIds.filter(t=>t!==e).map(t=>({url:o[t].avatarUrl??"",name:o[t].nickname??""})):this.type=="group"&&this.memberIds.length>=1?this.memberIds.map(t=>o[t]).sort((t,a)=>t.id===e?1:a.id===e?-1:(a.avatarUrl??"").length-(t.avatarUrl??"").length).map(t=>({url:t.avatarUrl??"",name:t.nickname??""})):[{url:"",name:this.displayName??""}]}}const kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADQUlEQVR4nO2bu2sUURSHz4CISlR8pNi4e24S151zx0ez2XMmD1gROxEVEcRHIYJYCPaCna9CBBULK/uUAUX0D1Ax4gpa2EUbg6CkMaiIyjWKSdjsIzs7z/vBVFvsnW9/587cc+8CWCwWi8ViscQL5cpu1PJQaZ5Ad3gk6vHEijwN7VCaZ5WWX+ZCkm/9mg9EPa54UK2uUFqe/5MzT9J3pfkgZB0kvrRYjpX0FyQpzyWlvqBMJ0mp6ipF8rqRnExLUsS3WpGTSUno8R6l5Wc7gjIjqVjkdUg81a6cBZKocgjSCmq+t1w5qZdUcP39ncpJraRcqbwZST4EJSh1khTJeJByUiUJtZzohpxUSCq4I32K+FM3BSVZkjPXwuiunPmSsOSPQlLALpdW/YsnICkMDpbXI/HTMAUh8QNIEoOhSuLZfvKrod6g646sNd29gpbzqPmq0nIbSS6i5tMDJdkVF0mo+VWr4wkCxywKleZHpv3ZJNJTqOUGUjkXjST+gVqueJ63MhQzWPJHkfhZ2wMl+aI0X8uVy2vCkoRa3iqqDIcixoAkZ5p1+JpPklLr18MKGknS8qRDOaZVcrfXq/ZAWKArhwP7ZYmnTTu1G0lCkveo/b0QAU67Xb4m8Z8Z8Hxu2BdqN0kk43nP3wgR4sRREmr+GKdlhBMnSUh8v9kTMpOSUMuMeWhAjHEik0T8eOv2oQIkAAc13wlKkiL+3PTppvmk+V5IEE6YkpKKY9ZggZUb8XRSSihCSfKy0bIkqThBlptZZEIKcYJLEs/mt/lbIG0Ui2O9ZrINJkV8HdIE7hzboLRMBjgXvYO0gAHL+XeZM4qQkq3jWt2b7LTcPDkFaU0OktT+zEkdTdx8AdKYHCSpmc87fgUgvglpTE7uv5yOXgGQ5DJkQM6yJSHxOUhpWS1FW+WGxPsgA8lZVj8JNX8NdXciJnJalpSYvXQMXk5Lksy5RciwnIaSzA5u7LuHfVTZ1OGE3CoLJu65E2HsQ8aT0yBJlbMQZ/rCS85iHLPNDXEmn/dXK80vIpCTDBTJ0aXkmGRB1kHPP27lNKDXq/YokjfzJE3a5NST5FaOocdHzL//uhpZi8VisVgsFosFYs5vllNJQwrDPNkAAAAASUVORK5CYII=",Es="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVR4nO3WPQrCMBiA4W+yh/BcniABFyNIsrsnOPRS/kz1KlJ35SsdOkhtRaGp7wOB0pZ3CGlSEQAAAAAAAAAAJsC5sjA+bU2IZxviXUd77fTZrHrr3WFpQ7zakB6vhvGp0ndm0XOuLPpi3eiQmZx6T3SZvIt1opvce2J9ugwOhnjKvScmxHpEsM69J2OCNsRb7j35uyVtQ3Tf3BSm3pP2QK8GxKrVfr/IvdfQQ7sv+smPwpR7DZ0dXRL6HehG0WwWPh313uCZy6gHAAAAAAAAAID8wBNoenSqsgBAfQAAAABJRU5ErkJggg==",Fs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJklEQVR4nO2bu04bQRSG13kBJJQUCDPHcgye43SYnLMFr4HyCkiAKKDlJkGTtKFIHyoq8g5AmvAAQJHkDQINIKFFayMhEDu+7FqOZ/5POt1OMZ/O/Ls7OxtFAAAAAAAAAAAA8Ihqo2kMy7ph2SfWbyNVVr8Qf1ycrEl5IHKmWFeN1VtiTUa87g3rQa02/64wORXWT//BxJIiy1j9S3WtFCKIrFwOe0I0EElyXq02x/LJqWtl2BOhQZbVw1yCjI1nhz4JHngnLecQpE3vBbHcpPOEIHYtNbnsK49C6CDKk0dBCeI+8ig4QdxjHoUmiHrNoyAFcUvSURRFJQjinHkUbAdx633tjqzEEMTOLvpdbsTj6CB2dZP8yMyjkJcYPe+kpcAEybGxstUq1pOO11u5fnU30kdBxurGiyVTSkV1MW4vAEFynJEnJcN66hYkZ94LMlY2s+5IxLrtHMtyFYKgrf4F6T//BbGeZCyxN8bKT/d4+eW9IHrqomchTaw7XYzbDUIQtTvp9PHOtd25c9q3+fJ0PBmMIOpVaHgPitpD4VUjcXQOXlYpUw62O5IOuYMNM8oShC1XdcnBpj1lLSt89tH8uRPsc5DFp+ekkNwJrYNMvuMvOEDlBEfwuoCsXHi5tGwBhzhTTEMW/JOjfwo7BtyWFK+kYTbsiRVQ92Tl+8RM821UNO8/zE1RXdeI9esI/orwOf0V4dVdQQAAAAAAAAAAAET+8gBbyTNTzlJ3OgAAAABJRU5ErkJggg==",Ss="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOElEQVR4nO2bz2sUSRTHe6K7/jgIiyxozFQFHZ33OojoOO+NUchRA7q7Fw9ehM0ejR7iwt7UgwcNCOqfkL/Do7/BX+BlYTHir+hZYY3rzsjrnsiYVFfPD2e6OtQXGoaZ7p6qT7/36tWr6iDw8vLy8vLy8vLy8vLyck6l0pF1KqydVkB3NfAHjdzo4fhfI73SwHOjY7QnyLtGdta2KeDHPUJJOOizBp4Jcm050C843xwXgjxKIZ8ZAJz8QlJA9wYIqKGQrgTB8TVBXqSB3g8SUBPSkyLQyW0lGnEe1qDh6EEdwB8U8h0FNB2G4Y8eEFosFuhhsTw+7C0IbVZFD7qypMxdAQcY+4BOeUBoAYR8xwNCW+Cm9x4Q2t3MA0IPqNFLoPYWhB5Qw1sQ9i8X8i6GHlDDWxB6F2tkNR/zMQg9oIa3ILSVLHhRA99QQOeL5doxPcaodh/6KZiYWDsyUtsgZVxZi9NAJzTQ1Xidj/5b9S6mgB4qpD8iGJ32MaxuUcB/KeS/Vx0gBfx4tFw9HHwfFVYNIIX0rzz1zFc9HLWaFwq4ErigrGHo5Qfw/WGobg5ckVuWQ3dLJdqU1uZKpfKDgupRDXRNId9WQO8U8Kf4oHfynQaeVbtqB4MgGFodgID+KZUO/Zy20UKX+axA6MBdF+QauTa3gBTSR40H9trbSb8poOc9WOfzUaRf8wroT0sTC7IrRCPXv8N/1SXB7Gi4zxqOBn4qMSURDvBcH/5zrm1IWQMqhvyLpW0X+ma1QOecB6SQniQ9SYk5JreSeCXTjmgPZLqlvGxOUT4afq/bHo4bgICmjW3SE+vNAZluyn7KFohTps7H39HU0nkygZVrDefNp45u2QGiz0kJoQzLpk63wmlp/2QrpObnyeXnCSSjJaVtMM0Q0M3kJHBlniOuYulDBCkJzpIU8KOV9+UFazKZoXtdNHeiejQB6KuUBz1pg9NMF94Y21I+MO4eoJCOG9sDdN1idV/jSqeSWlLifYFnndrEqSMLqu0zd4RvJ1/Di1JF7BSO1JOkfNKpu8cNkpIkDh7Q9rCiEtpjnWelxZm0IG4GT29tgKazALS1Utlobg8vplpfm5DagbN0v8SbyMZGFSVeHlCiiuXx4UFDyo2LLbOkU3Gxqf+BO6mkag3SHcJpH5IlSLsmDTyb2JGQf+/6vkhTXQ3zrkntqh3sU6IokF53nCg6qKGoTLrSJR9lMtVwURp4xhR/4reDupus7hjbXzSmEHl8G7Ikb0EizZuCaQukQrQU3Ua5Q+BopFsG93rWdTE/a0mB3VgwA16MXcUcT5YBfS3nJiSf9W6mLU7JiZKr4ypkXrTPgQqyiSF+F79nOHWNdCl3o1Y7kgK7OXC36VJI87mPOWmKlp6BZ0x5UnKs4QW5JrejVdCdhiT7jacldEsmm9HoFi8JvY1WMIAvNzPkttzpCzIGFAwMLQUoAAAAAElFTkSuQmCC",Ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsUlEQVR4nO3aS04CQRAGYNSLKEGNXmS0K72ZdIWlUsU95mYSjQY16BVcaOIdjIo2LgyRx4D9HOpP2LD5+6OHoemeVksikUgkEolEEjkF0qEydA+G3sDwhcb+Xqyx2G6FNLBjUUh3p93+gfMSQL4F5PHvi541cqcVOLbTdk+NxdDQdc+WQn6fBodHz8Qij+3YnJcppKu/4HDoedifGeZL54VQ9tpzCz2jF2Lt+2Wv7aW46J7tguGn2cX8qrp8FBrr/eoqAqKjY0Oik8GGQEN5vp8U1ifaYhXyS3JYH+jksS7R2WBdoLPD/gedLXYddPbYVdCNwdZZOFhoo7A1Z7pZ2NXRDcDWRzcIa7P4BuXuD0cu2HFj0FAfmz9ab9LPEtRYVMTYLvKSVVZQ2aNhjeVitmiN3Fn3e5kdWjvYcMsGrR3uLiaP1h62UpNFa4/7xsmhdYBN8mTQOuCJQHS0jnD8EQ0Nm3ZcCoaGMRf7S9A3TssQcQeQP2Nhlz7yYOijqqptp2WA/BgTuxhNI+dFJ9g7VoYfJjNt6NrbYwZ17yd2DJOrjkbRV2ASiUQikUgkku9P4AsjhYRlvSHnTwAAAABJRU5ErkJggg==",Bs={class:"relative"},Ms=c("img",{class:"w-4 h-4",src:Ee},null,-1),Us=[Ms],Ts=["src"],Os={key:1,class:"w-300px h-300px bg-gray-200 flex items-center justify-center text-150px font-600 text-gray-500"},Ls=L({__name:"AvatarModal",props:{url:{},name:{}},setup(s){const e=s,o=he(),t=S(!1);t.value=e.url.length===0;const a=()=>{t.value=!0};return(n,r)=>(i(),D(v(be),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl overflow-hidden flex flex-col gap-3 max-w-360px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[c("div",Bs,[c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7 ml-auto absolute top-2 right-2",onClick:r[0]||(r[0]=l=>v(o).closeAll())},Us),t.value?(i(),u("div",Os,f(n.name&&n.name.length>0?n.name.charAt(0).toUpperCase():""),1)):(i(),u("img",{key:0,src:n.url,class:"w-300px h-300px object-cover",onError:a},null,40,Ts))])]),_:1}))}}),_s=["src","onClick"],Qs=["onClick"],oe=L({__name:"AvatarView",props:{url:{},name:{}},setup(s){const e=s,o=S(!1);o.value=e.url.length===0;const t=()=>{o.value=!0};de(()=>[e.url,e.name],()=>{o.value=!1});const a=()=>{const{open:n}=Ae({component:Ls,attrs:{url:e.url,name:e.name}});n()};return(n,r)=>o.value?(i(),u("div",{key:1,class:"w-50px h-50px rounded-2xl bg-gray-200 flex items-center justify-center text-xl font-600 text-gray-500 cursor-pointer",onClick:re(a,["stop"])},f(n.name&&n.name.length>0?n.name.charAt(0).toUpperCase():""),9,Qs)):(i(),u("img",{key:0,src:n.url,class:"w-50px h-50px rounded-2xl object-cover cursor-pointer",onError:t,onClick:re(a,["stop"])},null,40,_s))}}),Vs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVR4nO2WQQ7CIBBFuZKa2o3deF/0ZKYmhvUzpBhbYpUZIZjIWxf+Z+ZTxphGYwVgAE7Azijxa4Gz30sjfmPiCvQK8S1wCXs44CgRdywZgU4g3oU1c1xSJZhK9ookEyviD2xq30aNiQ/iY3KegM2sfzE+E/sca7KZyC4u2biYuKCvqryI4P0py5z8CxP5xQUmyolXN0DNFlAzhNS8hiyfVO2PqC8mbp7f5jWBQDy7CWo/x/zAQDJUHck8wCEaSsV3OspE+lAaVcL6QBolIcxWPJY3/oo7tk8INpQnayAAAAAASUVORK5CYII=",Ks="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVR4nO2ayW4TQRCG+0DgTiRCFHNje4tcfTGZv0aN4yoncEADAhIOIMGRBwBC3gUlyhOwRAGOSIEnACMlcSSWyEHlcSSWhGjaPZs8v1SSZc9096dud1dXlTGVKlWqVGlEZe21s0TMRLIM8BrAm0TyFeAfaoPPm/qbPhOG0tJ3TJkUBHPjAC8CvE4k+27GbwBZ0LZMUQVIDeDnRLzrDvqnAdwl4iVr56dMURRF0RiR3ANkxxfoITO+C8jjer1+KldYa+USEb9PD/QfexcEcxdzgSVqh+nO6pGzvQ0IMobl60TyM3vYg/+27AUB38oEFpCbeYEeAr6QxTLeyxv095kmagepwFrbPg/wVt6Qh0DvELUue4a1JzPejZNCv9Xj0RswkTzKG+p4aH7gBdba+anY4/E1OH4Rtyk1IlnxubQBmRwaGH130evyqx20PTPTPOd5lp8OBRsEc+M+fWO1v/vwDNwd6sIB8KLPAaUNPIC+MwzwetmAieS1I6xMEkmvhMC9RmN2IjEwxZGK/RIC60nQdACW5RIDLyUGRhxnKimwrDgAy6eyAmtg0AW44+JBJe7o+HE4eGT8xaWj764elG8l98j4W+JOMILAnaQbRRrQMSyvJhzL58QdEcnHNDaUAm9aPFrHEo2a4xGG0iorcBjK1cTAjcbsxEhdHlSaxSsfML80rgJkoWzAgNweNtfbHZkQj0p3vPIE8eSJKV6YVvoemaMH9R/jbW/lEgA/9DkT6RjfN74URdGYpjMKDLvhNdVS9GSaViKYNAQIipYuBeSKSVNEHOUNOrAeIDdShS1SyYNWIpgsRdQO9CjIHpa3Ul/GR4modSHb3Zs3dPM0eWp6evqEFqalO9txYZpWIpiiCHEu6plPr0zb0pxvoQtOg35OuX0X4FeO9+meXvE07WmtPW3KJKB9RhNb8QWEVwH+oNFQDQEPrKPfxT51/5mmvpP3uCtVqlSpkslJvwD4sB37/slROAAAAABJRU5ErkJggg==",Ns={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},Ps=c("img",{class:"w-4 h-4",src:Ee},null,-1),Gs=[Ps],Ys={key:0,class:"flex flex-wrap gap-2 mt-1"},js=["onClick"],Ds={class:"overflow-ellipsis overflow-hidden whitespace-nowrap"},Xs=["onClick"],Ws={class:"bg-gray-100 divide-y rounded"},zs={class:"grid grid-cols-6 gap-3 p-3"},Js=["onClick"],Hs={class:"flex items-center justify-center p-3 gap-3"},Zs=["placeholder"],qs=["placeholder"],$s=["disabled"],eo=L({__name:"TagsModal",props:{roomId:{}},setup(s){const e=s,o=he(),t=W(),a=S([]),n=S({}),r=S([]),l=S({}),d=S(""),g=S("#60a5fa"),p=["#f43f5e","#f97316","#f59e0b","#84cc16","#10b981","#06b6d4","#0ea5e9","#6366f1","#8b5cf6","#6b7280","#64748B","#78716c"],m=U=>{t.dispatch("imkit/updateRoomPrefs",{roomId:U,prefs:{tags:a.value,tagColors:n.value}})},h=t.state.imkit.rooms[e.roomId];h.pref&&(a.value=[...h.pref.tags],r.value=[...h.pref.tags],n.value={...h.pref.tagColors},l.value={...h.pref.tagColors});const C=()=>{d.value&&(a.value.length>=5||(a.value.includes(d.value)||a.value.push(d.value),g.value.startsWith("#")&&(n.value[d.value]=g.value,d.value="")))},y=U=>{a.value=a.value.filter(R=>R!==U),delete n.value[U]},M=U=>{d.value=U,g.value=n.value[U]},E=()=>{g.value=g.value.replace(/[^#0-9a-fA-F]/g,""),g.value.charAt(0)!=="#"&&(g.value="#"+g.value)};return(U,R)=>(i(),D(v(be),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 max-w-360px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[c("div",Ns,[ae(f(U.$t("tag"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:R[0]||(R[0]=T=>v(o).closeAll())},Gs)]),a.value.length>0?(i(),u("div",Ys,[(i(!0),u(N,null,Z(a.value,T=>(i(),u("div",{key:T,class:"bg-blue-400 text-white text-base px-2 py-1 rounded-md flex items-center justify-center gap-1 cursor-pointer overflow-hidden",style:J({backgroundColor:n.value[T]}),onClick:O=>M(T)},[c("div",Ds,f(T),1),c("img",{width:"16",height:"16",src:Vs,onClick:re(O=>y(T),["stop"])},null,8,Xs)],12,js))),128))])):w("",!0),c("div",Ws,[c("div",zs,[(i(),u(N,null,Z(p,T=>c("div",{key:T,class:"w-10 h-10 rounded",style:J({backgroundColor:T}),onClick:O=>g.value=T},null,12,Js)),64))]),c("div",Hs,[ee(c("input",{type:"text",class:"rounded-md p-2 text-base text-white placeholder-white outline-none w-32 flex-grow",style:J({backgroundColor:g.value}),placeholder:U.$t("inputTag"),"onUpdate:modelValue":R[1]||(R[1]=T=>d.value=T)},null,12,Zs),[[ke,d.value]]),ee(c("input",{type:"text",class:"rounded-md p-2 text-base outline-none w-32 flex-grow",placeholder:U.$t("inputTagPlaceholder"),maxlength:"7",pattern:"^#[0-9a-fA-F]{6}$","onUpdate:modelValue":R[2]||(R[2]=T=>g.value=T),onInput:E},null,40,qs),[[ke,g.value]]),c("img",{class:K(["cursor-pointer",{"opacity-20 cursor-not-allowed":!d.value||a.value.length>=5}]),width:"30",height:"30",src:Ks,onClick:C},null,2)])]),c("button",{class:"text-base rounded-lg flex-grow bg-blue-400 text-white h-10 disabled:bg-blue-200 disabled:cursor-not-allowed",disabled:JSON.stringify([...a.value].sort())===JSON.stringify([...r.value].sort())&&JSON.stringify([...Object.values(n.value)].sort())===JSON.stringify([...Object.values(l.value)].sort()),onClick:R[3]||(R[3]=()=>{m(U.roomId),v(o).closeAll()})},f(U.$t("confirm")),9,$s)]),_:1}))}}),wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR4nO2asUrEQBCGp7PxEbSx8VnEFzG7Bp05sJ05rS18jDsEX8Pn8CxV9ArbkVVEUEJyJrhZ838wXYr92ORLM0QAAAAAGBWVXOwG0evIuo5i3mUC2yqwXYag21SerD12Ff0xrLd1fbVFpRDSzf5W9vO2xZRKIW7wGjcL62t1qntUArGnbPZhXQe2m6OT8/1pCH+JP6UeTUf449NaTkzYXiYlHMUcwgCA/0U1mx9G0fvif0lsq+PZ/KBVOD2Y+7CDDetdq3D2Qw48BOFv5L4R3LDglXZ8w4JoOSrdRO6qotKCSjsqLai0o9JN5K4qKi2otKPSgko7Kt1E7qqi0oJKOyotfSrN/ZdaRjOsz63CaSEk+0GHm0WrcNp+SQshIzhsrwmiD/WZ7tAGq4fLtCNRnuj7mRedZQEAAABAf8UbgvvRyv0JTvIAAAAASUVORK5CYII=",to={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},so=c("img",{class:"w-4 h-4",src:Ee},null,-1),oo=[so],ao=["onClick"],no=c("img",{width:"30",height:"30",src:wt},null,-1),ro=L({__name:"AddToFolderModal",props:{roomId:{}},setup(s){const e=s,o=he(),t=W(),a=A(()=>t.state.imkit.sortedFolderIds.map(r=>t.state.imkit.folders[r]).filter(r=>r)),n=r=>{e.roomId&&t.dispatch("imkit/addRoomToFolder",{roomId:e.roomId,folderId:r})};return(r,l)=>(i(),D(v(be),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 w-360px relative max-h-80vh overflow-y-auto","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[c("div",to,[ae(f(r.$t("addToFolder"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:l[0]||(l[0]=d=>v(o).closeAll())},oo)]),(i(!0),u(N,null,Z(a.value,d=>(i(),u("div",{key:d.id,class:"flex items-center p-2 gap-3 cursor-pointer rounded-lg bg-slate-200 relative group",onClick:()=>{n(d.id),v(o).closeAll()}},[no,ae(" "+f(d.name),1)],8,ao))),128))]),_:1}))}});var le=(s=>(s.RoomName="roomName",s.RoomMember="roomMember",s.RoomPrefTags="roomPrefTags",s.RoomPrefFolder="roomPrefFolder",s.RoomTags="roomTags",s))(le||{});const lo={class:"flex items-center justify-center gap-1.5"},io={key:0,class:"bg-slate-500 w-1 h-10 rounded-full ml-2 flex-shrink-0"},co={class:"h-50px w-50px relative flex-shrink-0"},uo={key:2,class:"absolute h-5 w-5 -right-1 -bottom-1 bg-slate-200 rounded-lg p-3px",src:kt},mo={class:"flex flex-col flex-grow text-left w-0 min-w-0"},go={class:"flex justify-between"},po=["innerHTML"],Ao={class:"text-xs text-gray-500 whitespace-nowrap"},ho=["innerHTML"],fo={key:0,class:"text-xs font-600 bg-blue-400 text-white rounded-full px-1.5 h-5 min-w-5 text-center leading-none flex items-center justify-center"},vo={key:0,class:"flex flex-wrap gap-1 mt-1"},yo=["onClick"],ko=c("img",{width:"20",height:"20",src:Es},null,-1),wo=[ko],bo={key:0,class:"absolute right-3 top-[calc(50%_+_28px)] p-1.5 bg-white z-10 rounded-lg shadow-md flex flex-col items-stretch gap-1"},xo=["onClick"],Co=c("img",{width:"24",height:"24",src:Fs},null,-1),Io=["onClick"],Ro=c("img",{width:"24",height:"24",src:kt},null,-1),Eo=["onClick"],Fo=c("img",{width:"24",height:"24",src:Ss},null,-1),So=["onClick"],Bo=c("img",{width:"24",height:"24",src:vt},null,-1),Mo=L({__name:"RoomCell",props:{source:{}},setup(s){const e=s;se.extend(qe),se.extend(mt);const o=A(()=>{let k=se(e.source.updatedAt);return k.isSame(se(),"day")?k.format("H:mm"):k.isYesterday()?"Yesterday":k.isSame(se(),"week")?k.format("dddd"):k.isSame(se(),"year")?k.format("MMM D"):k.format("ll")}),t=W(),a=A(()=>t.state.imkit.rooms[e.source.id]),n=A(()=>t.state.imkit.searchKeyword.length>0&&t.state.imkit.searchType===le.RoomName?a.value.displayName.replaceAll(t.state.imkit.searchKeyword,`<span class="text-blue-400">${t.state.imkit.searchKeyword}</span>`):a.value.displayName),r=A(()=>{var k;return t.state.imkit.searchKeyword.length>0&&t.state.imkit.searchType===le.RoomMember?[`<span class="text-blue-400">${t.state.imkit.searchKeyword}</span>`,...a.value.memberIds.map(V=>t.state.imkit.users[V]).filter(V=>V).map(V=>V.nickname||V.id).filter(V=>V!==t.state.imkit.searchKeyword)].join(", "):(k=a.value.lastMessage)==null?void 0:k.string}),l=A(()=>t.state.imkit.selectedRoomId===e.source.id),d=A(()=>!!t.state.imkit.roomIdsInFolders[e.source.id]),g=A(()=>t.state.imkit.actionMenuRoomId),p=A(()=>t.state.imkit.searchKeyword),m=A(()=>{var k;return((k=a.value.pref)==null?void 0:k.sticky)??!1}),h=A(()=>t.state.imkit.sortedFolderIds),C=()=>{const{open:k}=Ae({component:eo,attrs:{roomId:e.source.id}});k(),t.commit("imkit/setState",{actionMenuRoomId:""})},y=()=>{g.value===e.source.id?t.commit("imkit/setState",{actionMenuRoomId:""}):t.commit("imkit/setState",{actionMenuRoomId:e.source.id})},M=()=>{t.commit("imkit/setState",{selectedRoomId:e.source.id,actionMenuRoomId:""})},E=async()=>{await t.dispatch("imkit/updateRoomPrefs",{roomId:e.source.id,prefs:{sticky:!m.value}})},U=async()=>{await t.dispatch("imkit/removeRoomFromFolder",e.source.id)},R=async()=>{const{open:k}=Ae({component:ro,attrs:{roomId:e.source.id}});k()},T=S(null);return Jt(T,()=>{y()},{modifiers:{prevent:!0}}),(k,V)=>{var z,_;return i(),u("div",lo,[d.value&&!p.value?(i(),u("div",io)):w("",!0),c("div",{ref_key:"roomCellRef",ref:T,class:K(["select-none flex items-center p-2 gap-3 cursor-pointer rounded-lg min-h-66px flex-grow sm:hover:bg-gray-100 group relative",{"bg-gray-100":l.value}]),onClick:M},[c("div",co,[a.value.avatars.length===1?(i(),D(oe,{key:0,url:a.value.avatars[0].url,name:a.value.avatars[0].name,class:"relative"},null,8,["url","name"])):(i(),u(N,{key:1},[j(oe,{url:a.value.avatars[1].url,name:a.value.avatars[1].name,class:"h-36px w-36px text-16px absolute top-0 right-0"},null,8,["url","name"]),j(oe,{url:a.value.avatars[0].url,name:a.value.avatars[0].name,class:K(["h-38px w-38px text-16px absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100",{"border-gray-100":l.value}])},null,8,["url","name","class"])],64)),m.value?(i(),u("img",uo)):w("",!0)]),c("div",mo,[c("div",go,[c("div",{class:"text-base text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap",innerHTML:n.value},null,8,po),c("div",Ao,f(o.value),1)]),c("div",{class:K(["flex items-center justify-between",{"text-gray-800":a.value.numberOfUnread>0}])},[c("div",{class:"text-sm text-gray-500 overflow-ellipsis overflow-hidden whitespace-nowrap",innerHTML:r.value},null,8,ho),a.value.numberOfUnread>0&&!l.value?(i(),u("div",fo,f(a.value.numberOfUnread>99?"99+":a.value.numberOfUnread),1)):w("",!0)],2),(z=a.value.pref)!=null&&z.tags?(i(),u("div",vo,[(i(!0),u(N,null,Z(((_=a.value.pref)==null?void 0:_.tags)??[],P=>{var G;return i(),u("div",{key:P,class:"bg-blue-400 text-white text-xs px-1 py-0.5 rounded-md overflow-ellipsis overflow-hidden whitespace-nowrap",style:J({backgroundColor:(((G=a.value.pref)==null?void 0:G.tagColors)||{})[P]})},f(P),5)}),128))])):w("",!0)]),c("div",{class:K(["absolute right-4 w-10 h-10 rounded-full bg-white shadow-md items-center justify-center hidden sm:group-hover:flex hover:scale-110 hover:transform hover:transition",{"!flex":g.value==k.source.id}]),onClick:re(y,["stop"])},wo,10,yo),g.value==k.source.id?ee((i(),u("div",bo,[c("div",{class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:re(C,["stop"])},[Co,ae(" "+f(k.$t("tag")),1)],8,xo),c("div",{class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:re(E,["stop"])},[Ro,ae(" "+f(m.value?k.$t("unpin"):k.$t("pin")),1)],8,Io),d.value?(i(),u("div",{key:0,class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:re(U,["stop"])},[Fo,ae(" "+f(k.$t("removeFromFolder")),1)],8,Eo)):h.value.length>0?(i(),u("div",{key:1,class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:re(R,["stop"])},[Bo,ae(" "+f(k.$t("addToFolder")),1)],8,So)):w("",!0)])),[[v(Ue),()=>{v(t).commit("imkit/setState",{actionMenuRoomId:""})}]]):w("",!0)],2)])}}}),Uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB60lEQVR4nO2Zzy4EQRCH2wUHJ3F1IeLIwZ9n4B1wE9u9i6rhXLWLo+DGKwiReAESBw/AGxAnJEhcSFZmiUhmd3uYpvVMfcnvXl9qZnp+M0oJgiAIgvAvKeFav0Y6MECPBrmeJhr4SgNvak09KjxZvksrmhBHPq9UdrpUKOh4sz+U/SJNKhTMNy7j1sL0XFqmARUCJqPsnwfoUQMfLSzVhoshjJ/i9/HzpzjC2LiV9gsmzA+FEjbIdRG24XtDsmGUS7ou9zBmeGgJghAWRNRpkHfil2/fZ6izAN1roO3YLSHckPU94C9FI28lhfO02YQw3RZMmO+aCPNhjjd8kBAuAc3mVjjimYQwAPVq4Bffw7kPvc4j9TU9mgzSae62C3zS8iw2SJg74YihpXBlZW3Q94Cus7haG2op/LHlS99DOgvwRVvZhjDwhvdBHUUDrVuFdVSd9D2oq5SBJqzCSqkOg3Tte9jsoZvYJY2w0sB7ORDeTSX7LkzT/gfOlnJUnUotHP/IdvG71GOe5oi61XcIuUw0LQs2Qi4TTcuCjXDLRJuyYCPEMtG2LNgIsUy0LQs2QiwT1rJgwwCf+ZZIHeAzlZVSVB2PzzXvMvY8mWUaUy7QSzRqkI7/5ZfNxkx0XIbaiBNZQRAEQRDUb/EGC4sae12sFiYAAAAASUVORK5CYII=",To="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVR4nO3UQU7CUBSF4bcQGbsVYeAajO90A9wHa5B32YhO3BEkRgYkxggbgDTRxBGa0Nse5XzJnXXQk79pSiIicsGa6fIW5hsUP5w88037bPrrcqnbH8d+XvtsYpFni0k2X//25fu69p0a83Hng1Hqy9DjTnwZrxp8rsZ8nEtdEdZd5VJvzh4oIv8TCH5U30+DuwaCqiocCQRVVTgSCKqqcCQQVFXhSCCoqsKRQFBVhSOBoKoKRwJBVRWOBIKqKhwJBFVVOBIIqqpwJBBUVeFIIKiqwpFAUFWFI4GgqgpHgvl+6Kpfl80/4geX+kwzuNTH8MH3s8V1Nn8feizM3zB/uEp9uJsuRzB/Qqm7/sfWXVu2t7EiIiKSunIEhOq3p0W+CNEAAAAASUVORK5CYII=",Oo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAADaUlEQVR4nO2aS2gTURSG4/sBilZxI1grghtBaF0VxKXgq6uKgiiIpJ17k2bOGUVX/neS4mPhQtSFuhUXxZVEW3HlxlU3uqgKrlTEF/jAR+ujlZvpxFaCySQzmUkyB84mZM78H+e/987cuYlEHHHE0TJxGFicsnIdhpXtikJqLVqT76DCtHsEYUSQmpCspqKUgjEuWQ0bpr2nZlApT68SrO6FDVUxPGGECG3Vw5J6GjaEd2j1uCpo0UCdLZHD3mBNuycComtKT2NasrobtuBaUxDuVASrp/kozsaegRnjABaWBTZMbAhbrF/Zl8H68nY20Rm2UN/SRGf5DlvZrtCF+pSGle2Kgf+NuMMcvjVjS3MLjGHBeG+QvV0SRpseWDDGU6a9Tes7cvzcMsl41dTABuGQq08STjV1hwVh0NWWYrtXMiabFlgwbgKYW+isia2S1VdPzrAaCZgwmkxiqdYkrFy7YLz2WsNoHGC87KPBtcVJitTDauoYDQFM+Jyi7Batpbd3aJ5k3Kq2lhF1YEHqt2TsdbVIVhdrqWcEBSxYffIJOuPqEIRUrfWMIIAF421/JrtJkjrhZcko0d1rfztr7xCkfkYUWB0oCjXR79jSKyxGAMzXNfotbPbLMUZAwB8MRncRmrBfMn5UXgNjmQxW6GuTjNWC8MwP2MCApdOhL9qGbg1B2CkY38peS+qdIGwsbh4yHvgFGyiwdMbghH70c+voh31J+Pgf2O8znDFHEq77CRs4sHTs+Usyjs7aECT1psT/JlOEg0VHsLL9hq0TsCrASMYxt54zg+P57O5CFWFN7Ktldo8AsHIszjjr1hwYwDrJeDL9+5C2cOFejG5t7SBg6w4sncnskvu2029hjWRcdT9g64/Zeg0PCjYUYOnY90YyeWXBzHuk01guGI+ChA0PmAvQeaLzS4ovBIR80LDhAnNhGbqvOytZXa4HbPjAXFirX9QLNhLAss5pxMAlIu4wN7mlZat9EE9ZuY7QhfqUwsq1lwVOpy8smj7ON9XQSep7RYdaCrZmNdz4wMgnKg19qCt0wTWmYdm7El5Cb6y1RHfd0Ac09UHN0MV7TowZJ8+sTFQTRGhrqPFMyFcNOzMkY7c+uxjJ2dvZMbntecxWEnrJ0sf5wj7676bWojVVJD6OOOJINEP8AR99+lKlJ3IWAAAAAElFTkSuQmCC",Lo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR4nO2aTU4CQRCFm5W6N7jSiEeAgxjkAO6UmQakaw5QPRCXLlzCRVRAEzd6CfUSSoIrTfET40wbZpA4hdSX1LI7703PvCbhKSUIwtpgzMWW18QDL2iVOEwtaBdI07J95rQJK77Bnm/suwb7wWmmmm60Ccuk9VdOG43zHW3sfdamkg/eVQPML2zWN/iSvYnU87yI6dxqnWz8pFO93tqEFddGvsE3H2xfA3Z9YztZzlgD2D5pcpqefNPJoICKmQV88KC9q5hBmkib43CuE21wjLjpSONXjmZnNBq4Fz1p8lCvX27MXUz3rONp9RRztMFBVHctaBfmL2xi0RECXcUc0hjT3cTi3IX0CyZ+wrajmDMJsu+6vaBVmrtQDIOcMEvklQb5ht1IaIGEFksktEBCy42EFkhosURCCyS03EhogYQWSyS0QELLjYQWSGixREILJLTcSGiBhBZLJLRAQsvN2oWWXrc/xGtBuxAvtNi+Yo5v7G1U9+kZ7q9PqQVwlKjUQoy7i47aEm2sOJoF++joal0l3sQL8OiHlttw0pbhUUybNneGzhJdMzxM8+ByVN9bfiXwj8bgIPWrUg0wT0XNzMWnHN/g0wngdmrDX6ZX6KQNDhY2GymIl6m7yLIgDjiigEr7zSaCriy627Ku/s+GtCS+egRBUP+BT4sLtV3SLOLeAAAAAElFTkSuQmCC",_o={key:1,class:"h-34px w-34px relative flex-shrink-0"},Qo={class:"flex flex-col flex-grow text-left w-0 min-w-0"},Vo={class:"text-sm text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap"},Ko={key:2,width:"20",height:"20",src:Oo},No={key:3,width:"20",height:"20",src:Lo},bt=L({__name:"RoomCell",props:{source:{}},setup(s){const e=s;se.extend(qe),se.extend(mt);const o=W(),t=A(()=>!!o.state.imkit.selectedRoomIdsForCreateFolder[e.source.id]),a=n=>{const r=new Date;o.commit("imkit/updateField",{key:"selectedRoomIdsForCreateFolder",value:{[e.source.id]:n?r:void 0}})};return(n,r)=>(i(),u("div",{class:K(["flex items-center p-1 px-2 gap-3 rounded-md cursor-pointer min-h-44px w-full group sm:hover:bg-gray-100 relative",{"bg-gray-100":t.value}]),onClick:r[0]||(r[0]=l=>a(!t.value))},[n.source.avatars.length===1?(i(),D(oe,{key:0,url:n.source.avatars[0].url,name:n.source.avatars[0].name,class:"h-34px w-34px rounded-12px text-base flex-shrink-0"},null,8,["url","name"])):(i(),u("div",_o,[j(oe,{url:n.source.avatars[1].url,name:n.source.avatars[1].name,class:"h-26px w-26px text-16px absolute top-0 right-0 rounded-10px"},null,8,["url","name"]),j(oe,{url:n.source.avatars[0].url,name:n.source.avatars[0].name,class:K(["h-28px w-28px text-xs absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100 rounded-10px",{"border-gray-100":t.value}])},null,8,["url","name","class"])])),c("div",Qo,[c("div",Vo,f(n.source.displayName),1)]),t.value?(i(),u("img",Ko)):(i(),u("img",No))],2))}}),Po={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},Go=c("img",{class:"w-4 h-4",src:Ee},null,-1),Yo=[Go],jo=["placeholder"],Do=["disabled"],xt=L({__name:"UpdateFolderModal",props:{folderId:{}},setup(s){const e=s,o=he(),t=W(),a=S(),n=S(""),r=A(()=>a.value?a.value.roomIds.map(g=>t.state.imkit.rooms[g]).concat(t.state.imkit.sortedRooms).sort((g,p)=>{var m,h,C;return((m=g.pref)==null?void 0:m.sticky)===((h=p.pref)==null?void 0:h.sticky)?p.updatedAt-g.updatedAt:(C=g.pref)!=null&&C.sticky?-1:1}):t.state.imkit.sortedRooms),l=A(()=>n.value.length>0&&Object.keys(t.state.imkit.selectedRoomIdsForCreateFolder).length>0),d=()=>{var g;t.dispatch("imkit/updateFolder",{folderKey:((g=a.value)==null?void 0:g.id)||`folder_${Date.now()}`,name:n.value})};return a.value=t.state.imkit.folders[e.folderId],a.value&&(n.value=a.value.name,t.commit("imkit/setState",{selectedRoomIdsForCreateFolder:a.value.roomIds.reduce((g,p)=>(g[p]=!0,g),{})})),(g,p)=>(i(),D(v(be),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 w-360px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[c("div",Po,[ae(f(a.value?g.$t("editFolder"):g.$t("createFolder"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:p[0]||(p[0]=m=>v(o).closeAll())},Yo)]),ee(c("input",{type:"text",class:"bg-gray-100 flex-grow outline-none p-2 rounded-md",placeholder:g.$t("folderName"),"onUpdate:modelValue":p[1]||(p[1]=m=>n.value=m)},null,8,jo),[[ke,n.value]]),j(v(Ye),{class:"h-50vh overflow-auto","data-key":"id","data-sources":r.value,"data-component":bt,"wrap-class":"flex flex-col gap-1.5","estimated-size":44},null,8,["data-sources"]),c("button",{class:K(["h-10 text-base rounded-lg flex-grow bg-blue-400 text-white",{"!bg-gray-400 cursor-not-allowed":!l.value}]),disabled:!l.value,onClick:p[2]||(p[2]=()=>{d(),v(o).closeAll()})},f(g.$t("confirm")),11,Do)]),_:1}))}}),Xo={key:0,width:"30",height:"30",src:Uo},Wo={key:1,width:"30",height:"30",src:wt},zo={class:"flex flex-col overflow-hidden"},Jo=["innerHTML"],Ho={class:"text-sm text-gray-500 overflow-ellipsis overflow-hidden whitespace-nowrap"},Zo={key:2,class:"ml-auto text-xs font-600 bg-blue-400 text-white rounded-full h-5 min-w-5 text-center leading-none flex items-center justify-center"},qo=["onClick"],$o=c("img",{width:"20",height:"20",src:"https://img.icons8.com/ios-glyphs/30/637289/pencil--v1.png"},null,-1),ea=[$o],ta=["onClick"],sa=c("img",{width:"20",height:"20",src:To},null,-1),oa=[sa],aa=L({__name:"FolderCell",props:{source:{}},setup(s){const e=s,o=W(),t=A(()=>o.state.imkit.searchKeyword.length>0&&o.state.imkit.searchType===le.RoomPrefFolder?e.source.name.replaceAll(o.state.imkit.searchKeyword,`<span class="text-blue-400">${o.state.imkit.searchKeyword}</span>`):e.source.name),a=A(()=>o.state.imkit.selectedFolderId),n=A(()=>e.source.roomIds.filter(m=>o.state.imkit.selectedRoomId!==m).reduce((m,h)=>{const C=o.state.imkit.rooms[h];return C?m+C.numberOfUnread:m},0)),r=A(()=>o.state.imkit.roomTag),l=A(()=>e.source.roomIds.map(m=>o.state.imkit.rooms[m]).filter(m=>r.value?m&&m.roomTags.includes(r.value):m).length),d=()=>{o.state.imkit.selectedFolderId===e.source.id?o.commit("imkit/setState",{selectedFolderId:""}):o.commit("imkit/setState",{selectedFolderId:e.source.id})},g=()=>{o.dispatch("imkit/removeFolder",e.source.id)},p=()=>{const{open:m}=Ae({component:xt,attrs:{folderId:e.source.id}});m()};return(m,h)=>(i(),u("div",{class:"flex items-center p-2 gap-3 cursor-pointer rounded-lg min-h-66px bg-slate-200 relative group",onClick:d},[a.value===m.source.id?(i(),u("img",Xo)):(i(),u("img",Wo)),c("div",zo,[c("div",{class:"text-basse text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap",innerHTML:t.value},null,8,Jo),c("div",Ho,f(m.$t("numberOfChatroom",l.value)),1)]),n.value>0?(i(),u("div",Zo,f(n.value),1)):w("",!0),c("div",{class:"absolute right-14 w-8 h-8 rounded-full bg-white shadow-md items-center justify-center hidden group-hover:flex hover:scale-110 hover:transform hover:transition !hover:flex",onClick:re(p,["stop"])},ea,8,qo),c("div",{class:"absolute right-4 w-8 h-8 rounded-full bg-white shadow-md items-center justify-center hidden group-hover:flex hover:scale-110 hover:transform hover:transition !hover:flex",onClick:re(g,["stop"])},oa,8,ta)]))}}),na=L({__name:"RoomListWrapperCell",props:{source:{}},setup(s){return(e,o)=>e.source instanceof v(Te)?(i(),D(Mo,{key:0,source:e.source},null,8,["source"])):(i(),D(aa,{key:1,source:e.source},null,8,["source"]))}});var ue=(s=>(s.FetchRooms="/rooms",s.SearchRooms="/search",s.Subscribe="/me/subscribe",s.Unsubscribe="/me/unsubscribe",s))(ue||{});const Xe=s=>(fe("data-v-f71617c7"),s=s(),ve(),s),ra={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},la=Xe(()=>c("img",{class:"w-4 h-4",src:Ee},null,-1)),ia=[la],ca=["placeholder"],da={class:"flex items-center bg-gray-100 rounded-lg h-12 mb-2 p-3 gap-2"},ua=Xe(()=>c("img",{class:"w-6 h-6 cursor-pointer",src:ft},null,-1)),ma={class:"flex-grow overflow-hidden"},ga=["placeholder"],pa={key:0,slot:"header",class:"flex flex-col gap-1"},Aa=Xe(()=>c("div",{class:"loading rounded-12px w-34px h-34px"},null,-1)),ha=Xe(()=>c("div",{class:"flex-grow flex flex-col justify-center gap-2"},[c("div",{class:"loading h-3 rounded-md w-full"}),c("div",{class:"loading h-3 rounded-md w-4/5"})],-1)),fa=[Aa,ha],va=["disabled"],ya=L({__name:"MassTextingModal",setup(s){const e=he(),o=W(),t=S(""),a=A(()=>o.state.imkit.searchKeyword?o.state.imkit.searchRooms[le.RoomName]||[]:Object.values(o.state.imkit.rooms).sort((C,y)=>{const M=!!o.state.imkit.selectedRoomIdsForCreateFolder[C.id],E=!!o.state.imkit.selectedRoomIdsForCreateFolder[y.id];return M&&!E?-1:!M&&E?1:M&&E?o.state.imkit.selectedRoomIdsForCreateFolder[C.id]-o.state.imkit.selectedRoomIdsForCreateFolder[y.id]:0})),n=A(()=>t.value.length>0),r=S(""),l=S(!1),g=$e(1e3,async()=>{r.value!==o.state.imkit.searchKeyword&&(r.value?o.dispatch("imkit/searchRooms",r.value):o.commit("imkit/setState",{searchKeyword:""}))}),p=gt(500,g,{atBegin:!1});de(r,p);const m=A(()=>!!o.state.imkit.isRequesting[ue.SearchRooms]),h=async()=>{await o.dispatch("imkit/batchSendMessage",{message:t.value,messageType:"text",paras:Object.keys(o.state.imkit.selectedRoomIdsForCreateFolder).map(C=>({room:C}))}),o.commit("imkit/setState",{selectedRoomIdsForCreateFolder:{},searchKeyword:""})};return(C,y)=>(i(),D(v(be),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 w-360px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[c("div",ra,[ae(f(C.$t("massTexting"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:y[0]||(y[0]=M=>v(e).closeAll())},ia)]),ee(c("textarea",{rows:"3",class:"bg-gray-100 flex-grow outline-none p-2 rounded-md",placeholder:C.$t("inputMessage"),"onUpdate:modelValue":y[1]||(y[1]=M=>t.value=M)},null,8,ca),[[ke,t.value]]),j(v(Ye),{class:"h-50vh overflow-auto","data-key":"id","data-sources":a.value,"data-component":bt,"wrap-class":"flex flex-col gap-1.5","estimated-size":44},{header:te(()=>[c("div",da,[ua,c("div",ma,[ee(c("input",{ref:"searchInput",class:"bg-gray-100 outline-none","onUpdate:modelValue":y[2]||(y[2]=M=>r.value=M),placeholder:C.$t("search"),onCompositionstart:y[3]||(y[3]=M=>l.value=!0),onCompositionend:y[4]||(y[4]=M=>l.value=!1)},null,40,ga),[[ke,r.value]])]),r.value?(i(),u("img",{key:0,src:et,class:"w-5 h-5 cursor-pointer",onClick:y[5]||(y[5]=()=>{v(p).cancel({upcomingOnly:!0}),r.value="",v(g)()})})):w("",!0)]),m.value?(i(),u("div",pa,[(i(),u(N,null,Z(10,M=>c("div",{key:M,class:"p-2 flex gap-3"},fa)),64))])):w("",!0)]),_:1},8,["data-sources"]),c("button",{class:K(["h-10 text-base rounded-lg flex-grow bg-blue-400 text-white",{"!bg-gray-400 cursor-not-allowed":!n.value}]),disabled:!n.value,onClick:y[6]||(y[6]=()=>{h(),v(e).closeAll()})},f(C.$t("confirm")),11,va)]),_:1}))}});const ce=(s,e)=>{const o=s.__vccOpts||s;for(const[t,a]of e)o[t]=a;return o},ka=ce(ya,[["__scopeId","data-v-f71617c7"]]),Fe=s=>(fe("data-v-7fd72bf0"),s=s(),ve(),s),wa={class:"overflow-auto relative"},ba={class:"flex items-center bg-gray-100 rounded-lg h-12 mb-2 p-3 gap-2"},xa=Fe(()=>c("img",{class:"w-6 h-6 cursor-pointer",src:ft},null,-1)),Ca={class:"flex-grow overflow-hidden"},Ia=["placeholder"],Ra={key:0,class:"flex items-center gap-2 overflow-auto text-sm text-gray-900 mb-2"},Ea=["onClick"],Fa={key:1,slot:"header",class:"flex flex-col gap-1"},Sa=Fe(()=>c("div",{class:"loading rounded-2xl w-50px h-50px"},null,-1)),Ba=Fe(()=>c("div",{class:"flex-grow flex flex-col justify-center gap-2"},[c("div",{class:"loading h-5 rounded-md w-full"}),c("div",{class:"loading h-4 rounded-md w-4/5"})],-1)),Ma=[Sa,Ba],Ua={class:"absolute right-0 bottom-0 p-3 flex flex-col items-end gap-2"},Ta={key:0,class:"transform-gpu flex-col items-stretch gap-1 rounded-lg p-1.5 shadow-md bg-white text-base text-gray-800"},Oa=Fe(()=>c("img",{width:"24",height:"24",src:vs},null,-1)),La=Fe(()=>c("img",{width:"24",height:"24",src:vt},null,-1)),_a=["onClick"],Qa=Fe(()=>c("img",{width:"30",height:"30",src:ys},null,-1)),Va=[Qa],Ka=L({__name:"RoomList",setup(s){const e=W(),o=S(""),t=he(),a=S(!1),n=S(),r=A(()=>e.state.imkit.sortedRooms),l=A(()=>e.state.imkit.sortedFolderIds.map(_=>e.state.imkit.folders[_]).filter(_=>_)),d=A(()=>e.state.imkit.folders[e.state.imkit.selectedFolderId]),g=A(()=>e.state.imkit.searchType),p=A(()=>e.state.imkit.searchKeyword?Object.keys(e.state.imkit.searchRooms):[]),m=A(()=>e.state.imkit.roomTag),h=A(()=>{if(e.state.imkit.searchKeyword&&t.modals.length===0){if(g.value===le.RoomPrefFolder&&d.value){const P=[...e.state.imkit.searchRooms[g.value]],G=d.value.roomIds.map(ne=>e.state.imkit.rooms[ne]).filter(ne=>m.value?ne&&ne.roomTags.includes(m.value):ne),q=P.findIndex(ne=>ne.id===d.value.id);return q>-1&&P.splice(q+1,0,...G),P}return e.state.imkit.searchRooms[g.value]||[]}const _=[...l.value,...r.value];if(d.value){const P=d.value.roomIds.map(q=>e.state.imkit.rooms[q]).filter(q=>m.value?q&&q.roomTags.includes(m.value):q).sort((q,ne)=>{var Ve,Ke,Ne;return((Ve=q.pref)==null?void 0:Ve.sticky)===((Ke=ne.pref)==null?void 0:Ke.sticky)?ne.updatedAt-q.updatedAt:(Ne=q.pref)!=null&&Ne.sticky?-1:1}),G=l.value.findIndex(q=>q.id===d.value.id);G>-1&&_.splice(G+1,0,...P)}return _}),C=S(!1),y=S(!1),M=A(()=>t.modals.length===0&&(a.value||C.value||!!e.state.imkit.isRequesting[ue.SearchRooms])),E=()=>{e.dispatch("imkit/fetchRooms")},U=()=>{y.value=!y.value},R=()=>{const{open:_}=Ae({component:xt});_()},T=()=>{const{open:_}=Ae({component:ka});_()},k=$e(1e3,async()=>{o.value!==e.state.imkit.searchKeyword&&(o.value?e.dispatch("imkit/searchRooms",o.value):(e.commit("imkit/setState",{sortedRooms:[],numberOfFetchedRooms:0,numberOfTotalRooms:0,folders:{},sortedFolderIds:[],roomIdsInFolders:{},searchKeyword:""}),z()))}),V=gt(500,k,{atBegin:!1});de(o,V),de(r,_=>{if(!e.state.imkit.selectedRoomId&&document.body.clientWidth>640){const P=Object.values(_).find(G=>G.numberOfUnread===0);P&&e.commit("imkit/setState",{selectedRoomId:P.id})}});const z=async()=>{C.value=!0,await e.dispatch("imkit/fetchPrefs"),await e.dispatch("imkit/fetchRooms"),C.value=!1,await e.dispatch("imkit/fetchRoomsInFolders")};return z(),(_,P)=>(i(),u("div",wa,[j(v(Ye),{class:"p-2 h-full overflow-auto","data-key":"id","data-sources":h.value,"data-component":na,"wrap-class":"flex flex-col gap-1.5","estimated-size":66,keeps:60,onTobottom:E},{header:te(()=>[c("div",ba,[xa,c("div",Ca,[ee(c("input",{ref_key:"searchInput",ref:n,class:"bg-gray-100 outline-none","onUpdate:modelValue":P[0]||(P[0]=G=>o.value=G),placeholder:_.$t("search"),onCompositionstart:P[1]||(P[1]=G=>a.value=!0),onCompositionend:P[2]||(P[2]=G=>a.value=!1)},null,40,Ia),[[ke,o.value]])]),o.value?(i(),u("img",{key:0,src:et,class:"w-5 h-5 cursor-pointer",onClick:P[3]||(P[3]=()=>{v(V).cancel({upcomingOnly:!0}),o.value="",v(k)()})})):w("",!0)]),p.value.length>0&&v(t).modals.length===0?(i(),u("div",Ra,[(i(!0),u(N,null,Z(p.value,G=>(i(),u("div",{key:G,class:K(["rounded-lg p-2 whitespace-nowrap cursor-pointer hover:bg-gray-100",{"bg-gray-100 text-gray-800 font-medium":G===g.value}]),onClick:q=>v(e).commit("imkit/setState",{searchType:G})},f(_.$t(G)),11,Ea))),128))])):w("",!0),M.value?(i(),u("div",Fa,[(i(),u(N,null,Z(20,G=>c("div",{key:G,class:"p-2 flex gap-3"},Ma)),64))])):w("",!0)]),_:1},8,["data-sources"]),ee((i(),u("div",Ua,[j(Oe,{name:"slide-fade"},{default:te(()=>[y.value?(i(),u("div",Ta,[c("div",{class:"flex items-center justify-start gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:T},[Oa,ae(" "+f(_.$t("massTexting")),1)]),c("div",{class:"flex items-center justify-start gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:R},[La,ae(" "+f(_.$t("createFolder")),1)])])):w("",!0)]),_:1}),c("button",{class:"rounded-full bg-slate-500 shadow-md w-12 h-12 flex items-center justify-center cursor-pointer sm:group-hover:flex hover:scale-110 hover:transform hover:transition",onClick:re(U,["stop"])},Va,8,_a)])),[[v(Ue),()=>{y.value=!1}]])]))}});const Na=ce(Ka,[["__scopeId","data-v-7fd72bf0"]]),Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKklEQVR4nO3aP0oEMRSA8SfiFl7CPu1AgpV51ovmLeQK9v45gF7Aq6jXEO/gegy1WBlhQZHNvEJQNt8P0kw1fMyEhEQEAAAAAAAAALCtaq27Ue0qqT19jry4HJ/99Xv9C6HWWVK7T2qrbyOXW+ldqHUWc3n4EUdtFdXeh/l8X3oVGnHW41AXB9Kj4IgT1Z5FZEd6ExxxUi6vUe1YOp2Q7ybjHJ0W6U0gzmbEaSBOA3EaiNNAnAbiNAzD2Z5nEZjUTqRHSe2GOA0plxdWyA0xl+XmL6i8dbmF+CqpXfOLNTBJOyNN7th7/90GIk0jkgORHIjkQCQHIjkQyYFjn986OMxl2eXB4RpHzw5cXnDg+ovDeFkq5XKRcnkcR1Q75wIVAAAAAAAAAMg2+AByUSBd2KYVoQAAAABJRU5ErkJggg==",Pa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEu0lEQVR4nO1ay48UZRD/Dj4SvPhOfN8XhUMz9Q1msKvGXV3jZKdq1uEmGiGrf4D4CJpwQPSG4CMkxoT4inrdEF83FaJnjAYJCXBSFr3IgdVdMNW9RNmume3tx0xvmF/yJZ3Mbn3166+6qr6qcm6EEUYYYYQYwXj3Xh+2n/bEbwPy10ByAkj+9MR/69JnIP5Vf9O/qSE/tWlL+x63lrCZOvd54leA+BdPcinLApKfPfIufWGuqqg/1H7AI38AyAtZiSYW8qInmfXEgasK6o90bwbi/UvKXSppXdSXuXlCbh8uWeKt8TdZGtErTR35D4/t6YETDYKZa4H4nRQKLgDKESDZ44k70JwaazQev0n/X5c+12h6vf7miV/zKEfTfBKAfED/fyBkN0xM3ADEX6yg0CkgeT7YInesVv6D41N3AvFOj3x6hT0OB63WOjcAst/3VkJ+A+Jninj7KqMeyg5A/r2PN/+uNNJBbMb9TvbQxrB9Y9H7qtkDyYd9T7oM8waUd3uEjnlNLlzJ0NOO9urxTRe7GfFW26T4r3rYGXcDQg07j3qU8/Zpc6eYTR7mWzzKOetkVQE3YABJE1AuWCGr0ejelnsDT3LIfKMZzNiH3PAoL16xQm5kMm/b4t5zeQAkG6Msx3BQWeR5kt2GrN0ZdUs6MuTFTaHcn0VeBED5zAo96jndkAnH3pvPGqQ/znzrASPr0TibSWDBhGN5PGNld5luWZ7kVUO5M2Pd7nVVIRzlBsinjEN5edXCwLjParrockBDGBC/8f+VN6wBtl8wzPqn1VcqKOkQ6s3uXa5iiHJv69ML5e7UQuKyTMJZHXEVBZD8YFjjttQCPMpbhoA9rqLwKHuN73h/agFA/M1yAbWmiKsoIJQnjFTzy9QCPPLJxBtrTo3lVayoTGs5NNkwLPJEagFRKWWZAK1d5VWs6LB0GUHYutWQO5deMeMalif+lk14cnLyesPJXkiv2NVGGK5Ckz6Z8NI0vb6qhKMmQC6nReWEpbIIFxCWpJTEozTCKK8b+r6ZWoB28ZK5tBytMOEfk4Q7T6YWoC3LJGFeXFVCPiDCeqHJfXlQRC3LZH6601WMcJStJb/fYxkE8a61WgDwxC8VVuKph7KjKoRrTX4umXDwQuYpAiD+1HBe57RWPWzCS33pRBEPiD/KIi+Cb05vsMq0WiJ1QybsUT4xHWveW51Hed9QMpNpF1XTApRnLZ088UFXRJ4KRm6tUzjDaLX4Jj8WTwElc+ci8v0IOmZgvlGU84MkHZG1m2kXAbld6GaAfMAmzfOA7e2FbtbTjM2TVR32Fb5hEMe8w/a3Ezuywkwq2b1MOqj/1mwYhte4MhC0Wut0zKA3aQ0TPFNEsUBlLMXZuZ5kUb4tfc4jUNJ9TvpyRqYdgSyFe82Bl9LFMyvsMVs62WXmbX/Ty+OiFslR9uqdVS/qavZ6err0WWO9/qZXvOjWs/KAmw6p7SvNjPshmq+ypgPKW3OFe+MsTkU776WOHkay+WAZTjEzook6HS4l+adQoiifF9EEKA16U9H+rLYss5PlY3rFW3Oz03WtRpBsixwcylce5Xg8IMrzccKiz3JcC27a/NKyjLY/h633CCOMMIKrCv4FJTQtkqp0FHwAAAAASUVORK5CYII=",Ga="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVElEQVR4nO2azUrDUBBGhxnvS9SZuhOsBF3bufEp+py1olB/3klt3VgEJaUbqbE0LpJOvgMDWc7HnBvI5BIBAADYwTUd0YSEojNwOtXMT+byWZVmfh5cpUuKyPE4XZjL0rJ8/SiXpZapoGiY8/1W2E2p8x1Fw1ze6wJXU6ZoWF3YTVE0DIEFEw6FQWmB0qEwKC1QOhQGpQVKh8KgtEDp1rFxOtfMt5rlbZeSbVfVozrPhk6jRmG1TMWvO6iuV9MdmTo/tt5802k7P+yXdkKiWVYHGzjLar+996RvgemwlTbneX9eWlkWjRf7Q6eROt+oy0vnNV73yNOTks6oC9iOhikahsCCCYfCoLRA6VAYlBYoHQqD0gKlQ2FQWqB0KNTl9a+Pd4qGOs/qzzFPKRpDp1HNjmzR+G9B19EyFdWSXLN8rKt6jniTdotqZ9yHC+IAAED/5BvYQaHooEGgKAAAAABJRU5ErkJggg==",Ya="data:image/png;base64,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",ja="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADnklEQVR4nO2a3WoUMRSAT3Nm1RfQ2t1kaqUqtChiFdvdk1mxVnwBwfcQrUUEr8SfG71U36AUFQUvqxa9EsULaX0D0dpWqVCstsppKyxuMtntj/t3Pggss0km+TY5yWYGQBAEQRCEdWIsnjaE943FD4bwOydNOGUs3jMJDkGrks3DAU1qwlj8nZpIvcgS7IdWQlNU1IRzQTlrSVuc1TZKoHVGDlYsp1RSLoF90OwYq55VK6d0ukEzYxIcWrectRQTDkKzYlZXK9f0+aFJXTR5yHKKSQ3zNU/eu9CsGF7KnaNCDZfnVZecgginoFkxhPNOQRY6/s3L19xxCOehWTGeuLJZ+RseI4LSEUEBRFAAERRABAUQQQFEUAARFEAEBRBBAURQABEUQAQFEEEBRFAAERSg5QRpi4uuDvT0wLZqjlz5oL6s7n7IeQ7tv7nq7j4D230PBKBWaIuzrkbtJthZzaE9H9CX51UjnkP7SVfdXceh3TPiZqBWaMJJV6OySTRQ7WOflacYeciujhw1Uu1jn5iigju/eg+1Qlv12NmoRJ135Y8JT/niSqUptnjS05YL7hGnHkGtMBaveho14S1Danz9gtRzX72a1CvPCLoCtSImHHR2hPBX+wDscpXhV1l8sSuQZnQRulPiz5KrXK6AJ6BW9PVBhhvu6dANXzl+laVKSTMmiayvPkN4y/NDfYEiRFBLjC/wEi5kLRhfOX6VpaI3PUiN+0YO01GAmO9VTUD/r2TzmcMpnRsDgLbQNOWOrKyIvE8inOfPfM0XkEtoM1Y98Nx/WSeZg1APGKuepki6vFX35QDsu6+26gnUCznKHOLA7GnskiZ1brPvyXX6ArMh/GkKmV6oJwzhzZRYsqwtXg9Ntwpp49dlvHJW4981qDc6i7DDWPUuEHDH0gJ3CA7IKTHn7x7sLf8vg3okttBlCKfTO4ALPNp471JpvSv7HMJbvtWqZGpNdxZhD9QzJh8d1YRfK9jbLGmrXvJfhNhGeZbApwCc+DNf4+84T9p0KhE/F9vMEWgEdBId0xY/VbER3FDShB9jyvRBIxET7NWk3my5HKte1/208sHBklcv38HaxsTgIq9WvsO5hiIm6DFWPeTlfhPkLPNKxnVCs2EKmV5t8U5opfOkz5rwdlOKKeMsYK4Q9fMporY4mjKNRjkP5+Uy0KoYj6Bat6tuMCIoHREUQAQFEEEBRFAAERRABAUQQYIgCIIgCAI0Gn8ADIaRj4Vk+wwAAAAASUVORK5CYII=",Da="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADnElEQVR4nM2ZX0hTYRTA1z8o6KEiooiiCCEqiCDqxTLopR6Dbnf3nO/u7l8XSvLBhx58UZo+JEEYmUYDzQ3MhCDC6bb2FqSNVIikt0gTaTMlMPpj+cU37/Squ/d+d5uuAwf2sLPz4/z7vu/M4ShQBEHYAADbZVneL0nSYUmSylwu115FUbY51lIkSdqJiJcB4C4ixhHxIwD8RERqpgAwAwAfEPEFANwihFwQBGFLUaBqa2vXI+IlDWjWCgY5lUEjYich5HQhETsFAMPFgkJj2OeiKO6zBQcAPgD4vdpwuKhTiHiOCw4Rr68hGNVF8ockSeVWaS1HxD+lAMR5TRNCduWEq6io2AgAIyWEo1okQ0Z1J5caDucB/yLikVy1N1BqOFyEvLcEThTFA4g4Z2VYV1dHn3Z306amJkoI4Xbodrvpo2CQPunqotXV1TyAE+yE0qdXtTIK1NfTVDpN05OTGY3H49Tlclk6U1WVDg0PL9h9Hh+nN6qqLO0IIcf16W2zMujp6VlwwgupLoPLamtrqyWgJEnX9ICDVgZt7e0rHKVNII3gmAYCAZ7SeKBP8TeeOnqTTHJBqiZwLBOctRvPwAmCsJW32D0eD33d35/TcSKRyED6/X46ODSU8zvRWIzKsszbySPZ9O7hBWTq8/kMI/kykTCOXCRiq/MRcTR7vJXZAcxGsn9gICdIoZHTRXA6A+h0Ok/YBbQDGc0DTtPZbIOczQeQBzKaP1xGFUXZzGrwTL4/4DdpCH3jFASYb4qt4NKFQ87m3SS8cOnCIKcygIqi7LZjaDaEe/v6uIe5lQLAJ9uDmkXu7eCgaUN4TBrHTiQB4L3+qJu2MvB6vdxD2GcyzGOxGNfABoCoHjBpZRAKhXI6jPT25nRoBtnQ0MATxfv620wwn+tWxADOCrKlpYUnglf1gF6e2/SXVMr22erz+WhSBzk6NkYrKyst7ZxO59EFQLbs0R4rpkY1NTU0HA7T242N3N2I8wOXNjc308cdHVy3ae2isG75o+mVHaerrHdyvequ/AdglC0ORFE8ZLTnW/VlEVpr0GEksiyfRMRfJYQbFwRhhyGgNhPdPG/kYisAzLAAmcLp6pHwbE+xeHATbB/psCOEkGNr0NlziBg23GhxRvM8ADxj+7sign1FxIdLhnGhwm49AHCRLcI14HfaZtSwqQDgOyKmtLO+EwBushu8qqqbigbGI8wh+yuCEHKQ7ZvZ5xUnQZ7yD8zfzl1rwXkSAAAAAElFTkSuQmCC",Xa="data:image/png;base64,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",Wa="data:image/png;base64,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",za="data:image/png;base64,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",It="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtElEQVR4nO2bsWtUQRDGV1AxWCoWWgsS7ULgbufI2RxWNlraqq34F7ybiYgaYqVFsBP/AEWFgJWQUtBCkICW0Sg2ejeTa3RlL57cJXfcnXkvu++9+cG0B/vdt9/uzts1RlEURVEURVGmYTZxh4H4rkX5DCjfLcqDBeqcnupHioxFvgMkbrD4F5A8raHUTdnpOod2CjRQb2vE1+uJO2LKyBhxXK8syRdAbs7f/nHMlIlJBYKeUMgdS/y4lnRmTRmYViDoyymL/AqQLxrnDpii8v8CSZ+r5F1hcyoNgaBXKJs+p+rJz+OmKKQqEBUwp7IQCP45in/nPqcyFYh251Rl2c2YPLFfAkFec2rfBaLBnAJqnTUxE0ogyEtOBReI+lxFvA7EN6LKqdCiwPD66rsMNuGTofWJVSDXn1PVpHVOBaKx028tSE6FdgnEnlN+FYEIBj51oWxakqSatE5kLdDH4IPdm6O2AOVRZvsp22xfCz3IdBzVnQmrVWxfSD2ngPgSkLwA4g8WuR18sHt1Fcp7S+2rmfWnKstuxu9BasRzfuXwh0x/frIkKxbluSV5M0GzP3hZlG9+P1W5xadMCBpL7mg16ZypLsqCbcoVS3wTUO4D8RNAfh2LI//up5bmVtwhEyONSIT0Ipk808hYSD/lTJ5plFWgRiRTDJDvlXPgND6kvTj1xB1MZeAVXeYHsciXAeVlLP94VBvF7iaQwg8q2qOGJf6Ua7dkfVjVdscYcuiY9f1tmOVHmDVtudIOUbRpL6Mco599IIZ8mYTQ2QL66VmGu0UvL8jIfNHrLzTMMXqByuUuXyYhk00d6iVOV4jrdZOQjmNEL5LDLmH0KYIrfL5MwrT5Ml/C51AbY8Qp94O6kU8yUZ7B4tZ5U3b8o167LdJG91EvyUN91KsoiqIoiqIoZps/5GTgdqN3Zd0AAAAASUVORK5CYII=",Rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClklEQVR4nO2bv4vUUBDHn6DicaViobUgnp292lnZaGmrtuJfoOV5B1ZaiJ34BygqCFaC5YEWCyIoy2XfzOzOxEIQ3MYbye3q/Yomuyb3XpL5wLQL893J900mb5wzDMMwDMMwjFno9fSwR74HKAjEKSA/GDCfmulH2oxHXgYS3R4e+adHfobIF1zXmVSO6D/iPaLc7Pf7R1wXKRBHt6pKCEjuev/tqOsSZQWCrRh74ieI6RnXBeYQSH/7FCC/8SSXVfWAayvzCgTbA+VDa32qEoHoj08NM58CgGOuLVQpELTRp2oSSKc+tdF4n6pTIMjxqSRJFlyT2DeBqKE+td8CwS6fIvq65GImoEDaCJ8KLRDsjE8w5FtR+VQEoujeqpJRNmVYFzkRWp8oBYK9PnXWBKKCqiJ5F8SnIqgSjdqnNk8RCp70XP2UR75DRMdrFQhQPodO9j/jh0d5XFs/BcA3IkiygoriDU/yGmB0qXKfQkyvAMpLT/zRo3xvgVg9GPL12uZTSZIsZD0IopzLTo7sJXNzHk3yCFBeeJK1EsP+4OFJOOunkiQ96UJARIsAchqRzwPItQHybSC574mfepK3EVXkGIhX11QPuRihaITkVddkqGYhs0fONRnqqkAUyyOGvNLNxKmESSOvqOrBShJP7JjfCeLoKpC8iugfj6dRnDaB2vSo7VXDo3wJnVzUL6s27iggggrQqAdmESSsZcJGrpQrjA3tIa9a7LOPxOEvZQjuLWifnrXAX+zyAuzyF7v+QjkVYxeopHn+UoaazHdslzipBdfrylBJxaBdJNccf7FVBGi7v5RhVn/xnVuHQoYCcbq9UPe3lUxAfj4guei6znSpd3lSSZwC8UNb6jUMwzAMwzAMN+EXe4XJ/lKRL1IAAAAASUVORK5CYII=",Ja="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRUlEQVR4nO2YzUrEMBSFsxp9CX0SYTazGJKCm5yZ5dhcEBRci4hjl/NO7sadvoH6Fu6GghKoNNZfMkkpw/ngQgmX5J6b00KvUoQQslMUKMcG8mis2xjI25ewbqOte/B5amgUOD3UcK/fFt4Jn3c8PzlQQ0Jbd/6f4oM4U0PCQKqguCo2JwsFyiMDd/lrWLlrve6fI3PQhj83iYBO5/qMigI8ZlZOjJXV50+irJIHOvvPyolKSXhA0o172p8C/sLwBiI7lHs9GRTQwBuIhRZqoIVioYUaaKFYaKEGWigWWqiBForlx84FP+ZbrYP/xDs+ldCQ+uMAAKOUe0+nF3vt9FpqlQNj3UsweLpKJQLASEOuAwFPKgfautueZqI3WQSMF4t9DbnPWbyGW3s7ZREQiFhquOfwndiuaKm9bXznsxZPCCEqJe/j5Sspw8QNvwAAAABJRU5ErkJggg==",lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVR4nO2ZS0oDQRCGBwT1AD5AfN1E0KhJV1QSuzSuYqqCiOBar6AHiBHBA3gLieglfIsLcRPduFBQesKYjijCTLckWB/MIh3yd1X13wn8CQJBEP4vs8vFcUDaB6Q7hfwGyO9xHxV+nu4AqaryNOa9+OwizSjk5yRFw0+P5idYKqW8Tt5b8dhsIotro14aaNgmOnq6zGB5EhG7k2giYnd2kaZA89Wntua9wAcNrzY2McW71M6aJprDuXEjurLWB8hH0Wv7wiad/FeMnn2xg6TMFXgQkC+MYLRmezXwALjUV0iHX8U6qwFNjx3dAHwjJg38AsgJWIiFYgBiIQuxUAxALGQhFooBiIUsxEIxALGQhVgoBiAW+mUaHZVKqNZiu8I1zbe+ciFYKqWsoV0nFlSa7yPB+QINhZsgVa0I8Mps6iKZyyBPtyRzSJXkDSDXmsVSIVzL01gYwPrMRpHqTrJRhbxtebLWctTemqC6iRgDFywsr46A5pdm4Eob0XtmQuaYTYbp4v8BFepQxXkqDci71nRe7SY6golisRc0nbVMTdOJwvJKOlcejr6d2prp3PqAQj71eHGPvDeRTm/2KKQd+044eTSdmwg/+CvCi420BZqPze9E/AtMD4B0kMZS/58VLwhC0FZ8ALiaxMwFZ/dcAAAAAElFTkSuQmCC",it="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEElEQVR4nO2Xu4sUQRCHC8HHJYqgiAgmXqKpkQgqIjjTtRss9m/v9MBzqpbB9TA08MUECv4DcslhaCSYGZkoCAZiYCCoaGRwoKKooIi6K+OB2w4LB+exsyX9wUQzDPV1PbqbKBKpj2RmZqOD3GpCJ8li8OzlIUP7DF1MkO0ho8H3GdpzkFNkNfgUnTmyQBKDr4kkrnxNJP/ZyveHPl7eM+Q1Qx8x5KaDXuRjeujg7OyGWgUcZL4SbG9Zmb/E9Kvzcoe9TAOYGN8MYPnHQT8w9ErjeL6lbokeQ7vhN3yiu5lxckfa1v0OmbKX6wx9OlxEPjP0cpKcXT9WEsNoIN/JkAsMfTYkIy9cWw7QuEuUFEWxhpG1nNfHFYkfzsul8v3YS5SUgaZeOw76riJye2QT618lSprTuo293q1MrPtHkG8iKxJLZSVXK5m4V2smVnIfSNGZc15+huVUV08suindvZL/NCCnK+V0nqzdiRlybSAh38s9hSxRlD0RNraX5yPd7FaDo618+9LBsIZSWi0Y2g0EPpbHFLJWSg7y5M9U8lKQNRyydiDw1lwvFL8bWl4OplLWIms4L0W4uZE1mtDJQODT3jxfS9bgoIwakH1kDYYsBDe5c2QN5+XMYBrpDbJGis7h4GjxgKyRTOW7glPqK7JGgmxrIPCGrAFgIhilX8gaANYFAt/IGogCkUgkQiPgF1+GFsoZdsMBAAAAAElFTkSuQmCC",Ha=s=>(fe("data-v-0f50df5e"),s=s(),ve(),s),Za={class:"flex gap-3"},qa={class:"flex flex-col gap-1"},$a={key:0,class:"w-10 h-10 rounded object-cover ml-auto"},en=["innerHTML"],tn=["innerHTML"],sn=["innerHTML"],on={key:3,class:"flex flex-col gap-3 my-1"},an=["onClick"],nn=Ha(()=>c("div",{class:"my-0.5 w-2px rounded-full bg-blue-300 flex-shrink-0"},null,-1)),rn={class:"flex flex-col gap-0.5 flex-grow overflow-hidden align-center justify-center"},ln={class:"text-sm font-bold ellipsis"},cn={class:"text-xs multiline-ellipsis"},dn=["src"],un=L({__name:"TextMessageContent",props:{message:{}},setup(s){const e=s,o=W(),t=A(()=>o.state.imkit.messages[e.message.replyId??""]),a=A(()=>{const m=t.value;return m?o.state.imkit.users[m.senderId]:null}),n=A(()=>e.message.isIncoming),r=A(()=>{const{urls:m}=e.message;return m?m.map(h=>o.state.imkit.linkPreviews[h]).filter(h=>h):[]}),l=A(()=>{if(t.value.type===F.Text)return t.value.text;if(t.value.type===F.Image){const{t:m}=we();return{[F.Text]:m("text"),[F.Image]:m("image"),[F.Video]:m("video"),[F.Sticker]:m("sticker")}[t.value.type]}return""}),d=A(()=>{if(t.value.type===F.Image)return t.value.images[0]}),g=m=>{window.open(m,"_blank")},p=()=>{o.dispatch("imkit/navigateToMessage",e.message.replyId)};return(m,h)=>{const C=Qe("src");return i(),u(N,null,[t.value?(i(),u("div",{key:0,class:"flex flex-col gap-2 cursor-pointer",onClick:p},[c("div",Za,[j(oe,{class:"row-span-2 h-24px w-24px rounded-lg text-sm flex-shrink-0",url:a.value.avatarUrl??"",name:a.value.nickname??""},null,8,["url","name"]),c("div",qa,[c("div",{class:K(["text-sm font-bold",[n.value?"text-gray-600":"text-white"]])},f(a.value.nickname),3),c("div",{class:K(["text-xs multiline-ellipsis",[n.value?"text-gray-500":"text-gray-200"]])},f(l.value),3)]),d.value?ee((i(),u("img",$a,null,512)),[[C,d.value.thumbnailUrl]]):w("",!0)]),c("div",{class:K(["h-1px -mx-2",[n.value?"bg-gray-200":" bg-blue-300"]])},null,2),c("div",{class:"break-all",innerHTML:m.message.html},null,8,en)])):(i(),u("div",{key:1,class:"break-all",innerHTML:m.message.html},null,8,tn)),n.value&&m.message.translatedText?(i(),u("div",{key:2,class:"break-all text-gray-400",innerHTML:m.$t("translation")+": "+m.message.translatedText},null,8,sn)):w("",!0),r.value.length>0?(i(),u("div",on,[(i(!0),u(N,null,Z(r.value,y=>(i(),u("div",{key:y.url,class:"flex items-stretch justify-center gap-2 cursor-pointer",onClick:M=>g(y.url)},[nn,c("div",rn,[c("div",ln,f(y.title),1),c("div",cn,f(y.description||m.$t("tapOpen")),1)]),y.images.length>0?(i(),u("img",{key:0,src:y.images[0],class:"h-12 w-12 my-auto rounded flex-shrink-0 object-cover"},null,8,dn)):w("",!0)],8,an))),128))])):w("",!0)],64)}}});const ge=ce(un,[["__scopeId","data-v-0f50df5e"]]),mn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNklEQVR4nO2Z20sVURTGd9r9IlLmDYxuBEmBURBSkQWF2EsvUUT17EOFb9ZbFIRBQdEfYIUUBNlDd6KgIqOrhWU3MQiiIior7QLlL9Y5a07b0eM5xzPjmYnzgXj2ntnfWt+stfdes8eYLLLIIuMARgILgU3AdmArsBZYBOSaoANYDBwBvhEfH4BGoNIEDUAJcBLotRx+ChwHDgGHgWbgiUtUMzDLBAFAFfBOHfsE7AbKBrl/NrAL+KJjPgPVw+t1f6dWAz/UoRNAYQpjp2rEBL+BLf56G9+RcqBbHdk5RI4RMlZT8hew1HtPo4bG60qzUlLC6h8FPFYRezyws1e5JEXz03bcIp4JNAHfXZOzHVgH1Gn7GpDjgb0c4IpyNnglotqaiJK7rcBV4JUlSFLhDzDXE6MmYrdCOeXhFXlB1qPOylpf4rpeqcIiS2e6zrsBnFbuWpMOgJtKtC/BvKlN+6kNzL1Z7V9Ih2SBkryUyeyph8n7UKg+fEyHpM6rVSgd8G+BGTeUwcuAe0qQmY1JAXSqHzNMspA8tyaYU9DF9otMAHijvhwA1gCjEw2YYy2pnTrRUg+nxwDaXHvXe6B+wHkLTAE69MZTwEQTEAB5wBJgo27KUroI7vSr5YBjevFSplaoFKuMW1ZlkWcXe726e5eaEAAYq+WQoMnp3K8dB02IABQDXzUIFdJxX4UsNyED0BALgr6RCSb7ZExS4K6PZwKCNmn8jPyEMT4Zi8An7nyl75LGa22UhVDIBKXvlsZlbawPoZB5Sv9CGtu0cSaEQuqVvlEaBdYbYFVYhBB9D3LqsBqnc4d2vAWmh0TIUaVukdMXpzMXOG+JWRFUIUQj4YiQTCp33zAJOOcYBs4CG4BpCUtnn4UQdX6+zgknnWRXXxVvQK7e3EXquJGqEBnD0NDSLxJxDBTo0f9F3Wec0nkwXPdRSA/wXE9yamJzYjgxmJBQgayQgCGUEQEeAA/lpSeeEH0hegTcNkEFUQedz2zFbiEqQq4JWk1QQfSI0/lOIstlqbWEFlnXngX+fIC+T935b/+ORSvwoG9kbAQ/EkmICZ8IV5q161840ilBZJL+TJ2F+U/wF9Y5UmVGwaQRAAAAAElFTkSuQmCC",gn={key:0,class:"relative flex items-center justify-center"},pn={class:"max-w-80vw max-h-80vh",alt:""},An={key:0,class:"absolute max-w-80vw max-h-80vh",alt:""},hn=c("div",{class:"absolute inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1),fn={key:1,class:"mt-4 flex gap-4"},vn=c("img",{class:"w-5 h-5",src:mn},null,-1),yn=L({__name:"ImageModal",props:{image:{}},setup(s){const e=he(),o=W(),t=A(()=>o.state.imkit.downloadProgresses),a=A(()=>o.state.imkit.imageCache),n=r=>{const l=document.createElement("a"),d=a.value.get(r.originalUrl);l.href=d;const g=d.split(";")[0].replace("data:","").split("/")[1];l.download=`download.${g}`,l.click()};return(r,l)=>{const d=Qe("src");return i(),D(v(be),{class:"flex items-center justify-center","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[r.image?(i(),u("div",gn,[ee(c("img",pn,null,512),[[d,r.image.thumbnailUrl]]),r.image.thumbnailUrl!==r.image.originalUrl?ee((i(),u("img",An,null,512)),[[d,r.image.originalUrl]]):w("",!0),(!t.value[r.image.originalUrl]||t.value[r.image.originalUrl]<1)&&r.image.thumbnailUrl!==r.image.originalUrl?(i(),u(N,{key:1},[hn,j(v(je),{class:"!absolute",diameter:40,"completed-steps":t.value[r.image.originalUrl]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):w("",!0)])):w("",!0),r.image?(i(),u("div",fn,[c("button",{class:"text-base border rounded-lg flex-grow text-white gap-1.5 font-400 px-3 py-2 flex items-center justify-center",onClick:l[0]||(l[0]=g=>n(r.image))},[vn,ae(" "+f(r.$t("download")),1)]),c("button",{class:"text-base border rounded-lg flex-grow text-white gap-1.5 font-400 px-3 py-2 flex items-center justify-center",onClick:l[1]||(l[1]=g=>v(e).closeAll())},f(r.$t("close")),1)])):w("",!0)]),_:1})}}}),kn=["onClick"],wn=c("div",{class:"absolute inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1),bn=L({__name:"ImageMessageContent",props:{message:{}},setup(s){const e=s,o=W(),t=A(()=>o.state.imkit.uploadProgresses),a=(r,l)=>{if(e.message.images.length===1){const{width:g,height:p}=l;return g<p?{width:"200px",height:`${200*p/g}px`}:{width:`${200*g/p}px`,height:"200px"}}else return r===e.message.images.length-1&&r%2===0?{width:`${200*2+1}px`,height:"200px"}:{width:"200px",height:"200px"}},n=r=>{const{open:l}=Ae({component:yn,attrs:{image:r}});l()};return(r,l)=>{const d=Qe("src");return i(),u("div",{class:K(["-m-2 grid gap-1px",[r.message.images.length>1?"grid-cols-2":"grid-cols-1"]])},[(i(!0),u(N,null,Z(r.message.images,(g,p)=>(i(),u("div",{key:g.thumbnailUrl,class:K(["relative flex items-center justify-center",{"col-span-2":r.message.images.length>1&&p===r.message.images.length-1&&p%2===0}]),onClick:m=>n(g)},[ee(c("img",{src:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"border-0 object-cover transition",style:J(a(p,g))},null,4),[[d,g.thumbnailUrl]]),g.thumbnailUrl.startsWith("data")?(i(),u(N,{key:0},[wn,j(v(je),{class:"!absolute",diameter:40,"completed-steps":t.value[`${g.id}-original`]===void 0?(t.value[`${g.id}-original`]+t.value[`${g.id}-thumbnail`])/2*100:t.value[`${g.id}-original`]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):w("",!0)],10,kn))),128))],2)}}}),xn=["src"],Cn=L({__name:"StickerMessageContent",props:{message:{}},setup(s){const e=s,o=A(()=>e.message.stickerUrl?e.message.stickerUrl:`/sticker/${e.message.stickerId.split("-")[0]}/${e.message.stickerId}.png`);return(t,a)=>(i(),u("img",{src:o.value,class:"border-0 object-contain w-30 h-30"},null,8,xn))}}),Et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpUlEQVR4nO3bP68MURzH4RMhNIobEhoJFaFCKRI6Ha/AW9DSKeUqVVqlmkQv8ScUOoVGgUSnQCM8MpFJZJmz17V398zO9ym32nwyO7O/M+eUEhERERERK4Z9OLDq79EcnMIjfPfLB9zA3jJ1OIMv/u41zpUpw0t13VV1B/vL1OCYrXuLS2VKcN6/uzeZGzku2J6PuFrWne0H6j3AkbKu/H+gzidcw66ybiwmUO8xjpd1YrGBOl9xE3vKOrD4QL1XOFvGzs4F6nzDrW6+K2NlZwP13uBiGSPLCdT5gbujG1csL1DvPS6XsbD8QL37OFhaZ3WBxjGuWG2g3sNmxxVtBGp3XNFOoN/HlROlFdoL1Na4os1Avac4nEB1z7E7V1DdlQSqu51AdZsJVJefWMWz3KSHPcGhPOb/lD+KFRk1BmRYrchyx4AsmFVkyXVAFu0H5LVPRV4cDsir54psXmh+TFgE2UBVly14c2QT5xzZBjxHNpLPgaO2bnpHETp4MSfMdA+zdHAanwfi5DhUBydnDtS9w/UcqJvRBcHG7OcREREREVEm5icELZJIi+Y1dAAAAABJRU5ErkJggg==",In=c("div",{class:"absolute inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1),Rn=c("img",{class:"absolute pointer-events-none",src:Et,width:"24",height:"24"},null,-1),En={class:"absolute right-2 bottom-2 text-white font-bold bg-black bg-opacity-30 rounded-full text-xs py-1 px-2"},Fn=L({__name:"VideoMessageContent",props:{message:{}},setup(s){const e=s,o=`vp-${Math.random()}`,t=S(),a=S(),n=S(!1),r=()=>{const{width:m,height:h}=e.message.video;return m<h?{width:"200px",height:`${200*h/m}px`}:{width:`${200*m/h}px`,height:"200px"}},l=W(),d=async()=>{if(n.value)return;n.value=!0;const p=await l.dispatch("imkit/fetchVideoBlob",e.message.video.originalUrl);t.value&&(t.value.src=URL.createObjectURL(p)),a.value=Zt(o)},g=A(()=>l.state.imkit.uploadProgresses);return(p,m)=>{const h=Qe("src");return i(),u("div",{class:"-m-2 relative flex items-center justify-center cursor-pointer",style:J(r()),onClick:d},[ee(c("video",{ref_key:"videoPlayer",ref:t,id:o,class:"video-js vjs-default-skin absolute inset-0 w-full h-full",controls:"",preload:"auto",autoplay:""},null,512),[[Ht,n.value]]),n.value?w("",!0):(i(),u(N,{key:0},[ee(c("img",{src:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"border-0 object-cover transition",style:J(r())},null,4),[[h,p.message.video.thumbnailUrl]]),p.message.video.thumbnailUrl.startsWith("data")?(i(),u(N,{key:0},[In,j(v(je),{class:"!absolute",diameter:40,"completed-steps":g.value[p.message.video.id]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):(i(),u(N,{key:1},[Rn,c("div",En,f(Math.floor(p.message.video.duration/60))+":"+f(`${Math.floor(p.message.video.duration%60)}`.padStart(2,"0")),1)],64))],64))],4)}}}),Sn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABV0lEQVR4nO3aMUpDQRSF4VmI1m5HtLCxkMxxA86JazAz2Ygi2LkgbVWMpQpKFCyihSZ33r0x58As4GP+F17gpaRp2sbs6GS6nUu7RGlPYHuzPrm029HJdDdFwYL1vgd0Af2Sx5MDb2/6uNnO2FBodMr4C8n6HAqN/re6t4gG62tmPfyX4PT52MRBYwBwKDQGAodBY0BwCDQGBruj4QB2RcMJ7IaGI9gFDWfwfMes+z+9kXX5w4HOYJyebS2LBuvN2oEz6/Uq6LUDY4BH4k/zBglM3bDtECBbPcPUj5bdECBbJU0lbTcEyFZJU0nbDQGyVdJU0nZDgGyVNJW03RAgWyVNJW03BMhWSVNJ2w0BslXSVNJ2Q4BslTSVtN2wcUmXvh+XrnJyaY/2YNarsGDWc3PwaDzZyaU9eOO+ndLufvupxHJfxZd2AdaZO5R1Nr/ZblhN01LEvQM/68r6Ex4bqgAAAABJRU5ErkJggg==",Ft=s=>(fe("data-v-dcb5aa19"),s=s(),ve(),s),Bn=Ft(()=>c("img",{class:"w-8 object-contain",src:Sn},null,-1)),Mn={class:"flex flex-col gap-0.5 font-400"},Un={class:"text-base break-all"},Tn=Ft(()=>c("div",{class:"absolute -m-2 inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1)),On=L({__name:"FileMessageContent",props:{message:{}},setup(s){const e=s,o=W(),t=A(()=>e.message.isIncoming),a=A(()=>o.state.imkit.uploadProgresses),n=A(()=>{const l=e.message.bytes;return l<1e3?l+"B":l<1e3*1e3?(l/1e3).toFixed(1)+"KB":l<1e3*1e3*1e3?(l/1e3/1e3).toFixed(1)+"MB":(l/1e3/1e3/1e3).toFixed(1)+"GB"}),r=async()=>{try{const{url:l,fileName:d,fileExtension:g}=e.message,p=await o.state.imkit.axios.get(l,{responseType:"arraybuffer",onDownloadProgress:C=>{const{total:y}=C;y&&o.commit("imkit/updateField",{key:"downloadProgresses",value:{[l]:C.loaded/y}})}}),m=btoa(new Uint8Array(p.data).reduce((C,y)=>C+String.fromCharCode(y),"")),h=document.createElement("a");h.href=`data:${p.headers["content-type"]};base64,${m}`,h.download=`${d}.${g}`,h.click()}catch(l){console.error(l)}};return(l,d)=>(i(),u("div",{class:"flex items-center justify-center gap-2 cursor-pointer relative",onClick:r},[Bn,c("div",Mn,[c("div",Un,f(l.message.fileName)+"."+f(l.message.fileExtension),1),c("div",{class:K(["text-sm",{"text-gray-500":t.value}])},f(l.$t("fileSize"))+": "+f(n.value),3)]),l.message.url===""?(i(),u(N,{key:0},[Tn,j(v(je),{class:"!absolute",diameter:40,"completed-steps":a.value[l.message.id]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):w("",!0)]))}});const Ln=ce(On,[["__scopeId","data-v-dcb5aa19"]]),me=s=>{s.type==="uri"&&window.open(s.uri,"_blank")},_n={class:"w-250px text-base overflow-hidden cursor-pointer"},Qn=["src"],Vn={key:1,class:"py-3 flex flex-col gap-2 border-t"},Kn=["onClick"],Nn=L({__name:"TemplateMessageButtonsContent",props:{message:{}},setup(s){const e=s,o=A(()=>e.message.isIncoming),t=A(()=>!o.value);return(a,n)=>{var r;return i(),u("div",_n,[a.message.template.thumbnailImageUrl?(i(),u("img",{key:0,class:K(["object-cover",{"object-contain":a.message.template.imageSize==="contain"}]),style:J({"background-color":a.message.template.imageBackgroundColor??"#ffffff",height:`${a.message.template.imageAspectRatio==="square"?250:250/1.51}px`}),src:a.message.template.thumbnailImageUrl,onClick:n[0]||(n[0]=l=>v(me)(a.message.template.defaultAction))},null,14,Qn)):w("",!0),c("div",{class:"p-3 flex flex-col gap-1",onClick:n[1]||(n[1]=l=>v(me)(a.message.template.defaultAction))},[c("div",null,f((r=a.message.template.title)==null?void 0:r.substring(0,40)),1),a.message.template.text?(i(),u("div",{key:0,class:K(["text-sm",{"text-gray-500":o.value,"text-gray-100":t.value}])},f(!a.message.template.thumbnailImageUrl&&!a.message.template.title?a.message.template.text.substring(0,160):a.message.template.text.substring(0,60)),3)):w("",!0)]),a.message.template.actions.length>0?(i(),u("div",Vn,[(i(!0),u(N,null,Z(a.message.template.actions,l=>(i(),u("div",{key:l.label,class:K(["flex items-center justify-center text-sm p-0.5",{"text-slate-500":o.value,"text-slate-100":t.value}]),onClick:d=>v(me)(l)},f(l.label),11,Kn))),128))])):w("",!0)])}}}),Pn={class:"w-250px text-base overflow-hidden"},Gn={class:"p-3"},Yn={class:"flex border-t divide-x"},jn=["onClick"],Dn=L({__name:"TemplateMessageConfirmContent",props:{message:{}},setup(s){const e=s,o=A(()=>e.message.isIncoming),t=A(()=>!o.value);return(a,n)=>(i(),u("div",Pn,[c("div",Gn,f(a.message.template.text.substring(0,240)),1),c("div",Yn,[(i(!0),u(N,null,Z(a.message.template.actions.slice(0,2),r=>(i(),u("div",{key:r.label,class:K(["flex-grow flex items-center justify-center p-2 cursor-pointer",{"text-slate-500":o.value,"text-slate-100":t.value}]),onClick:l=>v(me)(r)},f(r.label),11,jn))),128))])]))}}),Xn={class:"text-base overflow-auto cursor-pointer flex gap-2"},Wn=["src","onClick"],zn=["onClick"],Jn={key:1,class:"py-3 flex flex-col gap-2 border-t"},Hn=["onClick"],Zn=L({__name:"TemplateMessageCarouselContent",props:{message:{}},setup(s){const e=s,o=A(()=>e.message.isIncoming),t=A(()=>!o.value);return(a,n)=>(i(),u("div",Xn,[(i(!0),u(N,null,Z(a.message.template.columns,(r,l)=>{var d;return i(),u("div",{key:l,class:K(["w-250px text-base overflow-hidden cursor-pointer rounded-xl",[o.value?"bg-gray-100 text-gray-900":"bg-blue-400 text-white "]])},[r.thumbnailImageUrl?(i(),u("img",{key:0,class:K(["object-cover",{"object-contain":a.message.template.imageSize==="contain"}]),style:J({"background-color":r.imageBackgroundColor??"#ffffff",height:`${a.message.template.imageAspectRatio==="square"?250:250/1.51}px`}),src:r.thumbnailImageUrl,onClick:g=>v(me)(r.defaultAction)},null,14,Wn)):w("",!0),c("div",{class:"p-3 flex flex-col gap-1",onClick:g=>v(me)(r.defaultAction)},[c("div",null,f((d=r.title)==null?void 0:d.substring(0,40)),1),r.text?(i(),u("div",{key:0,class:K(["text-sm",{"text-gray-500":o.value,"text-gray-100":t.value}])},f(!r.thumbnailImageUrl&&!r.title?r.text.substring(0,160):r.text.substring(0,60)),3)):w("",!0)],8,zn),r.actions.length>0?(i(),u("div",Jn,[(i(!0),u(N,null,Z(r.actions,g=>(i(),u("div",{key:g.label,class:K(["flex items-center justify-center text-sm p-0.5",{"text-slate-500":o.value,"text-slate-100":t.value}]),onClick:p=>v(me)(g)},f(g.label),11,Hn))),128))])):w("",!0)],2)}),128))]))}}),qn={class:"text-base overflow-auto cursor-pointer flex gap-2"},$n=["src","onClick"],er=L({__name:"TemplateMessageImageCarouselContent",props:{message:{}},setup(s){return(e,o)=>(i(),u("div",qn,[(i(!0),u(N,null,Z(e.message.template.columns,(t,a)=>(i(),u("img",{key:a,src:t.imageUrl,class:"w-250px h-250px object-cover rounded-xl",onClick:n=>v(me)(t.action)},null,8,$n))),128))]))}}),tr=L({__name:"TemplateMessageContent",props:{message:{}},setup(s){const e={[ye.Buttons]:Nn,[ye.Confirm]:Dn,[ye.Carousel]:Zn,[ye.ImageCarousel]:er};return(o,t)=>(i(),D(De(e[o.message.templateType]),{message:o.message},null,8,["message"]))}}),sr=L({__name:"FlexMessageBoxComponent",props:{content:{}},setup(s){const e=o=>({none:"0",xs:"2px",sm:"4px",md:"8px",lg:"12px",xl:"16px",xxl:"20px"})[o]??o;return(o,t)=>(i(),u("div",{class:K(["flex",{"flex-col":o.content.layout==="vertical","flex-row":o.content.layout==="horizontal","flex-row items-baseline":o.content.layout==="baseline"}]),style:J({backgroundColor:o.content.backgroundColor??"#00000000",borderColor:o.content.borderColor,borderWidth:o.content.borderWidth,borderRadius:o.content.cornerRadius,width:o.content.width,maxWidth:o.content.maxWidth,height:o.content.height,maxHeight:o.content.maxHeight})},[(i(!0),u(N,null,Z(o.content.contents,(a,n)=>(i(),D(Me,{key:n,content:a,style:J(o.content.layout==="vertical"?{marginTop:a.margin?e(a.margin):n===0?0:e(o.content.spacing)}:{marginLeft:a.margin?e(a.margin):n===0?0:e(o.content.spacing)})},null,8,["content","style"]))),128))],6))}}),or=L({__name:"FlexMessageButtonComponent",props:{content:{}},setup(s){const e=s,o=A(()=>e.content.style==="primary"?"#ffffff":e.content.style==="secondary"?"#000000":e.content.color||"#42659a"),t=A(()=>e.content.style==="primary"?e.content.color||"#17c950":e.content.style==="secondary"?e.content.color||"#dcdfe5":"");return(a,n)=>(i(),u("button",{class:K([[a.content.size==="md"?"h-52px":"h-40px"],"rounded-lg"]),style:J({color:o.value,backgroundColor:t.value}),onClick:n[0]||(n[0]=r=>v(me)(a.content.action))},f(a.content.action.label),7))}}),ar=["src"],nr=L({__name:"FlexMessageImageComponent",props:{content:{}},setup(s){const e=s,o=A(()=>e.content.aspectRatio?e.content.aspectRatio.replace(":","/"):"1/1");return(t,a)=>(i(),u("div",{class:K(["w-full bg-gray-300 overflow-hidden",[t.content.aspectMode==="cover"?"object-cover":"object-contain"]]),style:J({"aspect-ratio":o.value})},[c("img",{class:"w-full h-full",src:t.content.url},null,8,ar)],6))}}),rr=["src"],lr=L({__name:"FlexMessageVideoComponent",props:{content:{}},setup(s){return(e,o)=>(i(),u("video",{src:e.content.url},null,8,rr))}}),ir=L({__name:"FlexMessageIconComponent",props:{content:{}},setup(s){const e=s,o=A(()=>{const t=e.content.size;return{xxs:"12px",xs:"13px",sm:"14px",md:"16px",lg:"19px",xl:"22px",xxl:"29px","3xl":"35px","4xl":"48px","5xl":"74px"}[t]??"16px"});return(t,a)=>(i(),u("span",{style:J({overflow:"hidden",background:"no-repeat center",backgroundSize:"contain",backgroundImage:"url("+t.content.url+")",width:o.value,height:o.value})},null,4))}}),cr=L({__name:"FlexMessageTextComponent",props:{content:{}},setup(s){const e=s,o=A(()=>{const t=e.content.size;return{xxs:"12px",xs:"13px",sm:"14px",md:"16px",lg:"19px",xl:"22px",xxl:"29px","3xl":"35px","4xl":"48px","5xl":"74px"}[t]??"16px"});return(t,a)=>(i(),u("div",{class:"basis-0",style:J({flexGrow:t.content.flex??0})},[c("p",{class:K([t.content.weight==="bold"?"font-700":"font-400",t.content.wrap?"overflow-clip whitespace-normal break-words overflow-hidden":"truncate whitespace-nowrap overflow-hidden"]),style:J({fontSize:o.value,color:t.content.color,"text-size-adjust":"100%"})},f(t.content.text),7)],4))}}),dr=L({__name:"FlexMessageSpanComponent",props:{content:{}},setup(s){return(e,o)=>(i(),u("span",null,f(e.content.text),1))}}),ur=L({__name:"FlexMessageSeparatorComponent",props:{content:{}},setup(s){return(e,o)=>(i(),u("div"))}}),Me=L({__name:"FlexMessageComponent",props:{content:{}},setup(s){const e=s,o={box:sr,button:or,image:nr,video:lr,icon:ir,text:cr,span:dr,separator:ur},t=A(()=>e.content.type);return(a,n)=>(i(),D(De(o[t.value]),{content:a.content},null,8,["content"]))}}),St=L({__name:"FlexMessageBubbleComponent",props:{content:{}},setup(s){const e=s,o=A(()=>e.content.header),t=A(()=>e.content.hero),a=A(()=>e.content.body),n=A(()=>e.content.footer),r=A(()=>{var m;return(m=e.content.styles)==null?void 0:m.header}),l=A(()=>{var m;return(m=e.content.styles)==null?void 0:m.hero}),d=A(()=>{var m;return(m=e.content.styles)==null?void 0:m.body}),g=A(()=>{var m;return(m=e.content.styles)==null?void 0:m.footer}),p=A(()=>{switch(e.content.size){case"nano":return"10px";case"micro":return"13px";case"kilo":return n.value?"13px 13px 17px 13px":"13px";case"mega":return n.value?"19px 20px 10px 20px":"20px";case"giga":return n.value?"19px 20px 10px 20px":"20px";default:return"20px"}});return(m,h)=>{var C,y,M,E,U,R,T,O,k,V,z,_;return i(),u("div",{class:K(["bg-gray-100 text-hex-444444 rounded-xl overflow-hidden",{"w-120px":m.content.size==="nano","w-160px":m.content.size==="micro","w-260px":m.content.size==="kilo","w-300px":m.content.size==="mega"||!m.content.size,"w-386px":m.content.size==="giga"}])},[o.value?(i(),D(Me,{key:0,content:o.value,style:J({backgroundColor:(C=r.value)==null?void 0:C.backgroundColor,borderBottom:(y=r.value)!=null&&y.separator?`1px solid ${(M=r.value)==null?void 0:M.separatorColor}`:"none"})},null,8,["content","style"])):w("",!0),t.value?(i(),D(Me,{key:1,content:t.value,style:J({backgroundColor:(E=l.value)==null?void 0:E.backgroundColor,borderBottom:(U=l.value)!=null&&U.separator?`1px solid ${(R=l.value)==null?void 0:R.separatorColor}`:"none"})},null,8,["content","style"])):w("",!0),a.value?(i(),D(Me,{key:2,content:a.value,style:J({backgroundColor:(T=d.value)==null?void 0:T.backgroundColor,borderBottom:(O=d.value)!=null&&O.separator?`1px solid ${(k=d.value)==null?void 0:k.separatorColor}`:"none",padding:p.value})},null,8,["content","style"])):w("",!0),n.value?(i(),D(Me,{key:3,content:n.value,class:"p-2.5",style:J({backgroundColor:(V=g.value)==null?void 0:V.backgroundColor,borderBottom:(z=g.value)!=null&&z.separator?`1px solid ${(_=g.value)==null?void 0:_.separatorColor}`:"none"})},null,8,["content","style"])):w("",!0)],2)}}}),mr=L({__name:"FlexMessageBubbleContent",props:{message:{}},setup(s){return(e,o)=>(i(),D(St,{content:e.message.contents},null,8,["content"]))}}),gr={class:"flex items-start gap-2 overflow-auto"},pr=L({__name:"FlexMessageCarouselContent",props:{message:{}},setup(s){return(e,o)=>(i(),u("div",gr,[(i(!0),u(N,null,Z(e.message.contents.contents,(t,a)=>(i(),D(St,{key:a,content:t},null,8,["content"]))),128))]))}}),Ar=L({__name:"FlexMessageContent",props:{message:{}},setup(s){const e={[Ze.Bubble]:mr,[Ze.Carousel]:pr};return(o,t)=>(i(),D(De(e[o.message.flexType]),{message:o.message},null,8,["message"]))}}),hr=s=>(fe("data-v-a18b9666"),s=s(),ve(),s),fr={class:"p-2 w-300px <sm:w-250px underline"},vr=hr(()=>c("div",{class:"absolute inset-0"},null,-1)),yr=L({__name:"LocationMessageContent",props:{message:{}},setup(s){const e=s,t=W().state.imkit.config.mapApiKey,a=A(()=>({lat:e.message.latitude,lng:e.message.longitude})),n=()=>{window.open(`https://www.google.com/maps/search/?api=1&query=${e.message.address}`,"_blank")};return(r,l)=>(i(),u("div",{class:"flex flex-col -m-2 cursor-pointer relative",onClick:n},[j(v(At),{"api-key":v(t),center:a.value,zoom:15,disableDefaultUi:!0,class:"w-300px h-200px <sm:w-250px <sm:h-150px"},{default:te(()=>[j(v(pt),{options:{position:a.value}},null,8,["options"])]),_:1},8,["api-key","center"]),c("div",fr,f(r.message.address),1),vr]))}});const kr=ce(yr,[["__scopeId","data-v-a18b9666"]]),wr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACS0lEQVR4nO2bPYsUQRCGG1E0MRAFTQSNTjRSQxE0M9NfoGCwOv3O3k7XKpxR9e7hdyRGlxoan2B+4AcamBmYGKhgZqAmoitzB87eMh93595uz877QCcbLQ9dNV3V1cYQQgghhBBCpswV1T3Anf3T/h/BYZP+Cev0uXX+N8QPIPoFzt9qtx/tNk0HiZ6C+B9rYtYv6/z7OOmdMU0GTt/myRmSlO6qx1dv3t9rmkbcXTxaJmfdcvrROr1gmkSc9M5uWFAm6kljEjm6em7TglYl+a+R08tm1sFWBWW7aTmSxcNmVsH/ClqT9A3iO6q6w8waGIegLOxWrnf6c2aWwDgFpUcC0Z9w6lutpV1mFsCYBQ2Jehd1+6dN3cE2CVqV5PwvK3ovre9MXcE2ChpaHyLXO2/qCCYjKC1+/1jnl2pXrmBigv6F3Web9C6auoAJCxpK4k9bogdM6GBKgmpTrmCagrL1LNhyBWEICrdcQSiCsrBbiUWPmVBAaIJCK1cQoKBMlH9pb+ghCpJSSa9VdSd3kBRLikUvUZCU7CLnH1KQlOUjfUBBwhAbbO1cpK+YpKXwPPRifv72QX7mhQfFwcZDiqXGoCDXsFhF8c5huwP54cSGGYq/UGy5Ir9sYNMe+eUCr31QnIR5cYj8cOLVM4qTMIcXEHo/eRyAA1TlcASvAg5xVsAx4Ao4SF7BtY4e2UT7s3lPEVKs+DcV1y7NfcyS0pb+Sev0e4EcPodKaXf1+MiDuk9WdIEP6kZIhUQLd/eN/k4IIYQQQggxDeMvr6MHGaopSLgAAAAASUVORK5CYII=",br="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4klEQVR4nO2bzy5DQRTGJ8GaDQ+ANZ4FXbDxZ9HoGTc1p01scA5SGmshfQLBAu+gkYgXYqEyjUhEae/0Ti/y/ZJZ3vnO/e733d0xBgAAAAAAgFhsVGSCKrJoK1L8cpwsJ9XDqaw1ycm0v7uz5v5CktTGTd6IyLBlObEsL5a19f2RV8t6WS7LWL+a/g7r9PpnPW2R02fr9NjPaPKCnDa6DfrpOG32M3Cx2Bgh1od0mnJm8oDKMveejN6H9V+WZTVYk2U9rZ6fsVSVGTNorJO99MO2B74N1SSndyGaxLqb7dv3MizreZBBTh5DNf2zgQadm1///+EPg55CNf2zQQY5bZhBQzAIBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAb1lyDGKkKUZRZyemMGvcziZMcMmk13MBuyDmW3dCVU0zpd+zPrUCE1I5b7fhbq2huOTpsp03Nq8kJEhoml3l5/7PIVifWiuF0fzWIlk1iueqjyM7EcFQpXQyZvkqQ2XqrIfKcFW2JdKm3JZNaa/k5/dydNP8uvWOoFAAAAAADm3/IGGLsxyp+ApQ8AAAAASUVORK5CYII=",xr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVR4nO3bTy5DYRSG8ZuosU5qAWWMtZQJE38GVkGHiHGj6QoEA+yBSJpuiIFXGtesvPee77sp+vwS057zPcXsFAUAAADQFEmrknYkHc/42ZO01sDM9fKzZ83cltTJPTOyZEvSpaQ3/exd0o2kdoaZbUl38l4lnU93zPPa2LIj1fOcsrCkZUkvNWde5X119WW3yt+Mug4SZh4F5k133Mj7+mrL9hXzkDDzMTjzNO/rqy07DC47Tpg5Ds4c5n19M/9/vkwSZk4UM8r7+mrLjoLLEsggkEEgg0AGgQwCGQQyCGQQyCCQQSCDQAaBDAIZBDIIZBDIIJBBIINABoEMAhkEMghkEMggkEEgg0AGgQwCGQQyCGQQyCCQQSCDQAaBDAIZBDIIZCxMoGFw2YU5RegHl72fwzHLSd7XV1t2M3gOtZ8w8/DPnEMF/8yeEg/qWuVRXh2DYl70ufBFef7ovsVrSSuZTjJvK4SZ7nQmaSnPa9OW7kjqfXNguyup28DMbvnZs2b2fsVRLwAAAIp/6wPxkEFCV8mUxgAAAABJRU5ErkJggg==",Cr=["onClick"],Ir={key:0,src:wr,width:"24",height:"24"},Rr={key:1,src:Et,width:"24",height:"24"},Er={key:1,class:"h-5 flex items-center justify-center"},Fr=c("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"},null,-1),Sr=c("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"},null,-1),Br=[Fr,Sr],Mr={key:0,src:br,width:"24",height:"24"},Ur={key:1,src:xr,width:"24",height:"24"},Tr={class:"text-white font-bold bg-black bg-opacity-30 rounded-full text-xs py-1 px-2"},Or=L({__name:"AudioMessageContent",props:{message:{}},setup(s){const e=s,o=W(),t=S(0),a=S(),n=S(0),r=S(),l=A(()=>e.message.isIncoming),d=()=>{a.value&&(n.value=a.value.seek()/a.value.duration()*100,a.value.playing()&&requestAnimationFrame(d))},g=async()=>{var m,h;switch(t.value){case 0:{const C=new qt.Howl({src:e.message.url,format:["m4a","mp3","wav","aac","webm"],onload:()=>{C.play(),t.value=3},onplay:()=>{requestAnimationFrame(d)},onend:()=>{t.value=2},onloaderror:(y,M)=>console.log(2,y,M),xhr:{headers:{"IM-Authorization":o.state.imkit.config.token,"IM-Client-Key":o.state.imkit.config.clientKey}}});a.value=C,t.value=1;break}case 2:case 4:(m=a.value)==null||m.play(),t.value=3;break;case 3:(h=a.value)==null||h.pause(),t.value=4;break}},p=async m=>{if(!a.value||!r.value)return;const{x:h,width:C}=r.value.getBoundingClientRect();n.value=(m.clientX-h)/C*100,a.value.seek(a.value.duration()*n.value/100)};return(m,h)=>(i(),u(N,null,[c("div",{class:K(["absolute top-0 bottom-0 left-0 pointer-events-none",[l.value?"bg-gray-300":"bg-blue-300"]]),style:J({width:`${n.value}%`})},null,6),c("div",{ref_key:"container",ref:r,class:"flex items-center justify-between w-250px p-3 relative -m-2",onClick:p},[c("button",{onClick:re(g,["stop"])},[new Set([0,2,4]).has(t.value)?(i(),u(N,{key:0},[l.value?(i(),u("img",Ir)):(i(),u("img",Rr))],64)):t.value===1?(i(),u("div",Er,[(i(),u("svg",{class:K(["w-5 h-5 animate-spin",[l.value?"text-gray-400 fill-gray-100":"text-gray-200 fill-blue-400"]]),viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Br,2))])):t.value===3?(i(),u(N,{key:2},[l.value?(i(),u("img",Mr)):(i(),u("img",Ur))],64)):w("",!0)],8,Cr),c("div",Tr,f(Math.floor(m.message.duration/60))+":"+f(`${Math.floor(m.message.duration%60)}`.padStart(2,"0")),1)],512)],64))}}),Lr={class:"flex items-center justify-center"},_r={class:"bg-gray-100 rounded-lg py-1.5 px-2 my-3 text-sm text-gray-700"},Qr=L({__name:"SystemMessageContent",props:{message:{}},setup(s){const e=s,o=W(),t=A(()=>o.state.imkit.users),a=A(()=>{const{t:n}=we(),r=t.value[e.message.senderId].nickname;switch(e.message.type){case F.Recall:return e.message.senderId===o.state.imkit.uid?n("youUnsentMessage"):n("someoneUnsentMessage",[r]);case F.JoinRoom:return n("someoneJoinedTheChat",[r]);case F.LeaveRoom:return n("someoneLeftTheChat",[r]);case F.AddMember:return n("someoneInvited",[r,e.message.members.map(l=>l.nickname).join(", ")]);case F.DeleteMember:return n("someoneKicked",[r,e.message.members.map(l=>l.nickname).join(", ")]);case F.AddMembers:return n("someoneInvited",[r,e.message.members.map(l=>l.nickname).join(", ")]);case F.Announcement:return e.message.text;default:return""}});return(n,r)=>(i(),u("div",Lr,[c("div",_r,f(a.value),1)]))}}),Vr={key:3,class:"text-gray-500 text-xs self-end flex flex-col items-end"},Kr={key:0},Nr={key:5,class:"w-30px"},Pr={class:"flex flex-col items-stretch max-w-3/5 <sm:max-w-3/4"},Gr={key:0,class:"text-xs font-500 text-gray-500 ml-1 mb-1"},Yr={key:6,class:"text-gray-500 text-xs self-end"},jr=L({__name:"MessageCell",props:{source:{}},setup(s){const e=s,o=e.source,t={[F.Text]:ge,[F.Image]:bn,[F.Sticker]:Cn,[F.Video]:Fn,[F.File]:Ln,[F.Template]:tr,[F.Flex]:Ar,[F.Location]:kr,[F.Audio]:Or,[F.Recall]:ge,[F.JoinRoom]:ge,[F.LeaveRoom]:ge,[F.AddMember]:ge,[F.DeleteMember]:ge,[F.AddMembers]:ge,[F.Announcement]:ge},a=W(),n=A(()=>{if(a.state.imkit.uid!==e.source.senderId)return 0;const{rooms:O,uid:k,messages:V}=a.state.imkit,z=O[e.source.roomId];return z?Object.keys(z.lastReadMessageId).filter(_=>_!==k).map(_=>{const P=z.lastReadMessageId[_];return V[P]}).reduce((_,P)=>P&&P.createdAt>=e.source.createdAt?_+1:_,0):0}),r=A(()=>e.source.isIncoming),l=A(()=>!r.value),d=A(()=>a.state.imkit.messageGroupHead[e.source.id]),g=A(()=>a.state.imkit.messageGroupTail[e.source.id]),p=S(!1),m=O=>{p.value=!0,O.preventDefault()},h=()=>{a.commit("imkit/setState",{replyId:e.source.id})},C=()=>{let O="";switch(e.source.type){case F.Text:O=e.source.text;break;case F.Location:O=e.source.address;break}navigator.clipboard.writeText(O)},y=()=>{a.dispatch("imkit/recallMessage",{roomId:e.source.roomId,_id:e.source.id,messageType:"recall"})},M=A(()=>{const O=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g;if(e.source.type===F.Text){const k=e.source.text;for(let V=0;V<k.length;V++)if(!O.test(k[V]))return!1;return!0}return!1}),E=A(()=>e.source),U=A(()=>new Set([F.Recall,F.JoinRoom,F.LeaveRoom,F.AddMember,F.DeleteMember,F.AddMembers,F.Announcement]).has(e.source.type)),R=A(()=>a.state.imkit.config.styles),T=A(()=>a.state.imkit.users[e.source.senderId]);return(O,k)=>{var V,z,_;return U.value?(i(),D(Qr,{key:0,message:O.source},null,8,["message"])):(i(),u("div",{key:1,class:K(["flex gap-2",[r.value?"justify-start":"justify-end",d.value?"mt-1":"mt-0.25",g.value?"mb-1":"mb-0.25"]]),onMouseleave:k[1]||(k[1]=P=>p.value=!1),onClick:k[2]||(k[2]=P=>p.value=!1)},[l.value&&p.value?(i(),u("img",{key:0,src:Ja,class:"w-5 h-5 my-auto cursor-pointer",onClick:y})):w("",!0),l.value&&p.value?(i(),u("img",{key:1,src:lt,class:"w-5 h-5 my-auto cursor-pointer",onClick:C})):w("",!0),l.value&&p.value?(i(),u("img",{key:2,src:it,class:"w-5 h-5 my-auto cursor-pointer",onClick:h})):w("",!0),l.value&&g.value&&!p.value?(i(),u("div",Vr,[n.value>0?(i(),u("div",Kr,f(O.$t("read"))+" "+f(n.value),1)):w("",!0),c("div",null,f(v(se)(O.source.createdAt).format("H:mm")),1)])):w("",!0),r.value&&d.value?(i(),D(oe,{key:4,url:((V=T.value)==null?void 0:V.avatarUrl)??"",name:((z=T.value)==null?void 0:z.nickname)??"",class:"h-30px w-30px rounded-full text-xs"},null,8,["url","name"])):r.value?(i(),u("div",Nr)):w("",!0),c("div",Pr,[r.value&&d.value?(i(),u("div",Gr,f(((_=T.value)==null?void 0:_.nickname)??""),1)):w("",!0),c("div",{class:K(["rounded w-full overflow-hidden relative",[r.value?"bg-gray-100 text-gray-900 rounded-r-xl":"bg-blue-400 text-white rounded-l-xl",l.value&&d.value?"rounded-tr-xl":"",l.value&&g.value?"rounded-br-xl":"",r.value&&d.value?"rounded-tl-xl":"",r.value&&g.value?"rounded-bl-xl":"",[v(F).Sticker,v(F).Image].includes(O.source.type)?"!bg-white":"",M.value?"!bg-white !text-3xl":"",[v(F).Template,v(F).Flex].includes(O.source.type)?"!bg-white !rounded-none":"py-1.5 px-2 ",[v(ye).ImageCarousel,v(ye).Carousel].includes(E.value.templateType)?"!bg-white !rounded-none":""]]),style:J([r.value?R.value.incomingMessageCell:R.value.outgoingMessageCell]),onContextmenu:m,onMouseenter:k[0]||(k[0]=P=>p.value=!0)},[(i(),D(De(t[O.source.type]),{message:v(o)},null,8,["message"]))],38)]),r.value&&g.value&&!p.value?(i(),u("div",Yr,f(v(se)(O.source.createdAt).format("H:mm")),1)):w("",!0),r.value&&p.value?(i(),u("img",{key:7,src:it,class:"w-5 h-5 my-auto cursor-pointer",onClick:h})):w("",!0),r.value&&p.value?(i(),u("img",{key:8,src:lt,class:"w-5 h-5 my-auto cursor-pointer",onClick:C})):w("",!0)],34))}}});const Dr=ce(jr,[["__scopeId","data-v-f0c87f5b"]]),Xr={class:"overflow-auto absolute right-0 bottom-[110%] rounded-xl h-80 w-80 max-w-full bg-white border flex flex-col divide-y"},Wr={class:"flex-grow grid grid-cols-4 p-4 gap-4 items-center justify-center overflow-y-auto <sm:grid-cols-3"},zr=["src","onClick"],Jr={key:0,class:"flex flex-shrink-0 h-14 w-full overflow-x-auto p-3 gap-4"},Hr=["src","onClick"],Zr=L({__name:"StickerPanel",emits:["close"],setup(s,{emit:e}){const o=W(),t=[{name:"FunFunFamily",number:40}],a=S(t[0]),n=A(()=>o.state.imkit.rooms[o.state.imkit.selectedRoomId]),r=async l=>{const d={roomId:n.value.id,messageType:"sticker",sticker:l};await o.dispatch("imkit/sendMessage",d),e("close")};return(l,d)=>(i(),u("div",Xr,[c("div",Wr,[(i(!0),u(N,null,Z(a.value.number,g=>(i(),u("img",{src:`/sticker/${a.value.name}/${a.value.name}-${g}.png`,key:g,class:"border-0 cursor-pointer object-contain",onClick:p=>r(`${a.value.name}-${g}`)},null,8,zr))),128))]),t.length>1?(i(),u("div",Jr,[(i(),u(N,null,Z(t,g=>c("img",{src:`/sticker/${g.name}/${g.name}-1.png`,key:g.name,class:"border-0 cursor-pointer object-contain h-full",onClick:p=>a.value=g},null,8,Hr)),64))])):w("",!0)]))}}),ze=s=>new Promise((e,o)=>{const t=new FileReader;t.onload=()=>{const a=new Image;a.src=t.result,a.onload=async()=>{e({id:await He(a.src),width:a.width,height:a.height,thumbnailUrl:a.src,originalUrl:a.src})},a.onerror=()=>o},t.onerror=()=>{o(t.error)},t.readAsDataURL(s)}),qr=s=>new Promise((e,o)=>{const t=document.createElement("canvas"),a=t.getContext("2d");if(!a){o(new Error("Could not get canvas context"));return}const n=document.createElement("video");n.src=URL.createObjectURL(s),n.autoplay=!0,n.onloadedmetadata=()=>{t.width=n.videoWidth,t.height=n.videoHeight},n.onloadeddata=()=>{a.drawImage(n,0,0,t.width,t.height),t.toBlob(async r=>{if(!r){o(new Error("Could not create blob"));return}const l=new File([r],"snapshot.jpg",{type:"image/jpeg"}),d=new FileReader;d.readAsDataURL(r),d.onloadend=async()=>{e({id:await He(n.src),width:t.width,height:t.height,duration:n.duration,thumbnailUrl:d.result,originalUrl:"",thumbnailFile:{id:await He(t.toDataURL()),file:l}})}},"image/jpeg")},n.onerror=()=>o}),$r={key:0,class:"bg-gray-200 rounded-lg mb-3 flex gap-2 p-2"},el={class:"flex flex-col gap-1"},tl={class:"text-sm font-bold text-gray-600"},sl={class:"text-xs text-gray-500 multiline-ellipsis"},ol={class:"flex gap-2 ml-auto flex-shrink-0"},al={key:0,class:"w-10 h-10 rounded object-cover"},nl=L({__name:"ReplyMessagePreview",setup(s){const e=W(),o=A(()=>{const{replyId:l}=e.state.imkit;return e.state.imkit.messages[l]}),t=A(()=>{const l=o.value;if(l)return e.state.imkit.users[l.senderId]}),a=A(()=>{if(o.value.type===F.Text)return o.value.text;if(o.value.type===F.Image){const{t:l}=we();return{[F.Text]:l("text"),[F.Image]:l("image"),[F.Video]:l("video"),[F.Sticker]:l("sticker")}[o.value.type]}return""}),n=A(()=>{if(o.value.type===F.Image)return o.value.images[0]}),r=()=>{e.commit("imkit/setState",{replyId:""})};return(l,d)=>{var p,m,h;const g=Qe("src");return o.value?(i(),u("div",$r,[j(oe,{class:"bg-gray-300 row-span-2 h-24px w-24px rounded-lg text-sm flex-shrink-0",url:((p=t.value)==null?void 0:p.avatarUrl)??"",name:((m=t.value)==null?void 0:m.nickname)??""},null,8,["url","name"]),c("div",el,[c("div",tl,f((h=t.value)==null?void 0:h.nickname),1),c("div",sl,f(a.value),1)]),c("div",ol,[n.value?ee((i(),u("img",al,null,512)),[[g,n.value.thumbnailUrl]]):w("",!0),c("img",{src:et,class:"w-5 h-5 cursor-pointer text-gray-400",onClick:r})])])):w("",!0)}}});const rl=ce(nl,[["__scopeId","data-v-cb053e2d"]]),ll="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXElEQVR4nO2Zv2sUQRTHH4qKhYWFiljYSqLVFbl9M3aiQbAzWFgGrA0Wlrvz7oKKRLAMWomN9w8o2AdLG7EJgj8awUKy995GRFcWklxiSLxzf8zMMh/49vtlZt/37XcBAoFAIBAIBAL7oyidVsRGGXnUpfQCtBF8kB9TSTaviFcUSb4lwxLF6XloC2gkQuKnSJzuMLpNSPwQfEYvrp1A4gUkfreXyb9OOQHviPMDupddQuJnxTUdy+iW0mnwhW6fz2iSu2j4w2QmN8Ur4DpTcX5YGb6GJAMk/vl/RjeUZPPgKlG8fg4N31ckX0uZHA2rtJje4BLdpfyoNjKHhl8rw7+rMDoaVvIEXEETd5BkWRleq9TkdvW5a9fkve/HNfEtNPK2NpOjYfXewziRMu/vgmdxImVO90exnPgVJ1TmdGXgVZyokorM8EotRjGRG7u+TiwLiT8Wc6N6szS8attcox8KiuSOdXO7xL+inpytxfDF/vC0Mrxq3+QOvYK6p7LeXAvtm82LZ4GmV0UkzqwYNvJt9nF+BJpmZjE9VSwciuRzw+/vEthkqvHr7lCroWu/7o62GjN1XXeXW42qr7uTrcZ+IMmb1rQa44CJ3PS61ZiUznJ+SBn54lerUZJi4fei1aiKKE5PouF1J1uNulDEzyc6XcMvwGc0cWciw73sMvgOjhlRaPjT3CA/CL6DY0YUksTQBjpjRVSNrYaLEYVGXkKbiP4RURHxdWgbaq+IstVq2Isoy61G8xHlUKtRf0Q52mpU/GNu1UoFa4uNsv+27g1nrT1EIBAIBAJghT+Mm9s2KhDbfwAAAABJRU5ErkJggg==",Bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACy0lEQVR4nO1Zu24TQRRdAaGg5FHx+AsQfIgFgj5NZOeeSQGi2Y7QWiQKiCaW0iFCAaHhD1JEAoUPIKQiMRKR7Jld4wy66weOsbUzuzO7RvKRrmTJo/U5O/feOXMdBHPMMUdu6ErlfHt5+Z4ieiqBt5LoqyT6KYE4id7nff6O17SAuzoMzwVloy3ETUn0XBEdKkBbxncJrLaq1RuFEz+pVq8p4JUkijIQPxOy94yNEyGuFkI+Ah5KomZe4hPiOAIeeCOuFxcXFPDaA3F9Johe8m+5Jn9JAh+9k8cwrXb4N12RXyiSvPobn3QYXswtoJC0wdTYyEW+TfSoRPKaIxLifibyv5aWriiio7IFSKJmphbLfb5s8moQROtW5Pl0tDqkhNBxvW5MKFkrhM0uRO1a7ZaxgMQeWJD/vburdberO1tb6eQ3N5O13b09rVZWzEUAq0bk2WSxT7EiP0CKiAH54fI9CxFEh2waUwUkrtIiFUYJDUTEjca/axuNyWvrFqkH3EkVwHbXpsDG3+qknZi2JjZIubFdeGKS/9tWD00R4Yw8kjp4ky4A2Ld98FQRp6e9cEBe9brRF5MdyGyVJ4pwRF71UujIRECuS0oiYvyt93cjF3kkKaRKFdApSEDTZwp1vKcQ/Bdxx3MRbzsh3y9Yk3NCuWyjrg6y0YJ1KOJxqgAeOs2slajVbpuZOaKDrGYu9mXmgG/G0zy2rlnsdOzTThM9MyI/kxcaQLWA64ENeCJgWWD+guhFYAsNXJ6FS70CjjPPTXlWWbaASIhKkAc8qyxRwFqQF3wPlcC7oslL4IMOwwu5BQyHu0Q7hZEneu9suDs2Xi+iM605e/OTwLNKT93pR+6CtZybrvMB4yDXFfd5bttB0eDTMbEdpt5pNIgO2B5Yn7A+wCaLh048t2HPzhcPvtmxHelHUwKf+Tu2xOwqZ+Jv1jnmCP5//AFGuxmMzLZJIgAAAABJRU5ErkJggg==",tt=s=>(fe("data-v-21b242a4"),s=s(),ve(),s),il={class:"relative flex justify-center"},cl=tt(()=>c("img",{class:"w-4 h-4",src:Ee},null,-1)),dl=[cl],ul={key:0,class:"transition duration-150 ease-in-out absolute flex items-center gap-1 bottom-2 bg-white bg-opacity-85 rounded-full shadow-lg p-2 text-xs"},ml=tt(()=>c("img",{class:"w-4 h-4",src:Bt},null,-1)),gl=["disabled"],pl={key:0,class:"w-full h-10.5 flex items-center justify-center"},Al=tt(()=>c("svg",{class:"w-6 h-6 text-gray-200 animate-spin fill-blue-300",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),c("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})],-1)),hl=[Al],fl={class:"text-base font-600"},vl={class:"text-xs"},yl=L({__name:"LocationModal",setup(s){class e{constructor(O,k,V=null){I(this,"lat");I(this,"lng");I(this,"address");this.lat=O,this.lng=k,this.address=V}get isValid(){return this.address!==null}}const o=he(),{t}=we(),a=W(),n=a.state.imkit.config.mapApiKey,r=S(),l=S(new e(21.30895,-157.826182)),d=S({lat:l.value.lat,lng:l.value.lng}),g=A(()=>({position:{lat:l.value.lat,lng:l.value.lng}})),p=S(""),m=S(!1),h=S(10),C=S(!1),y=S(""),M=()=>new Promise((T,O)=>{m.value=!0,navigator.geolocation.getCurrentPosition(k=>{let{latitude:V,longitude:z}=k.coords;y.value="",m.value=!1,T({lat:V,lng:z})},k=>{switch(m.value=!1,k.code){case k.PERMISSION_DENIED:y.value=t("noAccessLocationPermission");break;case k.POSITION_UNAVAILABLE:y.value=t("locationInfoUnavailable");break;case k.TIMEOUT:y.value=t("requestLocationTimeout");break}O(k)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),E=async(T,O)=>{try{const{data:k}=await Le.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${T},${O}&key=${n}`);if(k.error_message)throw new Error(k.error_message);return k.results[0].formatted_address}catch(k){throw y.value=t("addressUnavailable"),k}},U=$e(700,async T=>{var O,k;try{if(T===0){const _=(O=r.value)==null?void 0:O.map.getCenter();if(_){const{lat:P,lng:G}=_;l.value=new e(P(),G())}}else if(T===1){const{lat:_,lng:P}=await M();l.value=new e(_,P),h.value=17,(k=r.value)==null||k.map.panTo({lat:_,lng:P})}let{lat:V,lng:z}=l.value;z=((z+180)%360+360)%360-180,V=Math.max(Math.min(V,90),-90),p.value=await E(V,z),l.value=new e(V,z,p.value)}catch(V){console.error(V)}},{noLeading:!1,noTrailing:!1}),R=async()=>{C.value=!0;const T={roomId:a.state.imkit.selectedRoomId,messageType:"location",message:p.value,latitude:g.value.position.lat,longitude:g.value.position.lng};o.closeAll(),await a.dispatch("imkit/sendMessage",T),C.value=!1};return U(1),(T,O)=>(i(),D(v(be),{class:"flex items-center justify-center","content-class":"flex flex-col bg-white rounded-lg overflow-hidden w-450px <sm:w-350px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:te(()=>[c("div",il,[j(v(At),{ref_key:"mapRef",ref:r,"api-key":v(n),center:d.value,zoom:h.value,disableDefaultUi:!0,onCenter_changed:O[0]||(O[0]=k=>v(U)(0)),class:"w-450px h-350px <sm:w-350px <sm:h-250px"},{default:te(()=>[j(v(pt),{options:g.value},null,8,["options"])]),_:1},8,["api-key","center","zoom"]),c("button",{class:"absolute top-2 right-2 flex items-center justify-center bg-white rounded-full shadow-lg w-9 h-9",onClick:O[1]||(O[1]=k=>v(o).closeAll())},dl),c("button",{class:"absolute bottom-2 right-2 flex items-center justify-center bg-white rounded-full shadow-lg w-9 h-9",onClick:O[2]||(O[2]=k=>v(U)(1))},[c("img",{class:K(["w-5 h-5",{"animate-pulse":m.value}]),src:ll},null,2)]),j(Oe,null,{default:te(()=>[y.value?(i(),u("div",ul,[ml,ae(" "+f(y.value),1)])):w("",!0)]),_:1})]),c("button",{class:"flex flex-col items-center gap-0.5 bg-blue-400 disabled:cursor-not-allowed text-white rounded-lg m-2 p-2",disabled:m.value||C.value||!l.value.isValid,onClick:R},[C.value?(i(),u("div",pl,hl)):(i(),u(N,{key:1},[c("div",fl,f(T.$t("sendCurrentLocation")),1),c("div",vl,f(p.value),1)],64))],8,gl)]),_:1}))}});const kl=ce(yl,[["__scopeId","data-v-21b242a4"]]),wl=s=>(fe("data-v-2d2cfa64"),s=s(),ve(),s),bl={class:"flex items-center gap-1 flex-grow"},xl={class:"h-12 bg-gray-100 px-3 rounded-xl w-0 min-w-0 flex-grow flex items-center gap-3 relative"},Cl={key:0,class:"transition duration-150 ease-in-out flex items-center gap-1 bg-white rounded-xl p-2 text-xs text-gray-600"},Il=wl(()=>c("img",{class:"w-4 h-4",src:Bt},null,-1)),Rl={class:"volumes"},El={class:"text-white font-bold bg-black bg-opacity-30 rounded-full text-xs py-1 px-2 ml-auto"},Fl={key:1,class:"cursor-not-allowed ml-2 mr-1 w-6 h-6",src:Rt},ct="audio/webm",Sl=180,Bl=L({__name:"AudioInput",setup(s){const{t:e}=we(),o=W(),t=S(3),a=S(),n=S(),r=S(0),l=S(0),d=S(),g=S(),p=$t([]),m=S(""),h=A(()=>r.value>1),C=async()=>{var M,E;try{switch(t.value){case 3:{t.value=0,p.splice(0),r.value=0,l.value=0,a.value=await navigator.mediaDevices.getUserMedia({video:!1,audio:!0}),n.value=new ts.RecordRTCPromisesHandler(a.value,{type:"audio",mimeType:ct});let U=new AudioContext,R=U.createAnalyser();R.fftSize=64,R.smoothingTimeConstant=0,U.createMediaStreamSource(a.value).connect(R),g.value=window.setInterval(()=>{let O=new Uint8Array(R.frequencyBinCount);R.getByteFrequencyData(O);let k=O.reduce((z,_)=>z+_)/O.length;const V=Math.min(1,k/128);p.unshift(V)},100),await n.value.startRecording(),l.value=Date.now(),d.value=window.setInterval(()=>{r.value=(Date.now()-l.value)/1e3,r.value>=Sl&&C()},1e3),t.value=1;break}case 1:t.value=2,await((M=n.value)==null?void 0:M.stopRecording()),(E=a.value)==null||E.getTracks().forEach(U=>U.stop()),clearInterval(d.value),clearInterval(g.value),t.value=3;break;default:break}}catch(U){console.error(U),m.value=e("noAccessMicrophonePermission")}},y=async()=>{var E;t.value!==3&&await C(),p.splice(0),r.value=0,l.value=0;let M=await((E=n.value)==null?void 0:E.getBlob());if(M){const U=await ss(M),R=new File([M],`${Ge()}.webm`),T={roomId:o.state.imkit.selectedRoomId,messageType:"audio",file:R,duration:U,originalUrl:"",extra:{mimeType:ct,fileName:R.name.split(".").slice(0,-1).join("."),bytes:R.size,fileExtension:R.name.split(".").pop()}};await o.dispatch("imkit/sendMessage",T)}};return es(()=>{clearInterval(d.value),clearInterval(g.value)}),(M,E)=>(i(),u("div",bl,[c("div",xl,[c("div",{class:"w-8 h-8 border border-2px border-gray-300 rounded-full flex items-center justify-center flex-shrink-0",onClick:C},[c("div",{class:K(["bg-red-500 rounded-full w-6 h-6 transition-all ease-in duration-200",{"w-3.5 h-3.5 rounded":t.value==1,"bg-red-300 cursor-not-allowed":m.value}])},null,2)]),j(Oe,null,{default:te(()=>[m.value?(i(),u("div",Cl,[Il,ae(" "+f(m.value),1)])):w("",!0)]),_:1}),c("div",Rl,[(i(!0),u(N,null,Z(p,(U,R)=>(i(),u("div",{key:R,class:"w-0.5 bg-gray-400 rounded flex-shrink-0 !min-h-0.5",style:J({height:`${U*28}px`})},null,4))),128))]),c("div",El,f(Math.floor(r.value/60))+":"+f(`${Math.floor(r.value%60)}`.padStart(2,"0")),1)]),h.value?(i(),u("img",{key:0,class:"cursor-pointer ml-2 mr-1 w-6 h-6",src:It,onClick:y})):(i(),u("img",Fl))]))}});const Ml=ce(Bl,[["__scopeId","data-v-2d2cfa64"]]),st=()=>{const s=window.location.href,e=s.substring(s.indexOf("?"));return new URLSearchParams(e.lastIndexOf("#/")==-1?e:e.substring(0,e.lastIndexOf("#/")))},Se=s=>(fe("data-v-f8c3debc"),s=s(),ve(),s),Ul=["onDrop"],Tl={class:"flex items-center p-3 gap-3 border-b border-solid"},Ol={key:2,class:"h-40px w-40px relative"},Ll={class:"text-base text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap"},_l={key:0,slot:"header",class:"w-full h-12 flex items-center justify-center"},Ql=Se(()=>c("svg",{class:"w-6 h-6 text-gray-200 animate-spin fill-blue-400",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),c("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})],-1)),Vl=[Ql],Kl={key:0,class:"text-sm text-gray-900 px-2"},Nl={class:"flex items-end justify-center p-2 relative gap-3 pl-3"},Pl={key:2,class:"absolute left-2 bottom-64px p-1.5 bg-white z-10 rounded-lg shadow-md flex items-stretch gap-1 text-gray-900"},Gl=Se(()=>c("img",{class:"w-6 h-6",src:Ya},null,-1)),Yl={class:"text-xs"},jl=Se(()=>c("img",{class:"w-6 h-6",src:ja},null,-1)),Dl={class:"text-xs whitespace-nowrap"},Xl={key:4,class:"bg-gray-100 p-3 rounded-lg flex flex-grow flex-col items-stretch relative"},Wl={class:"flex items-center bg-gray-100 gap-3"},zl={class:"flex flex-col flex-grow justify-center items-stretch gap-3 w-0 min-w-0"},Jl=["placeholder","onKeydown"],Hl={key:0,class:"flex gap-3"},Zl=["src"],ql=["onClick"],$l=Se(()=>c("img",{src:Xa,width:"24",height:"24"},null,-1)),ei=[$l],ti=Se(()=>c("img",{src:Wa,width:"24",height:"24"},null,-1)),si=[ti],oi=Se(()=>c("img",{src:za,width:"24",height:"24"},null,-1)),ai={key:1,class:"cursor-not-allowed my-auto ml-0.5 mr-1 w-6 h-6",src:Rt},ni=L({__name:"ChatRoom",setup(s){const e=W(),{open:o}=Ae({component:kl}),t=A(()=>e.state.imkit.rooms[e.state.imkit.selectedRoomId]),a=A(()=>e.state.imkit.selectedRoomId),n=A(()=>!!e.state.imkit.isRequesting[`/rooms/${e.state.imkit.selectedRoomId}/messages/v3`]),r=A(()=>e.state.imkit.sortedMessages),l=A(()=>st().has("roomId")),d=A(()=>r.value.at(-1)),g=A(()=>e.state.imkit.isRoomInfoVisible),p=A(()=>e.state.imkit.navigationTargetId),m=S(null),h=S(""),C=S(!1),y=S(!1),M=S(!1),E=S(!1),U=S(),R=S([]),T=S([]),O=S(!1),k=S(!1),V=S(),z=S(se().subtract(5,"second")),_=S(!1),P=A(()=>e.state.imkit.replyId),G=A(()=>e.state.imkit.config.settings),q=A(()=>{const B=Object.keys(e.state.imkit.isTyping);return B.length>0?B.map(Q=>{var Y;return((Y=e.state.imkit.users[Q])==null?void 0:Y.nickname)??""}).join(", "):""}),ne=async()=>{const B=async()=>{if(h.value){const{replyId:Y}=e.state.imkit,X={roomId:t.value.id,messageType:"text",message:h.value.trim(),reply:Y||null};h.value="",await e.dispatch("imkit/sendMessage",X),e.commit("imkit/setState",{replyId:null})}},Q=async()=>{if(R.value.length>0){const Y={roomId:t.value.id,messageType:"image",images:R.value,files:T.value};R.value=[],T.value=[],await e.dispatch("imkit/sendMessage",Y)}};await Promise.all([Q(),B()])},Ve=async()=>{var Q;const B=await e.dispatch("imkit/fetchMessages",t.value.id);B&&B.length>0&&((Q=m.value)==null||Q.scrollToIndex(B.length))},Ke=()=>{k.value=!1},Ne=B=>{h.value+=B.i,M.value=!1},Ut=()=>{var B;(B=U.value)==null||B.click()},Tt=async B=>{var Be;const Y=Array.from(((Be=B==null?void 0:B.target)==null?void 0:Be.files)||[]).filter($=>$.size<2e7);if(Y.length===0||Y.length>10)return;const X=Y.filter($=>$.type.startsWith("image")),ie=Y.filter($=>$.type.startsWith("video")),xe=Y.filter($=>!$.type.startsWith("image")&&!$.type.startsWith("video"));if(X.length>0){const $=await Promise.all(X.map(ze)),Ce={roomId:t.value.id,messageType:"image",images:$,files:Array.from(Y)};await e.dispatch("imkit/sendMessage",Ce)}if(ie.length>0)for(const $ of ie){const Ce=await qr($),{width:Nt,height:Pt,duration:Gt}=Ce,Yt={roomId:t.value.id,messageType:"video",video:Ce,file:$,width:Nt,height:Pt,duration:Gt};await e.dispatch("imkit/sendMessage",Yt)}if(xe.length>0)for(const $ of xe){const Ce={roomId:t.value.id,messageType:"file",file:$,originalUrl:"",extra:{mimeType:$.type,fileName:$.name.split(".").slice(0,-1).join("."),bytes:$.size,fileExtension:$.name.split(".").pop()}};await e.dispatch("imkit/sendMessage",Ce)}U.value&&(U.value.value="")},Ot=async B=>{const Q=((B==null?void 0:B.dataTransfer)||{}).files||[];if(Q.length===0||Q.length>10)return;const Y=await Promise.all(Array.from(Q).map(ze)),X={roomId:t.value.id,messageType:"image",images:Y,files:Array.from(Q)};await e.dispatch("imkit/sendMessage",X)},ot=B=>{B.preventDefault()},Lt=async B=>{const Y=(B.clipboardData||{}).files;Y.length===0||Y.length>10||(B.preventDefault(),R.value=R.value.concat(await Promise.all(Array.from(Y).map(ze))),T.value=T.value.concat(Array.from(Y)))},_t=()=>{e.commit("imkit/setState",{selectedRoomId:""})},Qt=B=>{R.value.splice(B,1),T.value.splice(B,1)};de(a,async(B,Q)=>{B!==Q&&(O.value=!1,e.commit("imkit/clearChatRoom"),Promise.all([e.dispatch("imkit/fetchMessages",B),e.dispatch("imkit/fetchRoom",B)]).finally(()=>{var Y,X;(((Y=t.value)==null?void 0:Y.numberOfUnread)??0)>0&&(e.dispatch("imkit/updateLastRead",B),e.dispatch("imkit/insertUnreadMessage"));for(const ie of e.state.imkit.deliveringMessages.values())ie.roomId===B&&e.commit("imkit/pushMessage",ie);(X=m.value)==null||X.scrollToBottom(),O.value=!0}))},{immediate:!0}),de([()=>r.value.length,()=>d.value],([B],[Q])=>{var Y,X,ie,xe,Be;B-Q>1||(((Y=m.value)==null?void 0:Y.getOffset())+((X=m.value)==null?void 0:X.getClientSize())==((ie=m.value)==null?void 0:ie.getScrollSize())||((xe=r.value[r.value.length-1])==null?void 0:xe.senderId)===e.state.imkit.uid?(k.value=!1,(Be=m.value)==null||Be.scrollToBottom()):k.value=!0)}),de(p,B=>{var Y;if(!B)return;const Q=r.value.findIndex(X=>X.id===B);Q!==-1&&((Y=m.value)==null||Y.scrollToIndex(Q)),e.commit("imkit/setState",{navigationTargetId:""})}),de(P,()=>{P.value&&(E.value=!1,setTimeout(()=>{var B;(B=V.value)==null||B.focus()},0))}),de(h,()=>{if(z.value.add(5,"second")>se())return;z.value=se();const{socket:B,selectedRoomId:Q}=e.state.imkit;B.emit("typing",Q)});const Vt=()=>{setTimeout(()=>{C.value=!1},0)},Kt=B=>{!C.value&&B.keyCode==13&&!B.shiftKey&&!G.value.sendButtonEnabled&&(B.preventDefault(),ne())};return de(q,()=>{var B,Q,Y,X;q.value&&((B=m.value)==null?void 0:B.getOffset())+((Q=m.value)==null?void 0:Q.getClientSize())+100>=((Y=m.value)==null?void 0:Y.getScrollSize())&&((X=m.value)==null||X.scrollToBottom())}),(B,Q)=>{var Y;return t.value?(i(),u("div",{key:0,class:"flex flex-col h-full bg-white",onDrop:re(Ot,["prevent"]),onDragenter:ot,onDragover:ot},[c("div",Tl,[l.value?w("",!0):(i(),u("img",{key:0,src:Ct,class:"cursor-pointer sm:hidden",width:"36",height:"36",onClick:_t})),t.value.avatars.length===1?(i(),D(oe,{key:1,url:t.value.avatars[0].url,name:t.value.avatars[0].name,class:"h-40px w-40px text-lg"},null,8,["url","name"])):(i(),u("div",Ol,[j(oe,{url:t.value.avatars[1].url,name:t.value.avatars[1].name,class:"h-28px w-28px text-sm rounded-xl absolute top-0 right-0"},null,8,["url","name"]),j(oe,{url:t.value.avatars[0].url,name:t.value.avatars[0].name,class:"h-30px w-30px text-sm rounded-xl absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100"},null,8,["url","name"])])),c("div",Ll,f(t.value.displayName),1),G.value.roomInfoButtonEnabled?(i(),u("img",{key:3,src:Pa,class:"cursor-pointer ml-auto",width:"30",height:"30",onClick:Q[0]||(Q[0]=X=>v(e).commit("imkit/setState",{isRoomInfoVisible:!g.value}))})):w("",!0)]),j(v(Ye),{class:K(["p-2 h-100vh overflow-auto",{"opacity-0":!O.value&&!n.value}]),ref_key:"vl",ref:m,"data-key":"id","data-sources":r.value,"data-component":Dr,"wrap-class":"flex flex-col","estimated-size":66,keeps:50,onTotop:Ve,onTobottom:Ke},{header:te(()=>[n.value?(i(),u("div",_l,Vl)):w("",!0)]),footer:te(()=>[q.value?(i(),u("div",Kl,f(q.value)+f(B.$t("isTyping")),1)):w("",!0)]),_:1},8,["class","data-sources"]),c("div",Nl,[k.value?(i(),u("div",{key:0,class:"absolute -top-10 h-10 bg-gray-200 bg-opacity-90 w-full flex items-center px-3 cursor-pointer",onClick:Q[1]||(Q[1]=(...X)=>m.value.scrollToBottom&&m.value.scrollToBottom(...X))},f((Y=t.value.lastMessage)==null?void 0:Y.string),1)):w("",!0),G.value.locationInputEnabled||G.value.audioInputEnabled?(i(),u("img",{key:1,src:Ga,class:K(["w-5 h-12 cursor-pointer object-contain transform transition flex-shrink-0",{"rotate-45":E.value}]),onClick:Q[2]||(Q[2]=()=>{E.value?E.value=!1:_.value=!0})},null,2)):w("",!0),_.value?ee((i(),u("div",Pl,[G.value.locationInputEnabled?(i(),u("div",{key:0,class:"flex flex-col items-center justify-center gap-1 p-2 min-w-16 cursor-pointer",onClick:Q[3]||(Q[3]=(...X)=>v(o)&&v(o)(...X))},[Gl,c("div",Yl,f(B.$t("location")),1)])):w("",!0),G.value.audioInputEnabled?(i(),u("div",{key:1,class:"flex flex-col items-center justify-center gap-1 p-2 min-w-16 cursor-pointer",onClick:Q[4]||(Q[4]=()=>{_.value=!1,E.value=!0})},[jl,c("div",Dl,f(B.$t("audio")),1)])):w("",!0)])),[[v(Ue),()=>{_.value=!1}]]):w("",!0),G.value.audioInputEnabled&&E.value?(i(),D(Ml,{key:3})):(i(),u("div",Xl,[j(rl),c("div",Wl,[c("div",zl,[ee(c("textarea",{ref_key:"input",ref:V,type:"text",class:K(["bg-gray-100 outline-none h-6 resize-none flex-grow",{"!h-12":h.value.split(`
`).length===2,"!h-18":h.value.split(`
`).length>2}]),placeholder:B.$t("TypeMessage"),"onUpdate:modelValue":Q[5]||(Q[5]=X=>h.value=X),onCompositionstart:Q[6]||(Q[6]=X=>C.value=!0),onCompositionend:Vt,onKeydown:os(Kt,["enter"]),onPaste:Lt},null,42,Jl),[[ke,h.value]]),R.value.length>0?(i(),u("div",Hl,[(i(!0),u(N,null,Z(R.value,(X,ie)=>(i(),u("div",{key:`${X.id}-${ie}`,class:"relative w-12 h-12 group"},[c("img",{src:X.thumbnailUrl,class:"w-full h-full absolute left-0 bottom-0 rounded-lg object-cover bg-gray-200"},null,8,Zl),c("img",{src:Da,class:"w-5 h-5 absolute -right-2 -top-2 cursor-pointer hidden group-hover:block",onClick:xe=>Qt(ie)},null,8,ql)]))),128))])):w("",!0)]),G.value.stickerInputEnabled?(i(),u("button",{key:0,class:"flex-shrink-0",onClick:Q[7]||(Q[7]=X=>y.value=!0)},ei)):w("",!0),G.value.emojiInputEnabled?(i(),u("button",{key:1,class:"flex-shrink-0",onClick:Q[8]||(Q[8]=X=>M.value=!0)},si)):w("",!0),G.value.fileInputEnabled?(i(),u("button",{key:2,class:"flex-shrink-0",onClick:Ut},[oi,c("input",{ref_key:"fileInput",ref:U,type:"file",multiple:"true",onChange:Tt,class:"hidden"},null,544)])):w("",!0)]),G.value.stickerInputEnabled&&y.value?ee((i(),D(Zr,{key:0,onClose:Q[9]||(Q[9]=()=>{y.value=!1})},null,512)),[[v(Ue),()=>{y.value=!1}]]):w("",!0)])),G.value.emojiInputEnabled&&M.value?ee((i(),D(v(as),{key:5,class:"overflow-auto absolute right-2.5 bottom-16",native:!0,onSelect:Ne},null,512)),[[v(Ue),()=>{M.value=!1}]]):w("",!0),G.value.sendButtonEnabled&&!E.value?(i(),u(N,{key:6},[h.value.length>0?(i(),u("img",{key:0,class:"cursor-pointer my-auto ml-0.5 mr-1 w-6 h-6",src:It,onClick:ne})):(i(),u("img",ai))],64)):w("",!0)])],40,Ul)):w("",!0)}}});const dt=ce(ni,[["__scopeId","data-v-f8c3debc"]]),ri={count:0,config:{},uid:"",axios:Le,isRequesting:{},socket:ht({autoConnect:!1}),imageCache:at(),translationCache:at(),users:{},rooms:{},sortedRooms:[],numberOfFetchedRooms:0,numberOfTotalRooms:0,uploadProgresses:{},downloadProgresses:{},linkPreviews:{},actionMenuRoomId:"",folders:{},sortedFolderIds:[],roomIdsInFolders:{},selectedRoomIdsForCreateFolder:{},selectedFolderId:"",searchKeyword:"",searchType:le.RoomName,searchRooms:{},roomTag:"",deliveringMessages:new Map,selectedRoomId:"",messages:{},sortedMessages:[],numberOfTotalMessages:-1,messageGroupHead:{},messageGroupTail:{},replyId:"",navigationTargetId:"",isRoomInfoVisible:!1,isTyping:{}};var b=(s=>(s.increment="increment",s.fetchRooms="fetchRooms",s.fetchRoom="fetchRoom",s.fetchMessages="fetchMessages",s.updateLastRead="updateLastRead",s.handleMessageFromSocket="handleMessageFromSocket",s.handleRoomFromSocket="handleRoomFromSocket",s.handleLastReadFromSocket="handleLastReadFromSocket",s.sendMessage="sendMessage",s.recallMessage="recallMessage",s.uploadMedia="uploadMedia",s.fetchLinkPreview="fetchLinkPreview",s.handleLinkPreviews="handleLinkPreviews",s.fetchVideoBlob="fetchVideoBlob",s.navigateToMessage="navigateToMessage",s.uploadImage="uploadImage",s.updateRoomPrefs="updateRoomPrefs",s.fetchPrefs="fetchPrefs",s.updatePref="updatePref",s.deletePref="deletePref",s.updateFolder="updateFolder",s.removeFolder="removeFolder",s.handlePrefChangeFromSocket="handlePrefChangeFromSocket",s.handlePrefDeleteFromSocket="handlePrefDeleteFromSocket",s.aggregateRoomsAndFolders="aggregateRoomsAndFolders",s.removeMembers="removeMembers",s.handleTypingFromSocket="handleTypingFromSocket",s.insertUnreadMessage="insertUnreadMessage",s.translate="translate",s.searchRooms="searchRooms",s.subscribe="subscribe",s.unsubscribe="unsubscribe",s.removeRoomFromFolder="removeRoomFromFolder",s.addRoomToFolder="addRoomToFolder",s.fetchRoomsInFolders="fetchRoomsInFolders",s.batchSendMessage="batchSendMessage",s))(b||{}),x=(s=>(s.increment="increment",s.setState="setState",s.updateField="updateField",s.deleteField="deleteField",s.updateRoom="updateRoom",s.updateLastRead="updateLastRead",s.concatMessages="concatMessages",s.pushMessage="pushMessage",s.replaceMessage="replaceMessage",s.clearChatRoom="clearChatRoom",s.deleteRoom="deleteRoom",s.recallMessage="recallMessage",s.insertUnreadMessage="insertUnreadMessage",s.setMap="setMap",s.deleteMap="deleteMap",s))(x||{});class Ie{constructor(e,o,t){I(this,"id");I(this,"name");I(this,"roomIds");this.id=e,this.name=o,this.roomIds=t}get payload(){return{children:this.roomIds.map(e=>({id:e,type:"room"}))}}}const li={[b.increment]({commit:s}){s(x.increment)},async[b.fetchRooms]({state:s,commit:e,dispatch:o},{pageSize:t}={pageSize:void 0}){if(s.isRequesting[ue.FetchRooms])return;const{numberOfFetchedRooms:a,uid:n}=s;if(a===s.numberOfTotalRooms&&a>0)return;const r=t!==void 0?t:Math.min(Math.max(30,a),120),{data:{result:l}}=await s.axios.get(ue.FetchRooms,{params:{skip:a,limit:r,q:s.roomTag?`{ "members": "${n}", "roomTags": "${s.roomTag}" }`:`{ "members": "${n}" }`}}),{data:d,totalCount:g}=l,p={},m={};for(const h of d){p[h._id]=new Te(h);for(const C of h.members)m[C.id]||(m[C.id]=new pe(C))}e(x.updateField,{key:"rooms",value:p}),e(x.updateField,{key:"users",value:m}),e(x.setState,{numberOfTotalRooms:g,numberOfFetchedRooms:a+r}),o(b.aggregateRoomsAndFolders)},async[b.handleMessageFromSocket]({state:s,commit:e,dispatch:o},t){let a=s.rooms[t.roomId];if(a){const{id:n,numberOfUnread:r}=a;if(t.roomId===s.selectedRoomId){if(await o(b.handleLinkPreviews,[t]),s.config.translationApiKey&&t.type===F.Text&&t.senderId!==s.uid){const l=t.text;try{const d=await o(b.translate,l);t.translatedText=d!==l?d:null}catch(d){console.error(d)}}e(x.pushMessage,t),e(x.updateRoom,{id:n,updatedAt:t.createdAt,lastMessage:t,numberOfUnread:0}),o(b.updateLastRead,n),e(x.setState,{numberOfTotalMessages:s.numberOfTotalMessages+1})}else e(x.updateRoom,{id:n,updatedAt:t.createdAt,lastMessage:t,numberOfUnread:t.senderId!==s.uid?r+1:r});o(b.aggregateRoomsAndFolders)}else await o(b.fetchRoom,t.roomId),a=s.rooms[t.roomId]},async[b.fetchMessages]({state:s,commit:e,dispatch:o},t){var M;const a=`/rooms/${t}/messages/v3`;if(s.isRequesting[a]||s.sortedMessages.length>=s.numberOfTotalMessages&&s.numberOfTotalMessages!==-1)return;const{data:{result:n}}=await s.axios.get(a,{params:{limit:30,beforeMessage:(M=s.sortedMessages[0])==null?void 0:M.id}}),{data:r,totalCount:l}=n,d={},g=E=>{const U=H.fromRaw(E);return U?[U].concat(g(E.reply)):[]};if(r.flatMap(E=>g(E)).forEach(E=>{d[E.id]=E}),await o(b.handleLinkPreviews,Object.values(d)),s.config.translationApiKey){const E=Object.values(d).filter(R=>R.type===F.Text&&R.senderId!==s.uid),U=await Promise.allSettled(E.map(R=>o(b.translate,R.text)));for(let R=0;R<E.length;R++){const T=U[R];T.status==="fulfilled"&&T.value!==E[R].text&&(E[R].translatedText=_e.linkfy(T.value))}}const p={};for(const E of r)p[E.sender.id]||(p[E.sender.id]=new pe(E.sender));e(x.updateField,{key:"users",value:p}),e(x.concatMessages,{messages:d,messageIds:r.map(E=>E._id)}),l>s.numberOfTotalMessages&&e(x.setState,{numberOfTotalMessages:l});let m=[];const h={},C={};let y=null;for(const E of s.sortedMessages)E.groupId!==y&&(m.length>0&&(h[m[0].id]=!0,C[m[m.length-1].id]=!0),m=[],y=E.groupId),m.push(E);return m.length>0&&(h[m[0].id]=!0,C[m[m.length-1].id]=!0),e(x.setState,{messageGroupHead:h,messageGroupTail:C}),r},async[b.fetchRoom]({state:s,commit:e},o){const{data:{result:t}}=await s.axios.get(`/rooms/${o}`),a=new Te(t),n={};n[a.id]=a,e(x.updateField,{key:"rooms",value:n});const r={};t.members.flatMap(l=>Array.isArray(l.members)?[...l.members,l]:[l]).forEach(l=>{r[l.id]||(r[l.id]=new pe(l))}),e(x.updateField,{key:"users",value:r})},async[b.updateLastRead]({state:s,commit:e},o){var r;const t=`/rooms/${o}/lastRead`;if(s.isRequesting[t])return;const a=s.rooms[o],{data:{result:n}}=await s.axios.put(t,{message:(r=a.lastMessage)==null?void 0:r.id});n&&e(x.updateRoom,{id:o,numberOfUnread:0})},async[b.handleRoomFromSocket]({commit:s,dispatch:e},o){const t={};t[o.id]=o,await s(x.updateField,{key:"rooms",value:t}),e(b.aggregateRoomsAndFolders)},async[b.handleLastReadFromSocket]({commit:s},e){s(x.updateLastRead,e)},async[b.sendMessage]({state:s,commit:e,dispatch:o},t){const{roomId:a}=t;if(!a)return;const n=H.fromPayload(t,s.uid);if(!n)return;if(e(x.setMap,{mapName:"deliveringMessages",key:n.id,value:n}),e(x.pushMessage,n),t.messageType===F.Image){const{files:d}=t,g=await Promise.all(t.images.map((m,h)=>o(b.uploadImage,{image:m,file:d[h]}))),p=[];t.images.forEach((m,h)=>{s.imageCache.set(g[h].thumbnailUrl,m.thumbnailUrl);const{id:C,width:y,height:M}=m;p.push({originalUrl:g[h].originalUrl,thumbnailUrl:g[h].thumbnailUrl,width:y,height:M}),e(x.deleteField,{key:"uploadProgresses",value:`${C}-original`}),e(x.deleteField,{key:"uploadProgresses",value:`${C}-thumbnail`})}),t.images=p,delete t.files}else if(t.messageType===F.Video){const{file:d,video:g}=t,p=g.thumbnailFile;if(!p)return;const m=await Promise.all([o(b.uploadMedia,{id:p.id,file:p.file}),o(b.uploadMedia,{id:g.id,file:d})]);t.width=g.width,t.height=g.height,t.duration=g.duration,t.thumbnailUrl=m[0],t.originalUrl=m[1],s.imageCache.set(m[0],g.thumbnailUrl),delete t.file,e(x.deleteField,{key:"uploadProgresses",value:g.id})}else if(t.messageType===F.File){const{file:d}=t,g=await o(b.uploadMedia,{id:n.id,file:d});t.originalUrl=g,delete t.file,e(x.deleteField,{key:"uploadProgresses",value:n.id})}else if(t.messageType===F.Audio){const{file:d}=t,g=await o(b.uploadMedia,{id:n.id,file:d});t.originalUrl=g,delete t.file,e(x.deleteField,{key:"uploadProgresses",value:n.id})}const{data:{result:r}}=await s.axios.post(`/rooms/${a}/message`,t),l=H.fromRaw(r);if(l)return e(x.deleteMap,{mapName:"deliveringMessages",key:n.id}),await o(b.handleLinkPreviews,[l]),l.roomId===s.selectedRoomId?e(x.replaceMessage,{message:l,targetMessageId:n.id}):e(x.updateRoom,{id:l.roomId,updatedAt:l.createdAt,lastMessage:l}),l},async[b.batchSendMessage]({state:s},e){await s.axios.post("/messages/batch",e)},async[b.recallMessage]({state:s,commit:e},o){const{roomId:t}=o;if(!t)return;const{data:{result:a}}=await s.axios.post(`/rooms/${t}/message`,o),n=H.fromRaw(a);n&&e(x.recallMessage,n)},async[b.uploadMedia]({state:s,commit:e},{id:o,file:t}){const a=new FormData;a.append("file",t);const{data:{result:{_id:n}}}=await s.axios.post("/files/chatserver-upload",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:r=>{const{total:l}=r;l&&e(x.updateField,{key:"uploadProgresses",value:{[o]:r.loaded/l}})}});return`${s.config.domain}/files/chatserver-upload/${n}`},async[b.uploadImage]({dispatch:s},{image:e,file:o}){if(o.size>1024*1024)try{const a=await ns(o,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}),n=await Promise.all([s(b.uploadMedia,{id:`${e.id}-original`,file:o}),s(b.uploadMedia,{id:`${e.id}-thumbnail`,file:a})]);return{originalUrl:n[0],thumbnailUrl:n[1]}}catch(a){console.error(a)}const t=await s(b.uploadMedia,{id:`${e.id}-original`,file:o});return{originalUrl:t,thumbnailUrl:t}},async[b.fetchLinkPreview](s,e){const{data:o}=await Le.get(encodeURI(`https://url.imkit.io/?url=${e}`));return o},async[b.handleLinkPreviews]({state:s,commit:e,dispatch:o},t){const a=Array.from(new Set(t.flatMap(l=>(l==null?void 0:l.urls)||[]).filter(l=>!s.linkPreviews[l])));if(a.length===0)return;const n={};(await Promise.allSettled(a.map(l=>o(b.fetchLinkPreview,l)))).forEach((l,d)=>{l.status==="fulfilled"&&(n[a[d]]=l.value)}),e(x.updateField,{key:"linkPreviews",value:n})},async[b.fetchVideoBlob]({state:s},e){const{data:o}=await s.axios.get(e,{responseType:"blob"});return o},async[b.navigateToMessage]({state:s,commit:e,dispatch:o},t){let a=!1;for(;!a;)if(a=s.messages[t]!==void 0&&s.sortedMessages.findIndex(n=>n.id===t)>-1,a)e(x.setState,{navigationTargetId:t});else if(s.sortedMessages.length<s.numberOfTotalMessages||s.numberOfTotalMessages===-1)await o(b.fetchMessages,s.selectedRoomId);else break},async[b.updateRoomPrefs]({state:s,commit:e,dispatch:o},{roomId:t,prefs:a}){await s.axios.post(`/roomPrefs/${t}`,a);const n=s.rooms[t];n&&(e(x.updateRoom,{id:t,pref:{...n.pref,...a}}),o(b.aggregateRoomsAndFolders))},async[b.fetchPrefs]({state:s,commit:e}){const{data:{result:o}}=await s.axios.get("/me/pref"),t={},a=[],n={},r={},l={};for(const d of o)if(d.key==="folders-meta")for(const g of d.data)n[g.key]=g.name,a.push(g.key);else{if(d.key==="blackList")continue;r[d.key]=d.data.children.map(g=>g.id)}for(const d of a){t[d]=new Ie(d,n[d],r[d]||[]);for(const g of r[d]||[])l[g]=!0}e(x.setState,{folders:t,sortedFolderIds:a,roomIdsInFolders:l})},async[b.fetchRoomsInFolders]({state:s,dispatch:e}){const o=Object.keys(s.roomIdsInFolders).length;for(;s.numberOfFetchedRooms<o;)await e(b.fetchRooms,{pageSize:200});const t=rs(6),a=Object.keys(s.roomIdsInFolders).filter(n=>!s.rooms[n]).map(n=>t(()=>e(b.fetchRoom,n)));await Promise.allSettled(a)},async[b.updatePref]({state:s},{key:e,value:o}){return await s.axios.post(`/me/pref/${e}`,o)},async[b.deletePref]({state:s},e){return await s.axios.delete(`/me/pref/${e}`)},async[b.updateFolder]({state:s,dispatch:e,commit:o},{folderKey:t,name:a}){const n=Object.keys(s.selectedRoomIdsForCreateFolder).filter(l=>s.selectedRoomIdsForCreateFolder[l]);await e(b.updatePref,{key:"folders-meta",value:s.sortedFolderIds.map(l=>s.folders[l]).filter(l=>!!l&&l.id!==t).map(l=>({key:l.id,name:l.name})).concat([{key:t,name:a}]).sort((l,d)=>l.key.localeCompare(d.key))}),await e(b.updatePref,{key:t,value:{children:n.map(l=>({id:l,type:"room"}))}}),s.folders[t]&&o(x.updateField,{key:"roomIdsInFolders",value:s.folders[t].roomIds.reduce((l,d)=>(l[d]=!1,l),{})});const r=new Ie(t,a,n);o(x.updateField,{key:"folders",value:{[t]:r}}),o(x.updateField,{key:"roomIdsInFolders",value:n.reduce((l,d)=>(l[d]=!0,l),{})}),o(x.setState,{sortedFolderIds:[...new Set([...s.sortedFolderIds,t])],selectedRoomIdsForCreateFolder:{}}),e(b.aggregateRoomsAndFolders)},async[b.removeFolder]({state:s,dispatch:e},o){await e(b.deletePref,o),await e(b.updatePref,{key:"folders-meta",value:s.sortedFolderIds.map(t=>s.folders[t]).filter(t=>!!t&&t.id!==o).map(t=>({key:t.id,name:t.name}))}),e(b.handlePrefDeleteFromSocket)},async[b.handlePrefChangeFromSocket]({state:s,commit:e,dispatch:o},t){const{key:a,data:n}=t;if(a==="folders-meta"){const r={},l=[];for(const{key:d,name:g}of n){const p=s.folders[d]||new Ie(d,g,[]);r[d]=p,l.push(d)}e(x.setState,{folders:r,sortedFolderIds:l})}else{const{id:r,name:l}=s.folders[a];if(r){const d=n.children.map(p=>p.id),g=new Ie(r,l,d);e(x.updateField,{key:"folders",value:{[a]:g}}),e(x.updateField,{key:"roomIdsInFolders",value:d.reduce((p,m)=>(p[m]=!0,p),{})})}}o(b.aggregateRoomsAndFolders)},async[b.handlePrefDeleteFromSocket]({state:s,commit:e,dispatch:o},t){const a=s.folders[t];if(!a)return;const n={};for(const r of a.roomIds)n[r]=!1;e(x.deleteField,{key:"folders",value:t}),e(x.updateField,{key:"roomIdsInFolders",value:n}),e(x.setState,{sortedFolderIds:s.sortedFolderIds.filter(r=>r!==t)}),o(b.aggregateRoomsAndFolders)},async[b.aggregateRoomsAndFolders]({state:s,commit:e}){const o=Object.values(s.rooms).filter(t=>!s.roomIdsInFolders[t.id]).sort((t,a)=>{var n,r,l;return((n=t.pref)==null?void 0:n.sticky)===((r=a.pref)==null?void 0:r.sticky)?a.updatedAt-t.updatedAt:(l=t.pref)!=null&&l.sticky?-1:1});e(x.setState,{sortedRooms:o})},async[b.removeMembers]({state:s,commit:e},{roomId:o,uids:t}){var n;if(s.rooms[o]&&(await s.axios.post(`/rooms/${o}/delete/members`,{systemMessage:!0,members:t}),t.includes(s.uid))){e(x.deleteRoom,o);const r=(n=s.sortedRooms.find(l=>l.numberOfUnread===0))==null?void 0:n.id;r&&e(x.setState,{selectedRoomId:r})}},async[b.handleTypingFromSocket]({state:s,commit:e},o){const{room:t,sender:a}=o;if(t!==s.selectedRoomId||a===s.uid)return;const n=s.isTyping[a];n!==void 0&&clearTimeout(n);const r=setTimeout(()=>{e(x.deleteField,{key:"isTyping",value:a})},6e3);e(x.updateField,{key:"isTyping",value:{[a]:r}})},async[b.insertUnreadMessage]({state:s,commit:e}){const o=s.rooms[s.selectedRoomId];if(!o)return;const t=o.lastReadMessageId[s.uid];if(!t)return;const a=s.messages[t];if(!a)return;const n=H.fromPayload({messageType:F.Announcement,message:"以下為尚未閱讀的訊息",createdAtMS:a.createdAt+1},s.uid);n&&e(x.insertUnreadMessage,{lastReadMessageId:t,message:n})},async[b.translate]({state:s},e){if(s.translationCache.has(e))return s.translationCache.get(e)||e;let o=navigator.language.split("-")[0];const t={am:"am",ar:"ar",eu:"eu",bn:"bn","en-gb":"en-GB","pt-br":"pt-BR",bg:"bg",ca:"ca",chr:"chr",hr:"hr",cs:"cs",da:"da",nl:"nl",en:"en",et:"et",fil:"fil",fi:"fi",fr:"fr",de:"de",el:"el",gu:"gu",iw:"iw",hi:"hi",hu:"hu",is:"is",id:"id",it:"it",ja:"ja",kn:"kn",ko:"ko",lv:"lv",lt:"lt",ms:"ms",ml:"ml",mr:"mr",no:"no",pl:"pl","pt-pt":"pt-PT",ro:"ro",ru:"ru",sr:"sr","zh-cn":"zh-CN",sk:"sk",sl:"sl",es:"es",sw:"sw",sv:"sv",ta:"ta",te:"te",th:"th","zh-tw":"zh-TW",tr:"tr",ur:"ur",uk:"uk",vi:"vi",cy:"cy"};t[navigator.language.toLowerCase()]&&(o=t[navigator.language.toLowerCase()]);const a=await fetch("https://translation.googleapis.com/language/translate/v2",{method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:new URLSearchParams({q:e,key:s.config.translationApiKey,target:o}),redirect:"follow"}).then(n=>n.json()).then(n=>{var r;return(r=n.data)==null?void 0:r.translations[0].translatedText});return s.translationCache.set(e,a),a},async[b.searchRooms]({state:s,commit:e},o){if(s.isRequesting[ue.SearchRooms])return;const t=Object.values(le),{data:{result:a}}=await s.axios.post(ue.SearchRooms,{type:t,keyword:o}),n={},r={},l={};for(const p of t)a[p].forEach(m=>{n[m._id]=new Te(m),l[p]||(l[p]=[]),l[p].push(n[m._id]);for(const h of m.members)r[h.id]||(r[h.id]=new pe(h))});for(const p of Object.values(s.folders))p.name.includes(o)&&(l[le.RoomPrefFolder]||(l[le.RoomPrefFolder]=[]),l[le.RoomPrefFolder].push(p));const d=Object.keys(l),g=d.length>0?d[0]:le.RoomName;e(x.updateField,{key:"rooms",value:n}),e(x.updateField,{key:"users",value:r}),e(x.setState,{searchRooms:l,searchType:g,searchKeyword:o})},async[b.subscribe]({state:s}){if(!s.config.firebaseConfig||!s.config.firebaseVapidKey||await Notification.requestPermission()!=="granted")return;const o=ls(s.config.firebaseConfig),t=is(o),a=await cs(t,{vapidKey:s.config.firebaseVapidKey});if(!a)return;let n=localStorage.getItem("imkit-deviceId");n||(n=Ge(),localStorage.setItem("imkit-deviceId",n)),await s.axios.post(ue.Subscribe,{type:"fcm",token:a,deviceId:n})},async[b.unsubscribe]({state:s}){let e=localStorage.getItem("imkit-deviceId");e||(e=Ge(),localStorage.setItem("imkit-deviceId",e)),await s.axios.post(ue.Unsubscribe,{type:"fcm",deviceId:e})},async[b.removeRoomFromFolder]({state:s,commit:e,dispatch:o},t){if(!s.roomIdsInFolders[t])return;const a=s.folders[s.selectedFolderId];if(!a)return;const n=a.id,r=a.roomIds.filter(d=>d!==t);await o(b.updatePref,{key:n,value:{children:r.map(d=>({id:d,type:"room"}))}});const l=new Ie(n,a.name,r);e(x.updateField,{key:"folders",value:{[n]:l}}),e(x.updateField,{key:"roomIdsInFolders",value:{[t]:!1}}),o(b.aggregateRoomsAndFolders)},async[b.addRoomToFolder]({state:s,commit:e,dispatch:o},{roomId:t,folderId:a}){const n=s.folders[a];if(!n)return;const r=Array.from(new Set([...n.roomIds,t]));await o(b.updatePref,{key:a,value:{children:r.map(d=>({id:d,type:"room"}))}});const l=new Ie(a,n.name,r);e(x.updateField,{key:"folders",value:{[a]:l}}),e(x.updateField,{key:"roomIdsInFolders",value:{[t]:!0}}),o(b.aggregateRoomsAndFolders)}},ii={doubleCount:s=>s.count*2},ci={[x.increment](s){s.count++},[x.setState](s,e){Object.assign(s,e)},[x.updateField](s,e){const{key:o,value:t}=e;Object.assign(s[o],t)},[x.deleteField](s,e){const{key:o,value:t}=e;delete s[o][t]},[x.updateRoom](s,e){const{id:o}=e,t=s.rooms[o];t&&Object.assign(t,e)},[x.updateLastRead](s,e){const{roomId:o,uid:t,messageId:a}=e,n=s.rooms[o];n&&(n.lastReadMessageId[t]=a)},[x.concatMessages](s,e){const{messages:o,messageIds:t}=e;Object.assign(s.messages,o),s.sortedMessages=s.sortedMessages.concat(t.map(a=>s.messages[a])).sort((a,n)=>a.createdAt-n.createdAt)},[x.pushMessage](s,e){if(e.roomId!==s.selectedRoomId||s.messages[e.id])return;const o=s.sortedMessages,t=o.length>0?o[o.length-1].groupId:null;e.groupId===t?(s.messageGroupTail[o[o.length-1].id]=!1,s.messageGroupTail[e.id]=!0):(s.messageGroupHead[e.id]=!0,s.messageGroupTail[e.id]=!0),s.messages[e.id]=e;for(let a=s.sortedMessages.length-1;a>=0;a--)if(e.createdAt>=s.sortedMessages[a].createdAt){s.sortedMessages.push(e);break}},[x.replaceMessage](s,e){const{targetMessageId:o,message:t}=e;if(t.roomId===s.selectedRoomId){for(let a=s.sortedMessages.length-1;a>=0;a--)if(s.sortedMessages[a].id===o){s.sortedMessages.splice(a,1);break}if(delete s.messages[o],!s.messages[t.id]){s.messages[t.id]=t;let a=0;for(let l=s.sortedMessages.length-1;l>=0;l--)if(t.createdAt>=s.sortedMessages[l].createdAt){a=l+1;break}s.sortedMessages.splice(a,0,t),a-1>=0&&s.sortedMessages[a-1].groupId===t.groupId?s.messageGroupTail[s.sortedMessages[a-1].id]=!1:s.messageGroupHead[t.id]=!0,a+1<s.sortedMessages.length&&s.sortedMessages[a+1].groupId===t.groupId?s.messageGroupHead[s.sortedMessages[a+1].id]=!1:s.messageGroupTail[t.id]=!0}}},[x.clearChatRoom](s){s.messages={},s.sortedMessages=[],s.numberOfTotalMessages=-1,s.messageGroupHead={},s.messageGroupTail={},s.replyId="",s.navigationTargetId="",s.isRoomInfoVisible=!1,s.isTyping={}},[x.deleteRoom](s,e){delete s.rooms[e],delete s.roomIdsInFolders[e],delete s.selectedRoomIdsForCreateFolder[e],s.sortedRooms=s.sortedRooms.filter(o=>o.id!==e)},[x.recallMessage](s,e){const o=s.sortedMessages;for(let t=s.sortedMessages.length-1;t>=0;t--)if(o[t].id===e.id){o.splice(t,1,e);break}s.messages[e.id]=e},[x.insertUnreadMessage](s,e){const{lastReadMessageId:o,message:t}=e,a=s.sortedMessages;for(let n=s.sortedMessages.length-1;n>=0;n--)if(a[n].id===o){a.splice(n+1,0,t);break}},[x.setMap](s,e){const{mapName:o,key:t,value:a}=e;s[o].set(t,a)},[x.deleteMap](s,e){const{mapName:o,key:t}=e;s[o].delete(t)}},Mt={state:ri,mutations:ci,getters:ii,actions:li,namespaced:!0};function Pe(s,e,o){const{url:t}=e,a=t==null?void 0:t.split("?")[0];if(!a)return;const n={};n[a]=s==0?new Date:null,o.commit("imkit/updateField",{key:"isRequesting",value:n})}const di=async s=>{localStorage.getItem("imkit-token")&&(localStorage.removeItem("imkit-token"),window.location.reload())};function ui(s,e){const{domain:o}=s,t=Le.create({baseURL:o});return t.interceptors.request.use(a=>{Pe(0,a,e);const n=new nt({"IM-Authorization":e.state.imkit.config.token,"IM-Client-Key":e.state.imkit.config.clientKey});return a.headers=n,a},a=>{const{config:n}=a;return Pe(1,n,e),Promise.reject(a)}),t.interceptors.response.use(a=>{const{config:n}=a;return Pe(1,n,e),a},async a=>{const{config:n}=a;if(Pe(1,n,e),a.response.status===401){await di();const r=new nt({"IM-Authorization":e.state.imkit.config.token,"IM-Client-Key":e.state.imkit.config.clientKey});return n.headers=r,Le.request(n)}return Promise.reject(a)}),t}function mi(s,e){const{domain:o,clientKey:t,token:a}=s,n=ht(o,{forceBase64:!0,transports:["websocket"]});return n.on("connect",()=>{n.emit("auth2",a,{CLIENT_KEY:t,Authorization:a},r=>{console.log(r)})}),n.on("disconnect",r=>{console.log(r)}),n.on("chat message",r=>{e.dispatch("imkit/handleMessageFromSocket",H.fromRaw(r))}),n.on("room",r=>{const l=new Te(r);if(!l.id)return;const d={};for(const g of r.members)d[g.id]||(d[g.id]=new pe(g));e.dispatch("imkit/handleRoomFromSocket",l),e.commit("imkit/updateField",{key:"users",value:d})}),n.on("lastRead",r=>{const{roomID:l,memberID:d,messageID:g}=r;e.dispatch("imkit/handleLastReadFromSocket",{roomId:l,uid:d,messageId:g})}),n.on("roomPref",r=>{const{room:l,...d}=r;l&&(e.commit("imkit/updateRoom",{id:l,pref:d}),d.sticky!==void 0&&e.dispatch("imkit/aggregateRoomsAndFolders"))}),n.on("myPrefChange",r=>{e.dispatch("imkit/handlePrefChangeFromSocket",r)}),n.on("myPrefDelete",r=>{e.dispatch("imkit/handlePrefDeleteFromSocket",r)}),n.on("typing",r=>{e.dispatch("imkit/handleTypingFromSocket",r)}),n}const gi="Close",pi="Confirm",Ai="Folder Name",hi="Create Folder",fi="Tag",vi="Input Tag",yi="Input Tag Color #02B13F",ki="Download",wi="{0} unsent a message",bi="Read",xi="Pin",Ci="Unpin",Ii="Empty Chat",Ri="Members",Ei="Created At",Fi="Updated At",Si="Leave Group",Bi="Text",Mi="Image",Ui="Video",Ti="Sticker",Oi="Message",Li="{0} sent",_i="{0} sent a {1}",Qi="Tap here to open the link.",Vi="Type a message...",Ki="{0} is typing...",Ni="{0} joined the chat",Pi="{0} left the chat",Gi="{0} invited {1}",Yi="{0} kicked {1}",ji="You unsent a message",Di="File size",Xi="File",Wi="Translation",zi="Search",Ji="Location",Hi="Send Current Location",Zi="No access location permission.",qi="The request to get location timed out.",$i="The address is unavailable.",ec="Audio Message",tc="No access microphone permission.",sc="Remove from folder",oc="Edit Folder",ac="Add to Folder",nc="{n} Chatrooms",rc="Room Name",lc="Member",ic="Tag",cc="Folder",dc="Attribute",uc="Mass Texting",mc="Input Message",gc={close:gi,confirm:pi,folderName:Ai,createFolder:hi,tag:fi,inputTag:vi,inputTagPlaceholder:yi,download:ki,someoneUnsentMessage:wi,read:bi,pin:xi,unpin:Ci,emptyChat:Ii,members:Ri,createdAt:Ei,updatedAt:Fi,leaveGroup:Si,text:Bi,image:Mi,video:Ui,sticker:Ti,message:Oi,youSent:Li,someoneSent:_i,tapOpen:Qi,TypeMessage:Vi,isTyping:Ki,someoneJoinedTheChat:Ni,someoneLeftTheChat:Pi,someoneInvited:Gi,someoneKicked:Yi,youUnsentMessage:ji,fileSize:Di,file:Xi,translation:Wi,search:zi,location:Ji,sendCurrentLocation:Hi,noAccessLocationPermission:Zi,"locationInfoUnavailable.":"Location information is unavailable.",requestLocationTimeout:qi,addressUnavailable:$i,audio:ec,noAccessMicrophonePermission:tc,removeFromFolder:sc,editFolder:oc,addToFolder:ac,numberOfChatroom:nc,roomName:rc,roomMember:lc,roomPrefTags:ic,roomPrefFolder:cc,roomTags:dc,massTexting:uc,inputMessage:mc},pc="關閉",Ac="確認",hc="資料夾名稱",fc="建立資料夾",vc="標籤",yc="輸入標籤名稱",kc="請輸入自訂色彩例如 #02B13F",wc="下載",bc="{0} 已收回訊息",xc="已讀",Cc="置頂",Ic="取消置頂",Rc="沒有成員",Ec="成員",Fc="創建時間",Sc="更新時間",Bc="退出群組",Mc="文字",Uc="圖片",Tc="影片",Oc="貼圖",Lc="訊息",_c="{0}已傳送",Qc="{0}向您傳送了{1}",Vc="點選此處以開啟此連結。",Kc="輸入訊息...",Nc="{0} 正在輸入...",Pc="{0}加入聊天",Gc="{0}離開聊天",Yc="{0}邀請{1}加入",jc="{0}將{1}踢出",Dc="您已收回訊息",Xc="檔案大小",Wc="檔案",zc="翻譯",Jc="搜尋",Hc="位置",Zc="傳送目前位置",qc="無存取位置權限",$c="請求位置逾時",ed="無法取得地址",td="語音訊息",sd="無存取麥克風權限",od="從資料夾中移除",ad="編輯資料夾",nd="新增至資料夾",rd="{n} 個聊天室",ld="聊天室名稱",id="成員",cd="標籤",dd="資料夾",ud="屬性",md="群發訊息",gd="請輸入訊息內容",pd={close:pc,confirm:Ac,folderName:hc,createFolder:fc,tag:vc,inputTag:yc,inputTagPlaceholder:kc,download:wc,someoneUnsentMessage:bc,read:xc,pin:Cc,unpin:Ic,emptyChat:Rc,members:Ec,createdAt:Fc,updatedAt:Sc,leaveGroup:Bc,text:Mc,image:Uc,video:Tc,sticker:Oc,message:Lc,youSent:_c,someoneSent:Qc,tapOpen:Vc,TypeMessage:Kc,isTyping:Nc,someoneJoinedTheChat:Pc,someoneLeftTheChat:Gc,someoneInvited:Yc,someoneKicked:jc,youUnsentMessage:Dc,fileSize:Xc,file:Wc,translation:zc,search:Jc,location:Hc,sendCurrentLocation:Zc,noAccessLocationPermission:qc,"locationInfoUnavailable.":"無法取得位置資訊",requestLocationTimeout:$c,addressUnavailable:ed,audio:td,noAccessMicrophonePermission:sd,removeFromFolder:od,editFolder:ad,addToFolder:nd,numberOfChatroom:rd,roomName:ld,roomMember:id,roomPrefTags:cd,roomPrefFolder:dd,roomTags:ud,massTexting:md,inputMessage:gd},Ad="閉じる",hd="確認",fd="フォルダ名",vd="フォルダを作成",yd="タグ",kd="タグを入力",wd="カスタムカラーを入力してください（例：#02B13F）",bd="ダウンロード",xd="{0}がメッセージを取り消しました",Cd="既読",Id="ピン留め",Rd="ピン留めを解除",Ed="チャットが空です",Fd="メンバー",Sd="作成日",Bd="更新日",Md="グループを退出",Ud="テキスト",Td="画像",Od="ビデオ",Ld="スティッカー",_d="メッセージ",Qd="{0}が送信しました",Vd="{0}が{1}を送信しました",Kd="リンクを開くにはこちらをタップしてください。",Nd="メッセージを入力...",Pd="{0}が入力中...",Gd="{0}がチャットに参加しました",Yd="{0}がチャットを退出しました",jd="{0}が{1}を招待しました",Dd="{0}が{1}をキックしました",Xd="あなたはメッセージを取り消しました",Wd="ファイルサイズ",zd="ファイル",Jd="翻訳",Hd="検索",Zd="位置",qd="現在の位置を送信",$d="位置情報のアクセス許可がありません。",eu="位置情報のリクエストがタイムアウトしました。",tu="アドレスが利用できません。",su="オーディオメッセージ",ou="マイクのアクセス許可がありません。",au="フォルダから削除",nu="フォルダを編集",ru="フォルダに追加",lu="{n}のチャットルーム",iu="チャットルーム名",cu="メンバー",du="タグ",uu="フォルダ",mu="属性",gu="一斉送信",pu="メッセージを入力",Au={close:Ad,confirm:hd,folderName:fd,createFolder:vd,tag:yd,inputTag:kd,inputTagPlaceholder:wd,download:bd,someoneUnsentMessage:xd,read:Cd,pin:Id,unpin:Rd,emptyChat:Ed,members:Fd,createdAt:Sd,updatedAt:Bd,leaveGroup:Md,text:Ud,image:Td,video:Od,sticker:Ld,message:_d,youSent:Qd,someoneSent:Vd,tapOpen:Kd,TypeMessage:Nd,isTyping:Pd,someoneJoinedTheChat:Gd,someoneLeftTheChat:Yd,someoneInvited:jd,someoneKicked:Dd,youUnsentMessage:Xd,fileSize:Wd,file:zd,translation:Jd,search:Hd,location:Zd,sendCurrentLocation:qd,noAccessLocationPermission:$d,"locationInfoUnavailable.":"位置情報を取得できません。",requestLocationTimeout:eu,addressUnavailable:tu,audio:su,noAccessMicrophonePermission:ou,removeFromFolder:au,editFolder:nu,addToFolder:ru,numberOfChatroom:lu,roomName:iu,roomMember:cu,roomPrefTags:du,roomPrefFolder:uu,roomTags:mu,massTexting:gu,inputMessage:pu},ut={"en-US":gc,"zh-TW":pd,"ja-JP":Au},hu=ds({legacy:!1,locale:navigator.language in ut?navigator.language:"en-US",messages:ut}),fu=s=>{try{return JSON.parse(atob(s.split(".")[1]))}catch{return{id:""}}},vu={install:async(s,e)=>{const{store:o,config:t}=e;o.hasModule("imkit")||o.registerModule("imkit",Mt);const{id:a,_id:n}=fu(t.token),r=a||n,l=ui(t,o),d=mi(t,o);o.commit("imkit/setState",{config:t,uid:r,axios:l,socket:d}),s.use(us()),s.use(hu),s.directive("src",async(g,p)=>{const{value:m,oldValue:h}=p;if(m.startsWith("data:")){g.src=m;return}const{imageCache:C}=o.state.imkit;if(h===void 0||m!==h){if(C.has(m)){g.src=C.get(m);return}try{g.classList.add("opacity-0");const y=await l.get(m,{responseType:"arraybuffer",onDownloadProgress:U=>{const{total:R}=U;R&&o.commit("imkit/updateField",{key:"downloadProgresses",value:{[m]:U.loaded/R}})}}),M=btoa(new Uint8Array(y.data).reduce((U,R)=>U+String.fromCharCode(R),"")),E=`data:${y.headers["content-type"]};base64,${M}`;C.set(m,E),g.src=E}catch{g.src=m}g.classList.remove("opacity-0")}})}},yu=[],Je=ms({plugins:yu,modules:{imkit:Mt}}),ku={class:"flex flex-col divide-y bg-white"},wu={class:"flex items-center gap-4 px-3 h-64px"},bu={class:"h-50px w-50px relative"},xu={class:"text-base text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap"},Cu={class:"p-2 flex flex-col gap-4 overflow-auto"},Iu={class:"text-base text-gray-500 mb-2"},Ru={class:"flex flex-col gap-3"},Eu={class:"h-50px w-50px relative"},Fu={class:"flex flex-col text-base overflow-ellipsis overflow-hidden whitespace-nowrap"},Su={class:"text-base text-gray-900"},Bu={key:0,class:"text-sm text-gray-500"},Mu={class:"text-gray-500"},Uu={class:"text-gray-500"},Tu=L({__name:"ChatRoomInfo",setup(s){se.extend(qe);const e=W(),o=A(()=>e.state.imkit.rooms[e.state.imkit.selectedRoomId]),t=A(()=>e.state.imkit.users),a=A(()=>e.state.imkit.uid),n=()=>{e.commit("imkit/setState",{isRoomInfoVisible:!1})};return(r,l)=>(i(),u("div",ku,[c("div",wu,[c("img",{src:Ct,class:"cursor-pointer sm:hidden",width:"36",height:"36",onClick:n}),c("div",bu,[o.value.avatars.length===1?(i(),D(oe,{key:0,url:o.value.avatars[0].url,name:o.value.avatars[0].name,class:"relative"},null,8,["url","name"])):(i(),u(N,{key:1},[j(oe,{url:o.value.avatars[1].url,name:o.value.avatars[1].name,class:"h-36px w-36px text-16px absolute top-0 right-0"},null,8,["url","name"]),j(oe,{url:o.value.avatars[0].url,name:o.value.avatars[0].name,class:"h-38px w-38px text-16px absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100"},null,8,["url","name"])],64))]),c("div",xu,f(o.value.displayName),1)]),c("div",Cu,[c("div",null,[c("div",Iu,f(r.$t("members")),1),c("div",Ru,[(i(!0),u(N,null,Z(o.value.memberIds,d=>(i(),u("div",{key:d,class:"flex items-center gap-4"},[c("div",Eu,[j(oe,{url:t.value[d].avatarUrl??"",name:t.value[d].nickname,class:"relative h-50px w-50px text-lg"},null,8,["url","name"])]),c("div",Fu,[c("div",Su,f(t.value[d].nickname),1),t.value[d].city&&t.value[d].country?(i(),u("div",Bu,f(t.value[d].city)+", "+f(t.value[d].country),1)):w("",!0)])]))),128))])]),c("div",null,[c("div",Mu,f(r.$t("createdAt"))+" "+f(v(se)(o.value.createdAt).format("lll")),1),c("div",Uu,f(r.$t("updatedAt"))+" "+f(v(se)(o.value.updatedAt).format("lll")),1)]),o.value.type===v(yt).Group?(i(),u("button",{key:0,class:"w-full text-gray-500 border rounded-lg p-2",onClick:l[0]||(l[0]=d=>v(e).dispatch("imkit/removeMembers",{roomId:o.value.id,uids:[a.value]}))},f(r.$t("leaveGroup")),1)):w("",!0)])]))}}),Ou={class:"flex divide-x relative h-screen"},Lu=L({__name:"MainView",setup(s){const e=W(),o=A(()=>e.state.imkit.selectedRoomId),t=A(()=>e.state.imkit.isRoomInfoVisible),a=A(()=>st()),n=A(()=>a.value.has("roomId"));return e.commit("imkit/setState",{roomTag:a.value.get("roomTag")??"",selectedRoomId:a.value.get("roomId")??""}),(r,l)=>(i(),u("div",Ou,[n.value?(i(),u(N,{key:0},[o.value?(i(),D(dt,{key:0,class:"w-full <md:w-full <md:absolute <md:inset-0"})):w("",!0)],64)):(i(),u(N,{key:1},[j(Na,{class:"w-1/4 min-w-300px <md:w-full"}),j(Oe,{name:"slide-fade"},{default:te(()=>[o.value?(i(),D(dt,{key:0,class:"w-3/4 <md:w-full <md:absolute <md:inset-0"})):w("",!0)]),_:1})],64)),j(Oe,{name:"slide-fade"},{default:te(()=>[o.value&&t.value?(i(),D(Tu,{key:0,class:"w-1/4 min-w-300px <md:w-full <md:absolute <md:inset-0"})):w("",!0)]),_:1})]))}});const _u=ce(Lu,[["__scopeId","data-v-87d855bd"]]),Qu=async()=>{const s=gs(fs);s.use(Je);const e=ps({history:As(),routes:[{path:"/",component:_u}]});s.use(e);const o=st(),a=await(await fetch("/config.json")).json();if(a.token=o.get("token")||a.token,hs("localStorage"))if(o.has("token")){localStorage.setItem("imkit-token",a.token);const n=new URL(window.location.href);n.searchParams.delete("token"),window.history.replaceState(null,"",n.toString())}else localStorage.getItem("imkit-token")&&(a.token=localStorage.getItem("imkit-token")||"");s.use(vu,{store:Je,config:a}),s.mount("#app"),Je.dispatch("imkit/subscribe")};Qu();
