var Vt=Object.defineProperty;var Kt=(t,e,a)=>e in t?Vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var R=(t,e,a)=>(Kt(t,typeof e!="symbol"?e+"":e,a),a);import{d as O,r as Nt,o as l,c as m,a as D,u as I,W as Pt,F as V,A as Dt,b as pe,e as Y,f as W,v as Te,g as U,w as me,t as v,h as Be,i as G,j as se,k as c,l as ae,m as Z,n as X,p as ne,q as C,s as $,x as Ee,y as _,I as Ue,z as h,B as Ge,C as nt,D as he,G as xe,V as Ye,E as rt,H as Gt,J as fe,K as ve,L as Oe,M as Yt,N as Xt,O as Le,P as it,Q as lt,R as jt,S as Pe,T as Xe,U as Se,X as Wt,Y as zt,Z as Jt,_ as Ht,$ as ct,a0 as Zt,a1 as qt,a2 as dt,a3 as Ze,a4 as $t,a5 as es,a6 as ts,a7 as ss,a8 as os,a9 as qe,aa as as,ab as ns,ac as rs,ad as is,ae as ls,af as cs,ag as ds,ah as us}from"./vendor-432af48b.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const ms=O({__name:"App",setup(t){return(e,a)=>{const s=Nt("router-view");return l(),m(V,null,[D(s),D(I(Pt))],64)}}});const gs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAExElEQVR4nO2bS4hcRRSGa4yOGkUMKKKiID6yUbIRH7iI7hSiQWV0IwYXtn2rbj9OtaMBF/+5PTPEGNQZIQufCxUkAQVFRIwustfBx8ZkY1ATVCRO8DE+xiinOyNOcuvenqT71u2Z+uBup/7+63XqnDNKBQKBQCAQCAQCPqjVpi6MbTKmCc9py3uM5a8M4bCxOGos/6otftCEWW35DU08bpq4fmxs9xq1kgEwGhMeEEM08d/G8j/L+3BIE+8wFteolQSA041lYwhfL9+UE79j5u6qNtrr1bCjW8mNhvizfhiTYtQfhniqVps5Uw0hI8Zyo/MjBmDOEqMsf6IJV6lhYWxs9xpD/PKgjVnyEQ7HzeQWVXYqlefP0MRv97hFvjGWd8aW7zfUvi7aum2drLxKBWvNOC6JKLlNbjBN+MBYLOT/PfwSUbJRlZgRQ3g1f7Z5b9xK7gBwWq9/uNKcvFjOG0OYy1lJczG1N6gyEls8ln1W4LuohXtOZYx6feoiiY1yTDpwbDWW7Lay+DNj+c9GduKyfo1nLGzWttMWb6kyxTna4tOMGX231dpxTr/H1YTbDfG8e9zkblUGIoLOWjmDMGcRicyztppE78onAEZdEbKcOfU6Lh+0Bk28PeOmfFj5JM6cweTe4kIL7E/XgS/ldlW+0N2XeOpVXqQOyQw4J6qR3Kx8pSy041UucU7BckbkyZG+1flZ5QPdxH2OZf2tj9yNthw5zsLPi9bSQZJdjmW9U3mgE213E27HT9hRL4Gjdpw/8rYqXMyiJuJ9pTmHjKRJU8RUW7hWeUIi6DRNEeFBD2L4pzQxjQbOV54wlmcc275RuBhN/FeaGHl6FC7mP02YdBj0RPFiLH5LE0P09NnKE8biKUdc9njxYoi/TxPzCE1eqjyhLV5yxEJR8WIIs6mz1cKtyhMSwTtis02Fi9GOxJUkzgoX03mTYa1r29fH21cXLkhLxTN9Oe/xknZpJnem6iE+6EOPknKwYzkvSFRbuB5XJYXwuvJW3rE45Lg1porUIulcZ3aR+CHlC92plafO2pwk2IvSYSxecGz3I7UazlO+qDba610pDznEi9AQE25wFgwIzyjfGMu7HNGrnEd2kGNXLC5wN0VgIW5NXKF8U+2uIkcNHgtSfRjEuNK0YAgfuieHZ1RZMFL1dAklnpfc9QCymR+5x8QBrXGuKgu17mx+nDGbEo9slwR7f1pqsnuNdDPZrMpG7dGJK7XFj9kmYb8k2E+m0iAlJE38oiuLcNw475Wyb6hKuEm6LHrq6bEc5QWUnU4Pi7skCNQWv+f93aEwKaJkY24XxtKtt88Qv6kJ09riSfk6UTHxXtfbauhNiqm9QQ7KU/lx/fpKa1K0dds6V464b5/cVs1ks5gwlCYJ0mXR/9XUaX2ZWbzK5ccPtUkARqWRwFmW6XW7WD4iz4e0CHnoTVpEalRSDjbEX6QX+k44xA9qy6/Jqzzv4bliTPr/OSWGmSZvkdKMJNfl65aRselk2ntXnEkD61uyeCfHpPe3AGep1QqCSfkEk3ogmNQD4eDun0nTajVTyzfpZ69Nn6U3iXh+Of9DsupM0hav+NZWNpOmZVvJyhFzSpXHLhFy5qzucycQCAQCgUBA9ca/01SgfkYyM0gAAAAASUVORK5CYII=",ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFSElEQVR4nO1azW9bRRBfia8jggKlfPSAACFF4f8AKkQ/0lYFxAFw6lnHeMYNCRdmbJqkEtAol6KKK4iqd+DAAYFEKyq+BEJUcKINLVAqoCQF0jageXYav33P4a3f87Mj/JNWSuzd2R3v7MxvdtaYAQYYYIAB/qew43wHVOVJIJkFlPct8Ukg+dWS/KMNSH4HlG+A5D2LfLBEsqtQ2b/JrCdYO73BEpNF/sQSL68ol7QByhWL8pElea4wceBG068Yxf13WuRDFuVPXyXXaH9YkrlyeWqj6Rcw8/UWWYD4YoaKhhvyBSCeLBQOX9dTZS3Wh4H4y/aL5ctAfMyiTBWrvA0q9aHi5MxNunBt+nfwWZW3aR8gOR6YdHvFT1ji+3uibIlkFyAvtFnYKYsyoWbuK3fseb5LdxNQTrc3c95i8gQgl+McEhD/bKtcUDPP5KhUeK9FORdnOfqdyQMWuRLrXUneROSbM5/PTm8AkrdilF4uoTxtugmo8o7oGeMlS/xM961KRhtzhXe6RPxYNx3UReeXXixVaw+ZnADID+ucjr/4rTxevy/TicbG5m6IemNeylPZFRSrtUfcnQbkz5j52swmAZJazBnquhm3Q+DMogytmonwcpk3R0wZ+Q3TYwDyETdcwT6+PQPB8roberrhjX1RIL4FiH9xdvnlVEL3Vvm2CDeucsH0CYrI4JzlBWVvHQu0KBMug8qCVGTqTB1GBiTFjgVaks/DCstE4rFY2wrEP1rieYu17Qn6b7fEZ7SpJ046j9JQR+HjphMUK3yPG+R9uLFF+SlEBZH3tO/Le4I+q2fxh8TrpJfuDpMhXh4bm7o16firsBV5ynFWx4wHwgpfVXp3tB/vblW22XfeZy4g+bh1fIlqIz7jAwDKYcecp4wHdFJXEUC5pFlWOOOSS9Ef5r+PQCssyozjaw76jA9gUT4IC6ltNZ6ACu+MUwhIHm/y8sh3JeQnvOep8g4nJr/tK8MAyfeh3anUh7yFNE3WVUz/j/sszuSTzVEfdsLTtx0IkVD8TUM24k23val3QkKc43fOW4h1Evy08bdhdm56t2riaeOx42D/8hIwMnL0GndhqRWOPc9N867wzp4qrHDvq9KZdG1kLZPu1Flla9LIp9ar07Ik33kLAeIPexGWtDSTNiwB8jud7Mwh51xM+40PuHEuxAOID4TXKrM+4wPojWAaUm5Rzqaglmf85tIL+tbj14ETLJd5s7M7V/SSPPEigsyns+TBR+HgRsZJHjSPTzo+BIvylWPWkyYhtDqwku75poc+lQWL8kIaSwwBUMadXT7dbxcAQb7dska9BelYYLk8tRFQ/g6dr7xKHAkAyCXHOy9opSKdUJLXHJM5r4He9EPhPVJ34ldSCy6r83ISCa31mB4DiI+GeQJfyOSaVmGRX4zhwKOmR7AktmsX8S23g1875rOktR6TM9SDR2gpyaeZvw6ASn0opgC+mKfSjVAXLqY1XgLxvV2ZsNSggtFyaQ6eW804loYSP5prKLCrIeFIN7y3XrlGHFSTUQHKsyavJw8Q8/hEaz0a+PXMZ+M3uKRhMEbZy7kpu4JGetfmUQvxvNJQvSQ3ntAxDboYZlCtZ7brZtwOJeIHgPiLeKUbCUdwSY4yE+SsWB/WmxOlp9r07+I+fjD48TTFQz6x1rMl9cZdc1BJoeFAnwlq4G+30Azaoj5+6yceb4KnhyRzkTcYKZoeGUB5NTMG1bVCtTo1p96TvPGypngahvqh8O6dbQWxm2TWkrzbfD58XjOwoAUemE/qd9pH+3acvA8wwAADDGDWP/4FAPVu0JK6ZhcAAAAASUVORK5CYII=",ps="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAADQklEQVR4nO2av2sUQRTH5woVwUrBRgP+QFKaqI2ISOzETkVIJwhJ9s2ed29Wbd/snqRLIdgIlikkCGnEVNEmGPwHzIWAhbFRo+BphCgSebmgl83dZvdub3Y3t1+YZrm5mc++N2/mvR0hcuXKlStXxmSpSh8oeiaRalLp9TANUC8D6gkAOiCyB6u/hAXdBq70fLH4cJ/IioAt2yZsAzSJrEhGcOPWwPTTKtMJkQXJDmETb0g1QD09VvL6ewP4P/hXjke9A1xfWlM9Bqy/9RSwVHo9B86VK9fukuW4V6WiD5nfklAv2457ZUdg/mHSk42tIb3fETjxScbcRA7sU9IWyS2scpdez9ew2l1BawmQHoHSw0XlDSLSwZGRx3sQJ/YX79NRfgaKboGiJ4D0LpPAgPq3RJqUJfe8iKaC7dBlQHoKqP9kBXjmzj3vlOhQUKIBQP0qzcCrNurbwrRkErCoP8oynWkxpYLleGclkscWk4qqgPSj3vQCPwOl3YD+wUoCtkVJtQBlugmoF8P/H1XBoRvcN63Aq80sU7xbOQlKv+nkc4/tVI6nDrjZmrXQHQJFKzF4zmcL3UtpAp5pBisV/YprDEC9tiO0qX3Wv/XU3TgGyzaxtB3k3kasizTpG7YQes0iPR/FB0f4lAVIL0K9YEWvWwYyI8C+ExRH47B9GfTfElCVvvAv2b2eFPDSNutG2HranS+gXkgEmBOBLeOV6VyU/p3Mt6i8QfPASg9vGQ/JMwUskbR54BINNI5XPy6aAQbUs8aBpRw/5ANeDIrGIqKCozdVjQMT0d4wd0oao3FUtYzeSLWuXGoJav4rTYkDA+rpbgKPOXQ4jEuzW7YDvQk7E9qlx0peP18I6RYw57aN40lFL6P098+346DVcPVwiu9IxA3MBTfRoI3k3RSwSsGFOc6HTQHb6J0WKVCB11b3gemtSIu4LNPt5MFy6JpIkTg9nA8XeOrROzgab4sbc5HqXCY0WqJjoOhTF4LkChcXRBrF5Rguy8QGi3rNLrsXRZpll90LG3XqGCxroTsksiCuQXFZpgPYOV4iImMqcFmGKxVRtp60RWPRjrhSwck7Hw03X8B3bpufWmb5BOXPs1vpL/lk/qgLZYgmAAAAAElFTkSuQmCC";class ge{constructor(e){R(this,"id");R(this,"nickname");R(this,"avatarUrl");R(this,"country");R(this,"city");const{_id:a,nickname:s,avatarUrl:o,country:n,city:r}=e;this.id=a,this.nickname=s??a,this.avatarUrl=o,this.country=n??null,this.city=r??null}}var E=(t=>(t.Text="text",t.Image="image",t.Sticker="sticker",t.Video="video",t.File="file",t.Template="template",t.Flex="flex",t.Location="location",t.Audio="audio",t.Recall="recall",t.JoinRoom="joinRoom",t.LeaveRoom="leaveRoom",t.AddMember="addMember",t.DeleteMember="deleteMember",t.AddMembers="addMembers",t.Announcement="announcement",t))(E||{});class z{constructor(e){R(this,"id");R(this,"roomId");R(this,"senderId");R(this,"type");R(this,"createdAt");R(this,"updatedAt");R(this,"groupId");const{_id:a,room:s,sender:o,messageType:n,createdAtMS:r,updatedAtMS:i,extra:u}=e;this.id=a,this.roomId=s,this.senderId=(o==null?void 0:o._id)||"",n==="line"?this.type=u.type:this.type=n,this.createdAt=r,this.updatedAt=i,this.groupId=`${W(r).startOf("minute").unix()}-${this.senderId}`}_string(e,a){var n;const{t:s}=pe();let o=s("message");switch(this.type){case"image":o=s("image");break;case"sticker":o=s("sticker");break;case"video":o=s("video");break;case"file":o=s("file");break;case"location":o=s("location");break;case"audio":o=s("audio");break}return this.senderId===e?s("youSent",[o]):s("someoneSent",[((n=a[this.senderId])==null?void 0:n.nickname)??"",o])}get string(){const{state:{imkit:{uid:e,users:a}}}=Y();return this._string(e,a)}get isIncoming(){const{state:{imkit:{uid:e}}}=Y();return this.senderId!==e}get isOutgoing(){const{state:{imkit:{uid:e}}}=Y();return this.senderId===e}static fromRaw(e){if(!e)return null;switch(e.messageType){case"text":return new Fe(e);case"image":return new As(e);case"sticker":return new $e(e);case"video":return new hs(e);case"file":return new ys(e);case"template":return new fs(e);case"flex":return new vs(e);case"location":return new ks(e);case"audio":return new ws(e);case"announcement":return new Fe(e);case"addMember":return new Ve(e);case"deleteMember":return new Ve(e);case"addMembers":return new Ve(e);case"line":switch(e.extra!=="object"&&(e.extra=JSON.parse(e.extra)),e.extra.type){case"sticker":return new $e(e);default:return new z(e)}default:return new z(e)}}static fromPayload(e,a){const s=Date.now(),{roomId:o}=e,n={_id:Te(),room:o,sender:{_id:a},createdAtMS:s,updatedAtMS:s,...e};return z.fromRaw(n)}}const be=class be extends z{constructor(a){super(a);R(this,"text");R(this,"translatedText");R(this,"replyId");R(this,"urls");R(this,"html");const{message:s,reply:o}=a;this.text=s??"",this.translatedText=null,this.replyId=(o==null?void 0:o._id)??null;try{this.urls=Array.from(new Set(be.autolinker.parse(s).map(n=>n.getUrl()))),this.html=be.autolinker.link(s.replaceAll(`
`,"<br>"))}catch(n){this.urls=[],this.html="",console.log(a),console.error(n)}}get string(){return this.text}static linkfy(a){try{return be.autolinker.link(a.replaceAll(`
`,"<br>"))}catch(s){return console.error(s),a}}};R(be,"autolinker",new Dt({className:"underline",email:!1,phone:!1,stripPrefix:!1,stripTrailingSlash:!1}));let Fe=be;class As extends z{constructor(a){super(a);R(this,"images");const{images:s,width:o,height:n,thumbnailUrl:r,originalUrl:i}=a;s&&s.length>0?this.images=s:this.images=[{id:i,width:o,height:n,thumbnailUrl:r,originalUrl:i}]}}class $e extends z{constructor(a){super(a);R(this,"stickerId");R(this,"stickerUrl");const{sticker:s,extra:o}=a;s?(this.stickerId=s,this.stickerUrl=""):(this.stickerId="",this.stickerUrl=`https://stickershop.line-scdn.net/stickershop/v1/sticker/${o.stickerId}/ios/sticker.png`)}}class hs extends z{constructor(a){super(a);R(this,"video");const{id:s,width:o,height:n,thumbnailUrl:r,originalUrl:i,duration:u,thumbnailFile:d,video:p}=a;p?this.video=p:this.video={id:s||i,width:o,height:n,thumbnailUrl:r,originalUrl:i,duration:u,thumbnailFile:d}}}var Ae=(t=>(t.Buttons="buttons",t.Confirm="confirm",t.Carousel="carousel",t.ImageCarousel="image_carousel",t))(Ae||{});class fs extends z{constructor(a){super(a);R(this,"template");R(this,"templateType");const{template:s}=a;try{this.template=typeof s=="object"?s:JSON.parse(s);const{type:o}=this.template;this.templateType=o}catch(o){console.log(a),console.error(o),this.template={},this.templateType="buttons"}}}var De=(t=>(t.Bubble="bubble",t.Carousel="carousel",t))(De||{});class vs extends z{constructor(a){super(a);R(this,"contents");R(this,"flexType");const{contents:s}=a;try{this.contents=typeof s=="object"?s:JSON.parse(s);const{type:o}=this.contents;this.flexType=o}catch(o){console.log(a),console.error(o),this.contents={},this.flexType="bubble"}}}class ks extends z{constructor(a){super(a);R(this,"address");R(this,"latitude");R(this,"longitude");const{message:s,latitude:o,longitude:n}=a;this.address=s,this.latitude=o,this.longitude=n}}class Ve extends z{constructor(a){super(a);R(this,"members");switch(a.messageType){case"addMember":this.members=[new ge(a.member)];break;case"deleteMember":this.members=a.extra.members.map(s=>new ge(s));break;case"addMembers":this.members=a.extra.invitees.map(s=>new ge(s));break;default:this.members=[]}}}class ys extends z{constructor(a){super(a);R(this,"url");R(this,"mimeType");R(this,"fileName");R(this,"bytes");R(this,"fileExtension");const{originalUrl:s,extra:o}=a;this.url=s;const{mimeType:n,fileName:r,bytes:i,fileExtension:u}=typeof o=="object"?o:JSON.parse(o);this.mimeType=n,this.fileName=r,this.bytes=i,this.fileExtension=u}}class ws extends z{constructor(a){super(a);R(this,"url");R(this,"mimeType");R(this,"fileName");R(this,"bytes");R(this,"fileExtension");R(this,"duration");const{originalUrl:s,extra:o,duration:n}=a;this.url=s;const{mimeType:r,fileName:i,bytes:u,fileExtension:d}=typeof o=="object"?o:JSON.parse(o);this.mimeType=r,this.fileName=i,this.bytes=u,this.fileExtension=d,this.duration=n}}var mt=(t=>(t.Direct="direct",t.Group="group",t))(mt||{});class Re{constructor(e){R(this,"id");R(this,"name");R(this,"type");R(this,"createdAt");R(this,"updatedAt");R(this,"memberIds");R(this,"coverUrl");R(this,"lastMessage");R(this,"numberOfUnread");R(this,"lastReadMessageId");R(this,"pref");var x;const{_id:a,name:s,roomType:o,createdTimeMS:n,lastMessage:r,members:i,cover:u,unread:d,memberProperties:p,extParams:g,pref:f}=e;if(this.id=a,this.name=s,this.type=o||"direct",this.createdAt=n,this.lastMessage=z.fromRaw(r),this.updatedAt=((x=this.lastMessage)==null?void 0:x.updatedAt)??n,this.memberIds=i.map(B=>B._id),this.coverUrl=u??"",this.numberOfUnread=d??0,this.lastReadMessageId={},this.pref=f,p)for(const{client:B,lastRead:K}of p)this.lastReadMessageId[B]=K;if(o==="custom"){const B=JSON.parse(g);this.type=B.roomType}}_displayName(e,a){if(this.name)return this.name;if(this.memberIds.filter(s=>s!==e).length===0){const{t:s}=pe();return s("emptyChat")}else{if(this.type=="direct")return this.memberIds.filter(s=>s!==e).map(s=>a[s])[0].nickname;if(this.type=="group")return this.memberIds.filter(s=>s!==e).map(s=>a[s].nickname).join(", ")}return""}get displayName(){const{state:{imkit:{uid:e,users:a}}}=Y();return this._displayName(e,a)}get avatars(){const{state:{imkit:{uid:e,users:a}}}=Y();return this.coverUrl&&this.coverUrl.length>0?[{url:this.coverUrl,name:this.displayName??""}]:this.type=="direct"&&this.memberIds.filter(s=>s!==e).length===1?this.memberIds.filter(s=>s!==e).map(s=>({url:a[s].avatarUrl??"",name:a[s].nickname??""})):this.type=="group"&&this.memberIds.length>=1?this.memberIds.map(s=>a[s]).sort((s,o)=>s.id===e?1:o.id===e?-1:(o.avatarUrl??"").length-(s.avatarUrl??"").length).map(s=>({url:s.avatarUrl??"",name:s.nickname??""})):[{url:"",name:this.displayName??""}]}}const gt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADQUlEQVR4nO2bu2sUURSHz4CISlR8pNi4e24S151zx0ez2XMmD1gROxEVEcRHIYJYCPaCna9CBBULK/uUAUX0D1Ax4gpa2EUbg6CkMaiIyjWKSdjsIzs7z/vBVFvsnW9/587cc+8CWCwWi8ViscQL5cpu1PJQaZ5Ad3gk6vHEijwN7VCaZ5WWX+ZCkm/9mg9EPa54UK2uUFqe/5MzT9J3pfkgZB0kvrRYjpX0FyQpzyWlvqBMJ0mp6ipF8rqRnExLUsS3WpGTSUno8R6l5Wc7gjIjqVjkdUg81a6cBZKocgjSCmq+t1w5qZdUcP39ncpJraRcqbwZST4EJSh1khTJeJByUiUJtZzohpxUSCq4I32K+FM3BSVZkjPXwuiunPmSsOSPQlLALpdW/YsnICkMDpbXI/HTMAUh8QNIEoOhSuLZfvKrod6g646sNd29gpbzqPmq0nIbSS6i5tMDJdkVF0mo+VWr4wkCxywKleZHpv3ZJNJTqOUGUjkXjST+gVqueJ63MhQzWPJHkfhZ2wMl+aI0X8uVy2vCkoRa3iqqDIcixoAkZ5p1+JpPklLr18MKGknS8qRDOaZVcrfXq/ZAWKArhwP7ZYmnTTu1G0lCkveo/b0QAU67Xb4m8Z8Z8Hxu2BdqN0kk43nP3wgR4sRREmr+GKdlhBMnSUh8v9kTMpOSUMuMeWhAjHEik0T8eOv2oQIkAAc13wlKkiL+3PTppvmk+V5IEE6YkpKKY9ZggZUb8XRSSihCSfKy0bIkqThBlptZZEIKcYJLEs/mt/lbIG0Ui2O9ZrINJkV8HdIE7hzboLRMBjgXvYO0gAHL+XeZM4qQkq3jWt2b7LTcPDkFaU0OktT+zEkdTdx8AdKYHCSpmc87fgUgvglpTE7uv5yOXgGQ5DJkQM6yJSHxOUhpWS1FW+WGxPsgA8lZVj8JNX8NdXciJnJalpSYvXQMXk5Lksy5RciwnIaSzA5u7LuHfVTZ1OGE3CoLJu65E2HsQ8aT0yBJlbMQZ/rCS85iHLPNDXEmn/dXK80vIpCTDBTJ0aXkmGRB1kHPP27lNKDXq/YokjfzJE3a5NST5FaOocdHzL//uhpZi8VisVgsFosFYs5vllNJQwrDPNkAAAAASUVORK5CYII=",bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVR4nO3WPQrCMBiA4W+yh/BcniABFyNIsrsnOPRS/kz1KlJ35SsdOkhtRaGp7wOB0pZ3CGlSEQAAAAAAAAAAJsC5sjA+bU2IZxviXUd77fTZrHrr3WFpQ7zakB6vhvGp0ndm0XOuLPpi3eiQmZx6T3SZvIt1opvce2J9ugwOhnjKvScmxHpEsM69J2OCNsRb7j35uyVtQ3Tf3BSm3pP2QK8GxKrVfr/IvdfQQ7sv+smPwpR7DZ0dXRL6HehG0WwWPh313uCZy6gHAAAAAAAAAID8wBNoenSqsgBAfQAAAABJRU5ErkJggg==",xs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJklEQVR4nO2bu04bQRSG13kBJJQUCDPHcgye43SYnLMFr4HyCkiAKKDlJkGTtKFIHyoq8g5AmvAAQJHkDQINIKFFayMhEDu+7FqOZ/5POt1OMZ/O/Ls7OxtFAAAAAAAAAAAA8Ihqo2kMy7ph2SfWbyNVVr8Qf1ycrEl5IHKmWFeN1VtiTUa87g3rQa02/64wORXWT//BxJIiy1j9S3WtFCKIrFwOe0I0EElyXq02x/LJqWtl2BOhQZbVw1yCjI1nhz4JHngnLecQpE3vBbHcpPOEIHYtNbnsK49C6CDKk0dBCeI+8ig4QdxjHoUmiHrNoyAFcUvSURRFJQjinHkUbAdx633tjqzEEMTOLvpdbsTj6CB2dZP8yMyjkJcYPe+kpcAEybGxstUq1pOO11u5fnU30kdBxurGiyVTSkV1MW4vAEFynJEnJcN66hYkZ94LMlY2s+5IxLrtHMtyFYKgrf4F6T//BbGeZCyxN8bKT/d4+eW9IHrqomchTaw7XYzbDUIQtTvp9PHOtd25c9q3+fJ0PBmMIOpVaHgPitpD4VUjcXQOXlYpUw62O5IOuYMNM8oShC1XdcnBpj1lLSt89tH8uRPsc5DFp+ekkNwJrYNMvuMvOEDlBEfwuoCsXHi5tGwBhzhTTEMW/JOjfwo7BtyWFK+kYTbsiRVQ92Tl+8RM821UNO8/zE1RXdeI9esI/orwOf0V4dVdQQAAAAAAAAAAAET+8gBbyTNTzlJ3OgAAAABJRU5ErkJggg==",Cs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOElEQVR4nO2bz2sUSRTHe6K7/jgIiyxozFQFHZ33OojoOO+NUchRA7q7Fw9ehM0ejR7iwt7UgwcNCOqfkL/Do7/BX+BlYTHir+hZYY3rzsjrnsiYVFfPD2e6OtQXGoaZ7p6qT7/36tWr6iDw8vLy8vLy8vLy8vLyck6l0pF1KqydVkB3NfAHjdzo4fhfI73SwHOjY7QnyLtGdta2KeDHPUJJOOizBp4Jcm050C843xwXgjxKIZ8ZAJz8QlJA9wYIqKGQrgTB8TVBXqSB3g8SUBPSkyLQyW0lGnEe1qDh6EEdwB8U8h0FNB2G4Y8eEFosFuhhsTw+7C0IbVZFD7qypMxdAQcY+4BOeUBoAYR8xwNCW+Cm9x4Q2t3MA0IPqNFLoPYWhB5Qw1sQ9i8X8i6GHlDDWxB6F2tkNR/zMQg9oIa3ILSVLHhRA99QQOeL5doxPcaodh/6KZiYWDsyUtsgZVxZi9NAJzTQ1Xidj/5b9S6mgB4qpD8iGJ32MaxuUcB/KeS/Vx0gBfx4tFw9HHwfFVYNIIX0rzz1zFc9HLWaFwq4ErigrGHo5Qfw/WGobg5ckVuWQ3dLJdqU1uZKpfKDgupRDXRNId9WQO8U8Kf4oHfynQaeVbtqB4MgGFodgID+KZUO/Zy20UKX+axA6MBdF+QauTa3gBTSR40H9trbSb8poOc9WOfzUaRf8wroT0sTC7IrRCPXv8N/1SXB7Gi4zxqOBn4qMSURDvBcH/5zrm1IWQMqhvyLpW0X+ma1QOecB6SQniQ9SYk5JreSeCXTjmgPZLqlvGxOUT4afq/bHo4bgICmjW3SE+vNAZluyn7KFohTps7H39HU0nkygZVrDefNp45u2QGiz0kJoQzLpk63wmlp/2QrpObnyeXnCSSjJaVtMM0Q0M3kJHBlniOuYulDBCkJzpIU8KOV9+UFazKZoXtdNHeiejQB6KuUBz1pg9NMF94Y21I+MO4eoJCOG9sDdN1idV/jSqeSWlLifYFnndrEqSMLqu0zd4RvJ1/Di1JF7BSO1JOkfNKpu8cNkpIkDh7Q9rCiEtpjnWelxZm0IG4GT29tgKazALS1Utlobg8vplpfm5DagbN0v8SbyMZGFSVeHlCiiuXx4UFDyo2LLbOkU3Gxqf+BO6mkag3SHcJpH5IlSLsmDTyb2JGQf+/6vkhTXQ3zrkntqh3sU6IokF53nCg6qKGoTLrSJR9lMtVwURp4xhR/4reDupus7hjbXzSmEHl8G7Ikb0EizZuCaQukQrQU3Ua5Q+BopFsG93rWdTE/a0mB3VgwA16MXcUcT5YBfS3nJiSf9W6mLU7JiZKr4ypkXrTPgQqyiSF+F79nOHWNdCl3o1Y7kgK7OXC36VJI87mPOWmKlp6BZ0x5UnKs4QW5JrejVdCdhiT7jacldEsmm9HoFi8JvY1WMIAvNzPkttzpCzIGFAwMLQUoAAAAAElFTkSuQmCC",Is="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEJ0lEQVR4nO2bS4wbRRCGew3hJSQEKELZeKqdxcFVYyKQBldNlpX2BlwCOYQrF5QDSsIjVxRtlAiExOPChTPixhkkOAQukAVlw0uC5cBTKDxyIomWiEeM2rEQbNzttteemV76l/rmnun+XF011dWtVFRUVFRUVFRUVFRUVFTl1Gw+cC2k+SFAXtYoFzRJdwPtL038g0Z5tdHmu1Toqu/MtwPKxxuEYmn8p0Y5rIK2HJwWnP+0oypEAcnjBcAJFxIgf1AgoC4Qv6jUw1epUKSRzxcJqA/pkwT5ke1NrlceVtFwdFEN5QKQnATkg2maXhMBkcNikU8nrfnZaEHksipeGcuSSl8KVKDvQz4QAZEDEMnJCIhcjpvPR0DkXmYREEVA3Y046mhBFAF1owXR9L6F4hKjCKgbLYjiEuuWlY9FH0QRUDdaELkycr4IJCcA5Ygm3qvbQrBr4eYsy7aYCk2zubA1oU4bUt6niY9p4vd6paf/wRI7BSj75+aym0ad4yx2bu0XRT/fhIB4pYF8n5qMZjYRIF4zNbvSqx7lg5ArGpCs1lv5LlUFlQ1Dr28oHxpHq6qiSlkO8vLWdPFGr3Gnnbs1ydOA/AagfKRJzgDKj6YoCchvAvISoGRj+Z0qAgKSVRNtnINdXLwaiB/VJF/7Q5fvNclj5jMgYEC8NsznNFqd+w3EDbznq6SV7wkSEPSilVUzGvm4Jrk0gXddAuIXlFK1gADxiiOUzwDKKxN/J/Jr3pDKBtRwfAT2LWdaVvtSCIBOuXyO17JC/sPkZeYoDWC2zRz3A+LfPK13b6UBAcp+e7SSL8c9tZaQPOFnRfyNSXArCQiIL9oSTwPO9zlJe/729f3raX6Lr1MfEiDKBCQnLEOaAeRvfZ9Tr+fXD54Xr3k+44wz3ysNEMoRi/VkozxnAoC60No9XzlASSoPWsZztHBAKM9YAQHxuVIgtYUGj0feGhatrJOxzXFIdAPidxydebkMQLa8SxN/Oq0z1rboZiKmC9DBMgDZzgsC8S++0WpU2aIbkPxq7WQGCsiniwa0LctuGDQeTXJ24L+885656QHic86OSWt+tmhIc2kGFkCfDQSEvDStaxfOJbbOkg4AyftFnL7vb2YNAMRvW37/u9kgMzeTRgWz4065TSM/5XDS76pQpHu1rILDPMmzKhTtSHMuHNAd+b0qINV6txULAgTIP5VeWhpVxhd6//sDotsoyapGflKFpizLtpg9ZE8LWBr3kiCgfKf14nUqRCWtfI+PFfw7ug2LVlf0TXmfClka5flRHPaI7WW1CVQzV8snDgfl9eAcs0M1U6qZUNmnbzmbB84/ahA/ZPaQxwVjKqzB+xyvdCjND5ltUn8w/LNx3MFGKzWeaho7u02KYDa7gPiL3sbf5Yu8qya30sTPJaks+C6nvwHqSkKcY2gfKAAAAABJRU5ErkJggg==",Rs=["src"],Es={key:1,class:"w-50px h-50px rounded-2xl bg-gray-200 flex items-center justify-center text-xl font-600 text-gray-500"},ee=O({__name:"AvatarView",props:{url:{},name:{}},setup(t){const e=t,a=U(!1);a.value=e.url.length===0;const s=()=>{a.value=!0};return me(()=>[e.url,e.name],()=>{a.value=!1}),(o,n)=>a.value?(l(),m("div",Es,v(o.name&&o.name.length>0?o.name.charAt(0).toUpperCase():""),1)):(l(),m("img",{key:0,src:o.url,class:"w-50px h-50px rounded-2xl object-cover",onError:s},null,40,Rs))}}),Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsUlEQVR4nO3aS04CQRAGYNSLKEGNXmS0K72ZdIWlUsU95mYSjQY16BVcaOIdjIo2LgyRx4D9HOpP2LD5+6OHoemeVksikUgkEolEEjkF0qEydA+G3sDwhcb+Xqyx2G6FNLBjUUh3p93+gfMSQL4F5PHvi541cqcVOLbTdk+NxdDQdc+WQn6fBodHz8Qij+3YnJcppKu/4HDoedifGeZL54VQ9tpzCz2jF2Lt+2Wv7aW46J7tguGn2cX8qrp8FBrr/eoqAqKjY0Oik8GGQEN5vp8U1ifaYhXyS3JYH+jksS7R2WBdoLPD/gedLXYddPbYVdCNwdZZOFhoo7A1Z7pZ2NXRDcDWRzcIa7P4BuXuD0cu2HFj0FAfmz9ab9LPEtRYVMTYLvKSVVZQ2aNhjeVitmiN3Fn3e5kdWjvYcMsGrR3uLiaP1h62UpNFa4/7xsmhdYBN8mTQOuCJQHS0jnD8EQ0Nm3ZcCoaGMRf7S9A3TssQcQeQP2Nhlz7yYOijqqptp2WA/BgTuxhNI+dFJ9g7VoYfJjNt6NrbYwZ17yd2DJOrjkbRV2ASiUQikUgkku9P4AsjhYRlvSHnTwAAAABJRU5ErkJggg==",Ss="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVR4nO2WQQ7CIBBFuZKa2o3deF/0ZKYmhvUzpBhbYpUZIZjIWxf+Z+ZTxphGYwVgAE7Azijxa4Gz30sjfmPiCvQK8S1wCXs44CgRdywZgU4g3oU1c1xSJZhK9ookEyviD2xq30aNiQ/iY3KegM2sfzE+E/sca7KZyC4u2biYuKCvqryI4P0py5z8CxP5xQUmyolXN0DNFlAzhNS8hiyfVO2PqC8mbp7f5jWBQDy7CWo/x/zAQDJUHck8wCEaSsV3OspE+lAaVcL6QBolIcxWPJY3/oo7tk8INpQnayAAAAAASUVORK5CYII=",Fs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVR4nO2ayW4TQRCG+0DgTiRCFHNje4tcfTGZv0aN4yoncEADAhIOIMGRBwBC3gUlyhOwRAGOSIEnACMlcSSWyEHlcSSWhGjaPZs8v1SSZc9096dud1dXlTGVKlWqVGlEZe21s0TMRLIM8BrAm0TyFeAfaoPPm/qbPhOG0tJ3TJkUBHPjAC8CvE4k+27GbwBZ0LZMUQVIDeDnRLzrDvqnAdwl4iVr56dMURRF0RiR3ANkxxfoITO+C8jjer1+KldYa+USEb9PD/QfexcEcxdzgSVqh+nO6pGzvQ0IMobl60TyM3vYg/+27AUB38oEFpCbeYEeAr6QxTLeyxv095kmagepwFrbPg/wVt6Qh0DvELUue4a1JzPejZNCv9Xj0RswkTzKG+p4aH7gBdba+anY4/E1OH4Rtyk1IlnxubQBmRwaGH130evyqx20PTPTPOd5lp8OBRsEc+M+fWO1v/vwDNwd6sIB8KLPAaUNPIC+MwzwetmAieS1I6xMEkmvhMC9RmN2IjEwxZGK/RIC60nQdACW5RIDLyUGRhxnKimwrDgAy6eyAmtg0AW44+JBJe7o+HE4eGT8xaWj764elG8l98j4W+JOMILAnaQbRRrQMSyvJhzL58QdEcnHNDaUAm9aPFrHEo2a4xGG0iorcBjK1cTAjcbsxEhdHlSaxSsfML80rgJkoWzAgNweNtfbHZkQj0p3vPIE8eSJKV6YVvoemaMH9R/jbW/lEgA/9DkT6RjfN74URdGYpjMKDLvhNdVS9GSaViKYNAQIipYuBeSKSVNEHOUNOrAeIDdShS1SyYNWIpgsRdQO9CjIHpa3Ul/GR4modSHb3Zs3dPM0eWp6evqEFqalO9txYZpWIpiiCHEu6plPr0zb0pxvoQtOg35OuX0X4FeO9+meXvE07WmtPW3KJKB9RhNb8QWEVwH+oNFQDQEPrKPfxT51/5mmvpP3uCtVqlSpkslJvwD4sB37/slROAAAAABJRU5ErkJggg==",Bs={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},Us=c("img",{class:"w-4 h-4",src:Qe},null,-1),Ms=[Us],Ts={key:0,class:"flex flex-wrap gap-2 mt-1"},Os=["onClick"],Ls={class:"overflow-ellipsis overflow-hidden whitespace-nowrap"},Qs=["onClick"],_s={class:"bg-gray-100 divide-y rounded"},Vs={class:"grid grid-cols-6 gap-3 p-3"},Ks=["onClick"],Ns={class:"flex items-center justify-center p-3 gap-3"},Ps=["placeholder"],Ds=["placeholder"],Gs=["disabled"],Ys=O({__name:"TagsModal",props:{roomId:{}},setup(t){const e=t,a=Be(),s=Y(),o=U([]),n=U({}),r=U([]),i=U({}),u=U(""),d=U("#60a5fa"),p=["#f43f5e","#f97316","#f59e0b","#84cc16","#10b981","#06b6d4","#0ea5e9","#6366f1","#8b5cf6","#6b7280","#64748B","#78716c"],g=S=>{s.dispatch("imkit/updateRoomPrefs",{roomId:S,prefs:{tags:o.value,tagColors:n.value}})},f=s.state.imkit.rooms[e.roomId];f.pref&&(o.value=[...f.pref.tags],r.value=[...f.pref.tags],n.value={...f.pref.tagColors},i.value={...f.pref.tagColors});const x=()=>{u.value&&(o.value.length>=5||(o.value.includes(u.value)||o.value.push(u.value),d.value.startsWith("#")&&(n.value[u.value]=d.value,u.value="")))},B=S=>{o.value=o.value.filter(k=>k!==S),delete n.value[S]},K=S=>{u.value=S,d.value=n.value[S]},T=()=>{d.value=d.value.replace(/[^#0-9a-fA-F]/g,""),d.value.charAt(0)!=="#"&&(d.value="#"+d.value)};return(S,k)=>(l(),G(I(Ue),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 max-w-360px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:se(()=>[c("div",Bs,[ae(v(S.$t("tag"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:k[0]||(k[0]=A=>I(a).closeAll())},Ms)]),o.value.length>0?(l(),m("div",Ts,[(l(!0),m(V,null,Z(o.value,A=>(l(),m("div",{key:A,class:"bg-blue-400 text-white text-base px-2 py-1 rounded-md flex items-center justify-center gap-1 cursor-pointer overflow-hidden",style:X({backgroundColor:n.value[A]}),onClick:b=>K(A)},[c("div",Ls,v(A),1),c("img",{width:"16",height:"16",src:Ss,onClick:ne(b=>B(A),["stop"])},null,8,Qs)],12,Os))),128))])):C("",!0),c("div",_s,[c("div",Vs,[(l(),m(V,null,Z(p,A=>c("div",{key:A,class:"w-10 h-10 rounded",style:X({backgroundColor:A}),onClick:b=>d.value=A},null,12,Ks)),64))]),c("div",Ns,[$(c("input",{type:"text",class:"rounded-md p-2 text-base text-white placeholder-white outline-none w-32 flex-grow",style:X({backgroundColor:d.value}),placeholder:S.$t("inputTag"),"onUpdate:modelValue":k[1]||(k[1]=A=>u.value=A)},null,12,Ps),[[Ee,u.value]]),$(c("input",{type:"text",class:"rounded-md p-2 text-base outline-none w-32 flex-grow",placeholder:S.$t("inputTagPlaceholder"),maxlength:"7",pattern:"^#[0-9a-fA-F]{6}$","onUpdate:modelValue":k[2]||(k[2]=A=>d.value=A),onInput:T},null,40,Ds),[[Ee,d.value]]),c("img",{class:_(["cursor-pointer",{"opacity-20 cursor-not-allowed":!u.value||o.value.length>=5}]),width:"30",height:"30",src:Fs,onClick:x},null,2)])]),c("button",{class:"text-base rounded-lg flex-grow bg-blue-400 text-white h-10 disabled:bg-blue-200 disabled:cursor-not-allowed",disabled:JSON.stringify([...o.value].sort())===JSON.stringify([...r.value].sort())&&JSON.stringify([...Object.values(n.value)].sort())===JSON.stringify([...Object.values(i.value)].sort()),onClick:k[3]||(k[3]=()=>{g(S.roomId),I(a).closeAll()})},v(S.$t("confirm")),9,Gs)]),_:1}))}}),pt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR4nO2asUrEQBCGp7PxEbSx8VnEFzG7Bp05sJ05rS18jDsEX8Pn8CxV9ArbkVVEUEJyJrhZ838wXYr92ORLM0QAAAAAGBWVXOwG0evIuo5i3mUC2yqwXYag21SerD12Ff0xrLd1fbVFpRDSzf5W9vO2xZRKIW7wGjcL62t1qntUArGnbPZhXQe2m6OT8/1pCH+JP6UeTUf449NaTkzYXiYlHMUcwgCA/0U1mx9G0fvif0lsq+PZ/KBVOD2Y+7CDDetdq3D2Qw48BOFv5L4R3LDglXZ8w4JoOSrdRO6qotKCSjsqLai0o9JN5K4qKi2otKPSgko7Kt1E7qqi0oJKOyotfSrN/ZdaRjOsz63CaSEk+0GHm0WrcNp+SQshIzhsrwmiD/WZ7tAGq4fLtCNRnuj7mRedZQEAAABAf8UbgvvRyv0JTvIAAAAASUVORK5CYII=",Xs={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},js=c("img",{class:"w-4 h-4",src:Qe},null,-1),Ws=[js],zs=["onClick"],Js=c("img",{width:"30",height:"30",src:pt},null,-1),Hs=O({__name:"AddToFolderModal",props:{roomId:{}},setup(t){const e=t,a=Be(),s=Y(),o=h(()=>s.state.imkit.sortedFolderIds.map(r=>s.state.imkit.folders[r]).filter(r=>r)),n=r=>{e.roomId&&s.dispatch("imkit/addRoomToFolder",{roomId:e.roomId,folderId:r})};return(r,i)=>(l(),G(I(Ue),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 w-360px relative max-h-80vh overflow-y-auto","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:se(()=>[c("div",Xs,[ae(v(r.$t("addToFolder"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:i[0]||(i[0]=u=>I(a).closeAll())},Ws)]),(l(!0),m(V,null,Z(o.value,u=>(l(),m("div",{key:u.id,class:"flex items-center p-2 gap-3 cursor-pointer rounded-lg bg-slate-200 relative group",onClick:()=>{n(u.id),I(a).closeAll()}},[Js,ae(" "+v(u.name),1)],8,zs))),128))]),_:1}))}});var oe=(t=>(t.RoomName="roomName",t.RoomMember="roomMember",t.RoomPrefTags="roomPrefTags",t.RoomPrefFolder="roomPrefFolder",t.RoomTags="roomTags",t))(oe||{});const Zs={class:"flex items-center justify-center gap-1.5"},qs={key:0,class:"bg-slate-500 w-1 h-10 rounded-full ml-2 flex-shrink-0"},$s={class:"h-50px w-50px relative flex-shrink-0"},eo={key:2,class:"absolute h-5 w-5 -right-1 -bottom-1 bg-slate-200 rounded-lg p-3px",src:gt},to={class:"flex flex-col flex-grow text-left w-0 min-w-0"},so={class:"flex justify-between"},oo=["innerHTML"],ao={class:"text-xs text-gray-500 whitespace-nowrap"},no=["innerHTML"],ro={key:0,class:"text-xs font-600 bg-blue-400 text-white rounded-full px-1.5 pt-0.5 h-5 min-w-5 text-center leading-none flex items-center justify-center"},io={key:0,class:"flex flex-wrap gap-1 mt-1"},lo=["onClick"],co=c("img",{width:"20",height:"20",src:bs},null,-1),uo=[co],mo={key:0,class:"absolute right-3 top-[calc(50%_+_28px)] p-1.5 bg-white z-10 rounded-lg shadow-md flex flex-col items-stretch gap-1"},go=["onClick"],po=c("img",{width:"24",height:"24",src:xs},null,-1),Ao=["onClick"],ho=c("img",{width:"24",height:"24",src:gt},null,-1),fo=["onClick"],vo=c("img",{width:"24",height:"24",src:Cs},null,-1),ko=["onClick"],yo=c("img",{width:"24",height:"24",src:Is},null,-1),wo=O({__name:"RoomCell",props:{source:{}},setup(t){const e=t;W.extend(Ge),W.extend(nt);const a=h(()=>{let A=W(e.source.updatedAt);return A.isSame(W(),"day")?A.format("H:mm"):A.isYesterday()?"Yesterday":A.isSame(W(),"week")?A.format("dddd"):A.isSame(W(),"year")?A.format("MMM D"):A.format("ll")}),s=Y(),o=h(()=>s.state.imkit.rooms[e.source.id]),n=h(()=>s.state.imkit.searchKeyword.length>0&&s.state.imkit.searchType===oe.RoomName?o.value.displayName.replaceAll(s.state.imkit.searchKeyword,`<span class="text-blue-400">${s.state.imkit.searchKeyword}</span>`):o.value.displayName),r=h(()=>{var A;return s.state.imkit.searchKeyword.length>0&&s.state.imkit.searchType===oe.RoomMember?[`<span class="text-blue-400">${s.state.imkit.searchKeyword}</span>`,...o.value.memberIds.map(b=>s.state.imkit.users[b]).filter(b=>b).map(b=>b.nickname||b.id).filter(b=>b!==s.state.imkit.searchKeyword)].join(", "):(A=o.value.lastMessage)==null?void 0:A.string}),i=h(()=>s.state.imkit.selectedRoomId===e.source.id),u=h(()=>!!s.state.imkit.roomIdsInFolders[e.source.id]),d=h(()=>s.state.imkit.actionMenuRoomId),p=h(()=>s.state.imkit.searchKeyword),g=h(()=>{var A;return((A=o.value.pref)==null?void 0:A.sticky)??!1}),f=h(()=>s.state.imkit.sortedFolderIds),x=()=>{const{open:A}=xe({component:Ys,attrs:{roomId:e.source.id}});A(),s.commit("imkit/setState",{actionMenuRoomId:""})},B=()=>{d.value===e.source.id?s.commit("imkit/setState",{actionMenuRoomId:""}):s.commit("imkit/setState",{actionMenuRoomId:e.source.id})},K=()=>{s.commit("imkit/setState",{selectedRoomId:e.source.id,actionMenuRoomId:""})},T=async()=>{await s.dispatch("imkit/updateRoomPrefs",{roomId:e.source.id,prefs:{sticky:!g.value}})},S=async()=>{await s.dispatch("imkit/removeRoomFromFolder",e.source.id)},k=async()=>{const{open:A}=xe({component:Hs,attrs:{roomId:e.source.id}});A()};return(A,b)=>{var L,P;const F=he("click-outside");return l(),m("div",Zs,[u.value&&!p.value?(l(),m("div",qs)):C("",!0),c("div",{class:_(["flex items-center p-2 gap-3 cursor-pointer rounded-lg min-h-66px flex-grow group sm:hover:bg-gray-100 relative",{"bg-gray-100":i.value}]),onClick:K},[c("div",$s,[o.value.avatars.length===1?(l(),G(ee,{key:0,url:o.value.avatars[0].url,name:o.value.avatars[0].name,class:"relative"},null,8,["url","name"])):(l(),m(V,{key:1},[D(ee,{url:o.value.avatars[1].url,name:o.value.avatars[1].name,class:"h-36px w-36px text-16px absolute top-0 right-0"},null,8,["url","name"]),D(ee,{url:o.value.avatars[0].url,name:o.value.avatars[0].name,class:_(["h-38px w-38px text-16px absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100",{"border-gray-100":i.value}])},null,8,["url","name","class"])],64)),g.value?(l(),m("img",eo)):C("",!0)]),c("div",to,[c("div",so,[c("div",{class:"text-base text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap",innerHTML:n.value},null,8,oo),c("div",ao,v(a.value),1)]),c("div",{class:_(["flex items-center justify-between",{"text-gray-800":o.value.numberOfUnread>0}])},[c("div",{class:"text-sm text-gray-500 overflow-ellipsis overflow-hidden whitespace-nowrap",innerHTML:r.value},null,8,no),o.value.numberOfUnread>0&&!i.value?(l(),m("div",ro,v(o.value.numberOfUnread>99?"99+":o.value.numberOfUnread),1)):C("",!0)],2),(L=o.value.pref)!=null&&L.tags?(l(),m("div",io,[(l(!0),m(V,null,Z(((P=o.value.pref)==null?void 0:P.tags)??[],J=>{var te;return l(),m("div",{key:J,class:"bg-blue-400 text-white text-xs px-1 py-0.5 rounded-md overflow-ellipsis overflow-hidden whitespace-nowrap",style:X({backgroundColor:(((te=o.value.pref)==null?void 0:te.tagColors)||{})[J]})},v(J),5)}),128))])):C("",!0)]),c("div",{class:_(["absolute right-4 w-10 h-10 rounded-full bg-white shadow-md items-center justify-center hidden group-hover:flex hover:scale-110 hover:transform hover:transition",{"!flex":d.value==A.source.id}]),onClick:ne(B,["stop"])},uo,10,lo),d.value==A.source.id?$((l(),m("div",mo,[c("div",{class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:ne(x,["stop"])},[po,ae(" "+v(A.$t("tag")),1)],8,go),c("div",{class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:ne(T,["stop"])},[ho,ae(" "+v(g.value?A.$t("unpin"):A.$t("pin")),1)],8,Ao),u.value?(l(),m("div",{key:0,class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:ne(S,["stop"])},[vo,ae(" "+v(A.$t("removeFromFolder")),1)],8,fo)):f.value.length>0?(l(),m("div",{key:1,class:"flex gap-2 text-gray-800 text-base cursor-pointer hover:bg-gray-100 p-2 rounded",onClick:ne(k,["stop"])},[yo,ae(" "+v(A.$t("addToFolder")),1)],8,ko)):C("",!0)])),[[F,()=>{I(s).commit("imkit/setState",{actionMenuRoomId:""})}]]):C("",!0)],2)])}}}),bo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB60lEQVR4nO2Zzy4EQRCH2wUHJ3F1IeLIwZ9n4B1wE9u9i6rhXLWLo+DGKwiReAESBw/AGxAnJEhcSFZmiUhmd3uYpvVMfcnvXl9qZnp+M0oJgiAIgvAvKeFav0Y6MECPBrmeJhr4SgNvak09KjxZvksrmhBHPq9UdrpUKOh4sz+U/SJNKhTMNy7j1sL0XFqmARUCJqPsnwfoUQMfLSzVhoshjJ/i9/HzpzjC2LiV9gsmzA+FEjbIdRG24XtDsmGUS7ou9zBmeGgJghAWRNRpkHfil2/fZ6izAN1roO3YLSHckPU94C9FI28lhfO02YQw3RZMmO+aCPNhjjd8kBAuAc3mVjjimYQwAPVq4Bffw7kPvc4j9TU9mgzSae62C3zS8iw2SJg74YihpXBlZW3Q94Cus7haG2op/LHlS99DOgvwRVvZhjDwhvdBHUUDrVuFdVSd9D2oq5SBJqzCSqkOg3Tte9jsoZvYJY2w0sB7ORDeTSX7LkzT/gfOlnJUnUotHP/IdvG71GOe5oi61XcIuUw0LQs2Qi4TTcuCjXDLRJuyYCPEMtG2LNgIsUy0LQs2QiwT1rJgwwCf+ZZIHeAzlZVSVB2PzzXvMvY8mWUaUy7QSzRqkI7/5ZfNxkx0XIbaiBNZQRAEQRDUb/EGC4sae12sFiYAAAAASUVORK5CYII=",xo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVR4nO3UQU7CUBSF4bcQGbsVYeAajO90A9wHa5B32YhO3BEkRgYkxggbgDTRxBGa0Nse5XzJnXXQk79pSiIicsGa6fIW5hsUP5w88037bPrrcqnbH8d+XvtsYpFni0k2X//25fu69p0a83Hng1Hqy9DjTnwZrxp8rsZ8nEtdEdZd5VJvzh4oIv8TCH5U30+DuwaCqiocCQRVVTgSCKqqcCQQVFXhSCCoqsKRQFBVhSOBoKoKRwJBVRWOBIKqKhwJBFVVOBIIqqpwJBBUVeFIIKiqwpFAUFWFI4GgqgpHgvl+6Kpfl80/4geX+kwzuNTH8MH3s8V1Nn8feizM3zB/uEp9uJsuRzB/Qqm7/sfWXVu2t7EiIiKSunIEhOq3p0W+CNEAAAAASUVORK5CYII=",Co="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAADaUlEQVR4nO2aS2gTURSG4/sBilZxI1grghtBaF0VxKXgq6uKgiiIpJ17k2bOGUVX/neS4mPhQtSFuhUXxZVEW3HlxlU3uqgKrlTEF/jAR+ujlZvpxFaCySQzmUkyB84mZM78H+e/987cuYlEHHHE0TJxGFicsnIdhpXtikJqLVqT76DCtHsEYUSQmpCspqKUgjEuWQ0bpr2nZlApT68SrO6FDVUxPGGECG3Vw5J6GjaEd2j1uCpo0UCdLZHD3mBNuycComtKT2NasrobtuBaUxDuVASrp/kozsaegRnjABaWBTZMbAhbrF/Zl8H68nY20Rm2UN/SRGf5DlvZrtCF+pSGle2Kgf+NuMMcvjVjS3MLjGHBeG+QvV0SRpseWDDGU6a9Tes7cvzcMsl41dTABuGQq08STjV1hwVh0NWWYrtXMiabFlgwbgKYW+isia2S1VdPzrAaCZgwmkxiqdYkrFy7YLz2WsNoHGC87KPBtcVJitTDauoYDQFM+Jyi7Batpbd3aJ5k3Kq2lhF1YEHqt2TsdbVIVhdrqWcEBSxYffIJOuPqEIRUrfWMIIAF421/JrtJkjrhZcko0d1rfztr7xCkfkYUWB0oCjXR79jSKyxGAMzXNfotbPbLMUZAwB8MRncRmrBfMn5UXgNjmQxW6GuTjNWC8MwP2MCApdOhL9qGbg1B2CkY38peS+qdIGwsbh4yHvgFGyiwdMbghH70c+voh31J+Pgf2O8znDFHEq77CRs4sHTs+Usyjs7aECT1psT/JlOEg0VHsLL9hq0TsCrASMYxt54zg+P57O5CFWFN7Ktldo8AsHIszjjr1hwYwDrJeDL9+5C2cOFejG5t7SBg6w4sncnskvu2029hjWRcdT9g64/Zeg0PCjYUYOnY90YyeWXBzHuk01guGI+ChA0PmAvQeaLzS4ovBIR80LDhAnNhGbqvOytZXa4HbPjAXFirX9QLNhLAss5pxMAlIu4wN7mlZat9EE9ZuY7QhfqUwsq1lwVOpy8smj7ON9XQSep7RYdaCrZmNdz4wMgnKg19qCt0wTWmYdm7El5Cb6y1RHfd0Ac09UHN0MV7TowZJ8+sTFQTRGhrqPFMyFcNOzMkY7c+uxjJ2dvZMbntecxWEnrJ0sf5wj7676bWojVVJD6OOOJINEP8AR99+lKlJ3IWAAAAAElFTkSuQmCC",Io="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR4nO2aTU4CQRCFm5W6N7jSiEeAgxjkAO6UmQakaw5QPRCXLlzCRVRAEzd6CfUSSoIrTfET40wbZpA4hdSX1LI7703PvCbhKSUIwtpgzMWW18QDL2iVOEwtaBdI07J95rQJK77Bnm/suwb7wWmmmm60Ccuk9VdOG43zHW3sfdamkg/eVQPML2zWN/iSvYnU87yI6dxqnWz8pFO93tqEFddGvsE3H2xfA3Z9YztZzlgD2D5pcpqefNPJoICKmQV88KC9q5hBmkib43CuE21wjLjpSONXjmZnNBq4Fz1p8lCvX27MXUz3rONp9RRztMFBVHctaBfmL2xi0RECXcUc0hjT3cTi3IX0CyZ+wrajmDMJsu+6vaBVmrtQDIOcMEvklQb5ht1IaIGEFksktEBCy42EFkhosURCCyS03EhogYQWSyS0QELLjYQWSGixREILJLTcSGiBhBZLJLRAQsvN2oWWXrc/xGtBuxAvtNi+Yo5v7G1U9+kZ7q9PqQVwlKjUQoy7i47aEm2sOJoF++joal0l3sQL8OiHlttw0pbhUUybNneGzhJdMzxM8+ByVN9bfiXwj8bgIPWrUg0wT0XNzMWnHN/g0wngdmrDX6ZX6KQNDhY2GymIl6m7yLIgDjiigEr7zSaCriy627Ku/s+GtCS+egRBUP+BT4sLtV3SLOLeAAAAAElFTkSuQmCC",Ro={key:0,width:"20",height:"20",src:Co},Eo={key:1,width:"20",height:"20",src:Io},So={key:3,class:"h-40px w-40px relative flex-shrink-0"},Fo={class:"flex flex-col flex-grow text-left w-0 min-w-0"},Bo={class:"flex justify-between"},Uo={class:"text-sm text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap"},Mo={class:"text-xs text-gray-500 whitespace-nowrap"},To={class:"text-xs text-gray-500 overflow-ellipsis overflow-hidden whitespace-nowrap"},Oo={key:0,class:"text-xs font-600 bg-blue-400 text-white rounded-full px-1.5 pt-0.5 h-5 min-w-5 text-center leading-none flex items-center justify-center"},Lo=O({__name:"RoomCell",props:{source:{}},setup(t){const e=t;W.extend(Ge),W.extend(nt);const a=h(()=>{let r=W(e.source.updatedAt);return r.isSame(W(),"day")?r.format("H:mm"):r.isYesterday()?"Yesterday":r.isSame(W(),"week")?r.format("dddd"):r.isSame(W(),"year")?r.format("MMM D"):r.format("ll")}),s=Y(),o=h(()=>s.state.imkit.selectedRoomIdsForCreateFolder[e.source.id]),n=r=>{s.commit("imkit/updateField",{key:"selectedRoomIdsForCreateFolder",value:{[e.source.id]:r}})};return(r,i)=>{var u;return l(),m("div",{class:_(["flex items-center p-1 px-2 gap-2 cursor-pointer rounded-lg min-h-44px w-full group sm:hover:bg-gray-100 relative",{"bg-gray-100":o.value}]),onClick:i[0]||(i[0]=d=>n(!o.value))},[o.value?(l(),m("img",Ro)):(l(),m("img",Eo)),r.source.avatars.length===1?(l(),G(ee,{key:2,url:r.source.avatars[0].url,name:r.source.avatars[0].name,class:"h-34px w-34px rounded-lg text-base flex-shrink-0"},null,8,["url","name"])):(l(),m("div",So,[D(ee,{url:r.source.avatars[1].url,name:r.source.avatars[1].name,class:"h-32px w-32px text-16px absolute top-0 right-0 rounded-lg"},null,8,["url","name"]),D(ee,{url:r.source.avatars[0].url,name:r.source.avatars[0].name,class:"h-34px w-34px text-base absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100 rounded-lg"},null,8,["url","name"])])),c("div",Fo,[c("div",Bo,[c("div",Uo,v(r.source.displayName),1),c("div",Mo,v(a.value),1)]),c("div",{class:_(["flex items-center justify-between",{"text-gray-800":r.source.numberOfUnread>0}])},[c("div",To,v((u=r.source.lastMessage)==null?void 0:u.string),1),r.source.numberOfUnread>0?(l(),m("div",Oo,v(r.source.numberOfUnread>99?"99+":r.source.numberOfUnread),1)):C("",!0)],2)])],2)}}}),Qo={class:"text-xl font-500 text-gray-700 flex items-center justify-between mb-1"},_o=c("img",{class:"w-4 h-4",src:Qe},null,-1),Vo=[_o],Ko=["placeholder"],No=["disabled"],At=O({__name:"UpdateFolderModal",props:{folderId:{}},setup(t){const e=t,a=Be(),s=Y(),o=U(),n=U(""),r=h(()=>o.value?o.value.roomIds.map(d=>s.state.imkit.rooms[d]).concat(s.state.imkit.sortedRooms).sort((d,p)=>{var g,f,x;return((g=d.pref)==null?void 0:g.sticky)===((f=p.pref)==null?void 0:f.sticky)?p.updatedAt-d.updatedAt:(x=d.pref)!=null&&x.sticky?-1:1}):s.state.imkit.sortedRooms),i=h(()=>n.value.length>0&&Object.keys(s.state.imkit.selectedRoomIdsForCreateFolder).length>0),u=()=>{var d;s.dispatch("imkit/updateFolder",{folderKey:((d=o.value)==null?void 0:d.id)||`folder_${Date.now()}`,name:n.value})};return o.value=s.state.imkit.folders[e.folderId],o.value&&(n.value=o.value.name,s.commit("imkit/setState",{selectedRoomIdsForCreateFolder:o.value.roomIds.reduce((d,p)=>(d[p]=!0,d),{})})),(d,p)=>(l(),G(I(Ue),{class:"flex items-center justify-center","content-class":"bg-white rounded-xl p-5 flex flex-col gap-3 w-360px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:se(()=>[c("div",Qo,[ae(v(o.value?d.$t("editFolder"):d.$t("createFolder"))+" ",1),c("button",{class:"flex items-center justify-center bg-gray-200 rounded-full w-7 h-7",onClick:p[0]||(p[0]=g=>I(a).closeAll())},Vo)]),$(c("input",{type:"text",class:"bg-gray-100 flex-grow outline-none p-2 rounded-md",placeholder:d.$t("folderName"),"onUpdate:modelValue":p[1]||(p[1]=g=>n.value=g)},null,8,Ko),[[Ee,n.value]]),D(I(Ye),{class:"h-50vh overflow-auto","data-key":"id","data-sources":r.value,"data-component":Lo,"wrap-class":"flex flex-col gap-1.5","estimated-size":44},null,8,["data-sources"]),c("button",{class:_(["h-10 text-base rounded-lg flex-grow bg-blue-400 text-white",{"!bg-gray-400 cursor-not-allowed":!i.value}]),disabled:!i.value,onClick:p[2]||(p[2]=()=>{u(),I(a).closeAll()})},v(d.$t("confirm")),11,No)]),_:1}))}}),Po={key:0,width:"30",height:"30",src:bo},Do={key:1,width:"30",height:"30",src:pt},Go={class:"flex flex-col overflow-hidden"},Yo=["innerHTML"],Xo={class:"text-sm text-gray-500 overflow-ellipsis overflow-hidden whitespace-nowrap"},jo={key:2,class:"ml-auto text-xs font-600 bg-blue-400 text-white rounded-full h-5 min-w-5 text-center leading-none flex items-center justify-center"},Wo=["onClick"],zo=c("img",{width:"20",height:"20",src:"https://img.icons8.com/ios-glyphs/30/637289/pencil--v1.png"},null,-1),Jo=[zo],Ho=["onClick"],Zo=c("img",{width:"20",height:"20",src:xo},null,-1),qo=[Zo],$o=O({__name:"FolderCell",props:{source:{}},setup(t){const e=t,a=Y(),s=h(()=>a.state.imkit.searchKeyword.length>0&&a.state.imkit.searchType===oe.RoomPrefFolder?e.source.name.replaceAll(a.state.imkit.searchKeyword,`<span class="text-blue-400">${a.state.imkit.searchKeyword}</span>`):e.source.name),o=h(()=>a.state.imkit.selectedFolderId),n=h(()=>e.source.roomIds.filter(d=>a.state.imkit.selectedRoomId!==d).reduce((d,p)=>{const g=a.state.imkit.rooms[p];return g?d+g.numberOfUnread:d},0)),r=()=>{a.state.imkit.selectedFolderId===e.source.id?a.commit("imkit/setState",{selectedFolderId:""}):a.commit("imkit/setState",{selectedFolderId:e.source.id})},i=()=>{a.dispatch("imkit/removeFolder",e.source.id)},u=()=>{const{open:d}=xe({component:At,attrs:{folderId:e.source.id}});d()};return(d,p)=>(l(),m("div",{class:"flex items-center p-2 gap-3 cursor-pointer rounded-lg min-h-66px bg-slate-200 relative group",onClick:r},[o.value===d.source.id?(l(),m("img",Po)):(l(),m("img",Do)),c("div",Go,[c("div",{class:"text-basse text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap",innerHTML:s.value},null,8,Yo),c("div",Xo,v(d.$t("numberOfChatroom",d.source.roomIds.length)),1)]),n.value>0?(l(),m("div",jo,v(n.value),1)):C("",!0),c("div",{class:"absolute right-14 w-8 h-8 rounded-full bg-white shadow-md items-center justify-center hidden group-hover:flex hover:scale-110 hover:transform hover:transition !hover:flex",onClick:ne(u,["stop"])},Jo,8,Wo),c("div",{class:"absolute right-4 w-8 h-8 rounded-full bg-white shadow-md items-center justify-center hidden group-hover:flex hover:scale-110 hover:transform hover:transition !hover:flex",onClick:ne(i,["stop"])},qo,8,Ho)]))}}),ea=O({__name:"RoomListWrapperCell",props:{source:{}},setup(t){return(e,a)=>e.source instanceof I(Re)?(l(),G(wo,{key:0,source:e.source},null,8,["source"])):(l(),G($o,{key:1,source:e.source},null,8,["source"]))}});var ue=(t=>(t.FetchRooms="/rooms",t.SearchRooms="/search",t.Subscribe="/me/subscribe",t.Unsubscribe="/me/unsubscribe",t))(ue||{});const _e=t=>(fe("data-v-c2570c57"),t=t(),ve(),t),ta={class:"overflow-auto relative"},sa={class:"flex items-center bg-gray-100 rounded-lg h-12 mb-2 w-full p-3 gap-2"},oa=_e(()=>c("img",{class:"w-6 h-6 cursor-pointer",src:gs},null,-1)),aa=["placeholder"],na={key:0,class:"flex items-center gap-2 overflow-auto text-sm text-gray-900 mb-2"},ra=["onClick"],ia={key:1,slot:"header",class:"flex flex-col gap-1"},la=_e(()=>c("div",{class:"loading rounded-2xl w-50px h-50px"},null,-1)),ca=_e(()=>c("div",{class:"flex-grow flex flex-col justify-center gap-2"},[c("div",{class:"loading h-5 rounded-md w-full"}),c("div",{class:"loading h-4 rounded-md w-4/5"})],-1)),da=[la,ca],ua=_e(()=>c("img",{width:"30",height:"30",src:ps},null,-1)),ma=[ua],ga=O({__name:"RoomList",setup(t){const e=Y(),a=U(""),s=U(!1),o=U(),n=h(()=>e.state.imkit.sortedRooms),r=h(()=>e.state.imkit.sortedFolderIds.map(A=>e.state.imkit.folders[A]).filter(A=>A)),i=h(()=>e.state.imkit.folders[e.state.imkit.selectedFolderId]),u=h(()=>e.state.imkit.searchType),d=h(()=>e.state.imkit.searchKeyword?Object.keys(e.state.imkit.searchRooms):[]),p=h(()=>{if(e.state.imkit.searchKeyword){if(u.value===oe.RoomPrefFolder&&i.value){const b=[...e.state.imkit.searchRooms[u.value]],F=i.value.roomIds.map(P=>e.state.imkit.rooms[P]).filter(P=>P),L=b.findIndex(P=>P.id===i.value.id);return L>-1&&b.splice(L+1,0,...F),b}return e.state.imkit.searchRooms[u.value]||[]}const A=[...r.value,...n.value];if(i.value){const b=i.value.roomIds.map(L=>e.state.imkit.rooms[L]).filter(L=>L).sort((L,P)=>{var J,te,ie;return((J=L.pref)==null?void 0:J.sticky)===((te=P.pref)==null?void 0:te.sticky)?P.updatedAt-L.updatedAt:(ie=L.pref)!=null&&ie.sticky?-1:1}),F=r.value.findIndex(L=>L.id===i.value.id);F>-1&&A.splice(F+1,0,...b)}return A}),g=U(!1),f=h(()=>s.value||g.value||!!e.state.imkit.isRequesting[ue.SearchRooms]),x=()=>{e.dispatch("imkit/fetchRooms")},B=()=>{const{open:A}=xe({component:At});A()},T=rt(1e3,async()=>{a.value!==e.state.imkit.searchKeyword&&(a.value?e.dispatch("imkit/searchRooms",a.value):(e.commit("imkit/setState",{sortedRooms:[],numberOfFetchedRooms:0,numberOfTotalRooms:0,folders:{},sortedFolderIds:[],roomIdsInFolders:{},searchKeyword:""}),k()))}),S=Gt(500,T,{atBegin:!1});me(a,S),me(n,A=>{if(!e.state.imkit.selectedRoomId&&document.body.clientWidth>640){const b=Object.values(A).find(F=>F.numberOfUnread===0);b&&e.commit("imkit/setState",{selectedRoomId:b.id})}});const k=async()=>{g.value=!0,await e.dispatch("imkit/fetchPrefs"),await e.dispatch("imkit/fetchRooms"),g.value=!1,await e.dispatch("imkit/fetchRoomsInFolders")};return k(),(A,b)=>(l(),m("div",ta,[D(I(Ye),{class:"p-2 h-full overflow-auto","data-key":"id","data-sources":p.value,"data-component":ea,"wrap-class":"flex flex-col gap-1.5","estimated-size":66,keeps:60,onTobottom:x},{header:se(()=>[c("div",sa,[oa,$(c("input",{ref_key:"searchInput",ref:o,class:"bg-gray-100 outline-none flex-grow","onUpdate:modelValue":b[0]||(b[0]=F=>a.value=F),placeholder:A.$t("search"),onCompositionstart:b[1]||(b[1]=F=>s.value=!0),onCompositionend:b[2]||(b[2]=F=>s.value=!1)},null,40,aa),[[Ee,a.value]]),a.value?(l(),m("img",{key:0,src:ut,class:"w-5 h-5 cursor-pointer",onClick:b[3]||(b[3]=()=>{I(S).cancel({upcomingOnly:!0}),a.value="",I(T)()})})):C("",!0)]),d.value.length>0?(l(),m("div",na,[(l(!0),m(V,null,Z(d.value,F=>(l(),m("div",{key:F,class:_(["rounded-lg p-2 whitespace-nowrap cursor-pointer hover:bg-gray-100",{"bg-gray-100 text-gray-800 font-medium":F===u.value}]),onClick:L=>I(e).commit("imkit/setState",{searchType:F})},v(A.$t(F)),11,ra))),128))])):C("",!0),f.value?(l(),m("div",ia,[(l(),m(V,null,Z(20,F=>c("div",{key:F,class:"p-2 flex gap-3"},da)),64))])):C("",!0)]),_:1},8,["data-sources"]),c("button",{class:"absolute rounded-full bg-white right-3 bottom-3 shadow-md w-14 h-14 flex items-center justify-center cursor-pointer",onClick:B},ma)]))}});const re=(t,e)=>{const a=t.__vccOpts||t;for(const[s,o]of e)a[s]=o;return a},pa=re(ga,[["__scopeId","data-v-c2570c57"]]),Aa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKklEQVR4nO3aP0oEMRSA8SfiFl7CPu1AgpV51ovmLeQK9v45gF7Aq6jXEO/gegy1WBlhQZHNvEJQNt8P0kw1fMyEhEQEAAAAAAAAALCtaq27Ue0qqT19jry4HJ/99Xv9C6HWWVK7T2qrbyOXW+ldqHUWc3n4EUdtFdXeh/l8X3oVGnHW41AXB9Kj4IgT1Z5FZEd6ExxxUi6vUe1YOp2Q7ybjHJ0W6U0gzmbEaSBOA3EaiNNAnAbiNAzD2Z5nEZjUTqRHSe2GOA0plxdWyA0xl+XmL6i8dbmF+CqpXfOLNTBJOyNN7th7/90GIk0jkgORHIjkQCQHIjkQyYFjn986OMxl2eXB4RpHzw5cXnDg+ovDeFkq5XKRcnkcR1Q75wIVAAAAAAAAAMg2+AByUSBd2KYVoQAAAABJRU5ErkJggg==",ha="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEu0lEQVR4nO1ay48UZRD/Dj4SvPhOfN8XhUMz9Q1msKvGXV3jZKdq1uEmGiGrf4D4CJpwQPSG4CMkxoT4inrdEF83FaJnjAYJCXBSFr3IgdVdMNW9RNmume3tx0xvmF/yJZ3Mbn3166+6qr6qcm6EEUYYYYQYwXj3Xh+2n/bEbwPy10ByAkj+9MR/69JnIP5Vf9O/qSE/tWlL+x63lrCZOvd54leA+BdPcinLApKfPfIufWGuqqg/1H7AI38AyAtZiSYW8qInmfXEgasK6o90bwbi/UvKXSppXdSXuXlCbh8uWeKt8TdZGtErTR35D4/t6YETDYKZa4H4nRQKLgDKESDZ44k70JwaazQev0n/X5c+12h6vf7miV/zKEfTfBKAfED/fyBkN0xM3ADEX6yg0CkgeT7YInesVv6D41N3AvFOj3x6hT0OB63WOjcAst/3VkJ+A+Jninj7KqMeyg5A/r2PN/+uNNJBbMb9TvbQxrB9Y9H7qtkDyYd9T7oM8waUd3uEjnlNLlzJ0NOO9urxTRe7GfFW26T4r3rYGXcDQg07j3qU8/Zpc6eYTR7mWzzKOetkVQE3YABJE1AuWCGr0ejelnsDT3LIfKMZzNiH3PAoL16xQm5kMm/b4t5zeQAkG6Msx3BQWeR5kt2GrN0ZdUs6MuTFTaHcn0VeBED5zAo96jndkAnH3pvPGqQ/znzrASPr0TibSWDBhGN5PGNld5luWZ7kVUO5M2Pd7nVVIRzlBsinjEN5edXCwLjParrockBDGBC/8f+VN6wBtl8wzPqn1VcqKOkQ6s3uXa5iiHJv69ML5e7UQuKyTMJZHXEVBZD8YFjjttQCPMpbhoA9rqLwKHuN73h/agFA/M1yAbWmiKsoIJQnjFTzy9QCPPLJxBtrTo3lVayoTGs5NNkwLPJEagFRKWWZAK1d5VWs6LB0GUHYutWQO5deMeMalif+lk14cnLyesPJXkiv2NVGGK5Ckz6Z8NI0vb6qhKMmQC6nReWEpbIIFxCWpJTEozTCKK8b+r6ZWoB28ZK5tBytMOEfk4Q7T6YWoC3LJGFeXFVCPiDCeqHJfXlQRC3LZH6601WMcJStJb/fYxkE8a61WgDwxC8VVuKph7KjKoRrTX4umXDwQuYpAiD+1HBe57RWPWzCS33pRBEPiD/KIi+Cb05vsMq0WiJ1QybsUT4xHWveW51Hed9QMpNpF1XTApRnLZ088UFXRJ4KRm6tUzjDaLX4Jj8WTwElc+ci8v0IOmZgvlGU84MkHZG1m2kXAbld6GaAfMAmzfOA7e2FbtbTjM2TVR32Fb5hEMe8w/a3Ezuywkwq2b1MOqj/1mwYhte4MhC0Wut0zKA3aQ0TPFNEsUBlLMXZuZ5kUb4tfc4jUNJ9TvpyRqYdgSyFe82Bl9LFMyvsMVs62WXmbX/Ty+OiFslR9uqdVS/qavZ6err0WWO9/qZXvOjWs/KAmw6p7SvNjPshmq+ypgPKW3OFe+MsTkU776WOHkay+WAZTjEzook6HS4l+adQoiifF9EEKA16U9H+rLYss5PlY3rFW3Oz03WtRpBsixwcylce5Xg8IMrzccKiz3JcC27a/NKyjLY/h633CCOMMIKrCv4FJTQtkqp0FHwAAAAASUVORK5CYII=",fa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVElEQVR4nO2azUrDUBBGhxnvS9SZuhOsBF3bufEp+py1olB/3klt3VgEJaUbqbE0LpJOvgMDWc7HnBvI5BIBAADYwTUd0YSEojNwOtXMT+byWZVmfh5cpUuKyPE4XZjL0rJ8/SiXpZapoGiY8/1W2E2p8x1Fw1ze6wJXU6ZoWF3YTVE0DIEFEw6FQWmB0qEwKC1QOhQGpQVKh8KgtEDp1rFxOtfMt5rlbZeSbVfVozrPhk6jRmG1TMWvO6iuV9MdmTo/tt5802k7P+yXdkKiWVYHGzjLar+996RvgemwlTbneX9eWlkWjRf7Q6eROt+oy0vnNV73yNOTks6oC9iOhikahsCCCYfCoLRA6VAYlBYoHQqD0gKlQ2FQWqB0KNTl9a+Pd4qGOs/qzzFPKRpDp1HNjmzR+G9B19EyFdWSXLN8rKt6jniTdotqZ9yHC+IAAED/5BvYQaHooEGgKAAAAABJRU5ErkJggg==",va="data:image/png;base64,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",ka="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADnklEQVR4nO2a3WoUMRSAT3Nm1RfQ2t1kaqUqtChiFdvdk1mxVnwBwfcQrUUEr8SfG71U36AUFQUvqxa9EsULaX0D0dpWqVCstsppKyxuMtntj/t3Pggss0km+TY5yWYGQBAEQRCEdWIsnjaE943FD4bwOydNOGUs3jMJDkGrks3DAU1qwlj8nZpIvcgS7IdWQlNU1IRzQTlrSVuc1TZKoHVGDlYsp1RSLoF90OwYq55VK6d0ukEzYxIcWrectRQTDkKzYlZXK9f0+aFJXTR5yHKKSQ3zNU/eu9CsGF7KnaNCDZfnVZecgginoFkxhPNOQRY6/s3L19xxCOehWTGeuLJZ+RseI4LSEUEBRFAAERRABAUQQQFEUAARFEAEBRBBAURQABEUQAQFEEEBRFAAERSg5QRpi4uuDvT0wLZqjlz5oL6s7n7IeQ7tv7nq7j4D230PBKBWaIuzrkbtJthZzaE9H9CX51UjnkP7SVfdXceh3TPiZqBWaMJJV6OySTRQ7WOflacYeciujhw1Uu1jn5iigju/eg+1Qlv12NmoRJ135Y8JT/niSqUptnjS05YL7hGnHkGtMBaveho14S1Danz9gtRzX72a1CvPCLoCtSImHHR2hPBX+wDscpXhV1l8sSuQZnQRulPiz5KrXK6AJ6BW9PVBhhvu6dANXzl+laVKSTMmiayvPkN4y/NDfYEiRFBLjC/wEi5kLRhfOX6VpaI3PUiN+0YO01GAmO9VTUD/r2TzmcMpnRsDgLbQNOWOrKyIvE8inOfPfM0XkEtoM1Y98Nx/WSeZg1APGKuepki6vFX35QDsu6+26gnUCznKHOLA7GnskiZ1brPvyXX6ArMh/GkKmV6oJwzhzZRYsqwtXg9Ntwpp49dlvHJW4981qDc6i7DDWPUuEHDH0gJ3CA7IKTHn7x7sLf8vg3okttBlCKfTO4ALPNp471JpvSv7HMJbvtWqZGpNdxZhD9QzJh8d1YRfK9jbLGmrXvJfhNhGeZbApwCc+DNf4+84T9p0KhE/F9vMEWgEdBId0xY/VbER3FDShB9jyvRBIxET7NWk3my5HKte1/208sHBklcv38HaxsTgIq9WvsO5hiIm6DFWPeTlfhPkLPNKxnVCs2EKmV5t8U5opfOkz5rwdlOKKeMsYK4Q9fMporY4mjKNRjkP5+Uy0KoYj6Bat6tuMCIoHREUQAQFEEEBRFAAERRABAUQQYIgCIIgCAI0Gn8ADIaRj4Vk+wwAAAAASUVORK5CYII=",ya="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAADnElEQVR4nM2ZX0hTYRTA1z8o6KEiooiiCCEqiCDqxTLopR6Dbnf3nO/u7l8XSvLBhx58UZo+JEEYmUYDzQ3MhCDC6bb2FqSNVIikt0gTaTMlMPpj+cU37/Squ/d+d5uuAwf2sLPz4/z7vu/M4ShQBEHYAADbZVneL0nSYUmSylwu115FUbY51lIkSdqJiJcB4C4ixhHxIwD8RERqpgAwAwAfEPEFANwihFwQBGFLUaBqa2vXI+IlDWjWCgY5lUEjYich5HQhETsFAMPFgkJj2OeiKO6zBQcAPgD4vdpwuKhTiHiOCw4Rr68hGNVF8ockSeVWaS1HxD+lAMR5TRNCduWEq6io2AgAIyWEo1okQ0Z1J5caDucB/yLikVy1N1BqOFyEvLcEThTFA4g4Z2VYV1dHn3Z306amJkoI4Xbodrvpo2CQPunqotXV1TyAE+yE0qdXtTIK1NfTVDpN05OTGY3H49Tlclk6U1WVDg0PL9h9Hh+nN6qqLO0IIcf16W2zMujp6VlwwgupLoPLamtrqyWgJEnX9ICDVgZt7e0rHKVNII3gmAYCAZ7SeKBP8TeeOnqTTHJBqiZwLBOctRvPwAmCsJW32D0eD33d35/TcSKRyED6/X46ODSU8zvRWIzKsszbySPZ9O7hBWTq8/kMI/kykTCOXCRiq/MRcTR7vJXZAcxGsn9gICdIoZHTRXA6A+h0Ok/YBbQDGc0DTtPZbIOczQeQBzKaP1xGFUXZzGrwTL4/4DdpCH3jFASYb4qt4NKFQ87m3SS8cOnCIKcygIqi7LZjaDaEe/v6uIe5lQLAJ9uDmkXu7eCgaUN4TBrHTiQB4L3+qJu2MvB6vdxD2GcyzGOxGNfABoCoHjBpZRAKhXI6jPT25nRoBtnQ0MATxfv620wwn+tWxADOCrKlpYUnglf1gF6e2/SXVMr22erz+WhSBzk6NkYrKyst7ZxO59EFQLbs0R4rpkY1NTU0HA7T242N3N2I8wOXNjc308cdHVy3ae2isG75o+mVHaerrHdyvequ/AdglC0ORFE8ZLTnW/VlEVpr0GEksiyfRMRfJYQbFwRhhyGgNhPdPG/kYisAzLAAmcLp6pHwbE+xeHATbB/psCOEkGNr0NlziBg23GhxRvM8ADxj+7sign1FxIdLhnGhwm49AHCRLcI14HfaZtSwqQDgOyKmtLO+EwBushu8qqqbigbGI8wh+yuCEHKQ7ZvZ5xUnQZ7yD8zfzl1rwXkSAAAAAElFTkSuQmCC",wa="data:image/png;base64,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",ba="data:image/png;base64,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",xa="data:image/png;base64,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",ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtElEQVR4nO2bsWtUQRDGV1AxWCoWWgsS7ULgbufI2RxWNlraqq34F7ybiYgaYqVFsBP/AEWFgJWQUtBCkICW0Sg2ejeTa3RlL57cJXfcnXkvu++9+cG0B/vdt9/uzts1RlEURVEURVGmYTZxh4H4rkX5DCjfLcqDBeqcnupHioxFvgMkbrD4F5A8raHUTdnpOod2CjRQb2vE1+uJO2LKyBhxXK8syRdAbs7f/nHMlIlJBYKeUMgdS/y4lnRmTRmYViDoyymL/AqQLxrnDpii8v8CSZ+r5F1hcyoNgaBXKJs+p+rJz+OmKKQqEBUwp7IQCP45in/nPqcyFYh251Rl2c2YPLFfAkFec2rfBaLBnAJqnTUxE0ogyEtOBReI+lxFvA7EN6LKqdCiwPD66rsMNuGTofWJVSDXn1PVpHVOBaKx028tSE6FdgnEnlN+FYEIBj51oWxakqSatE5kLdDH4IPdm6O2AOVRZvsp22xfCz3IdBzVnQmrVWxfSD2ngPgSkLwA4g8WuR18sHt1Fcp7S+2rmfWnKstuxu9BasRzfuXwh0x/frIkKxbluSV5M0GzP3hZlG9+P1W5xadMCBpL7mg16ZypLsqCbcoVS3wTUO4D8RNAfh2LI//up5bmVtwhEyONSIT0Ipk808hYSD/lTJ5plFWgRiRTDJDvlXPgND6kvTj1xB1MZeAVXeYHsciXAeVlLP94VBvF7iaQwg8q2qOGJf6Ua7dkfVjVdscYcuiY9f1tmOVHmDVtudIOUbRpL6Mco599IIZ8mYTQ2QL66VmGu0UvL8jIfNHrLzTMMXqByuUuXyYhk00d6iVOV4jrdZOQjmNEL5LDLmH0KYIrfL5MwrT5Ml/C51AbY8Qp94O6kU8yUZ7B4tZ5U3b8o167LdJG91EvyUN91KsoiqIoiqIoZps/5GTgdqN3Zd0AAAAASUVORK5CYII=",ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClklEQVR4nO2bv4vUUBDHn6DicaViobUgnp292lnZaGmrtuJfoOV5B1ZaiJ34BygqCFaC5YEWCyIoy2XfzOzOxEIQ3MYbye3q/Yomuyb3XpL5wLQL893J900mb5wzDMMwDMMwjFno9fSwR74HKAjEKSA/GDCfmulH2oxHXgYS3R4e+adHfobIF1zXmVSO6D/iPaLc7Pf7R1wXKRBHt6pKCEjuev/tqOsSZQWCrRh74ieI6RnXBeYQSH/7FCC/8SSXVfWAayvzCgTbA+VDa32qEoHoj08NM58CgGOuLVQpELTRp2oSSKc+tdF4n6pTIMjxqSRJFlyT2DeBqKE+td8CwS6fIvq65GImoEDaCJ8KLRDsjE8w5FtR+VQEoujeqpJRNmVYFzkRWp8oBYK9PnXWBKKCqiJ5F8SnIqgSjdqnNk8RCp70XP2UR75DRMdrFQhQPodO9j/jh0d5XFs/BcA3IkiygoriDU/yGmB0qXKfQkyvAMpLT/zRo3xvgVg9GPL12uZTSZIsZD0IopzLTo7sJXNzHk3yCFBeeJK1EsP+4OFJOOunkiQ96UJARIsAchqRzwPItQHybSC574mfepK3EVXkGIhX11QPuRihaITkVddkqGYhs0fONRnqqkAUyyOGvNLNxKmESSOvqOrBShJP7JjfCeLoKpC8iugfj6dRnDaB2vSo7VXDo3wJnVzUL6s27iggggrQqAdmESSsZcJGrpQrjA3tIa9a7LOPxOEvZQjuLWifnrXAX+zyAuzyF7v+QjkVYxeopHn+UoaazHdslzipBdfrylBJxaBdJNccf7FVBGi7v5RhVn/xnVuHQoYCcbq9UPe3lUxAfj4guei6znSpd3lSSZwC8UNb6jUMwzAMwzAMN+EXe4XJ/lKRL1IAAAAASUVORK5CYII=",Ca="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRUlEQVR4nO2YzUrEMBSFsxp9CX0SYTazGJKCm5yZ5dhcEBRci4hjl/NO7sadvoH6Fu6GghKoNNZfMkkpw/ngQgmX5J6b00KvUoQQslMUKMcG8mis2xjI25ewbqOte/B5amgUOD3UcK/fFt4Jn3c8PzlQQ0Jbd/6f4oM4U0PCQKqguCo2JwsFyiMDd/lrWLlrve6fI3PQhj83iYBO5/qMigI8ZlZOjJXV50+irJIHOvvPyolKSXhA0o172p8C/sLwBiI7lHs9GRTQwBuIhRZqoIVioYUaaKFYaKEGWigWWqiBForlx84FP+ZbrYP/xDs+ldCQ+uMAAKOUe0+nF3vt9FpqlQNj3UsweLpKJQLASEOuAwFPKgfautueZqI3WQSMF4t9DbnPWbyGW3s7ZREQiFhquOfwndiuaKm9bXznsxZPCCEqJe/j5Sspw8QNvwAAAABJRU5ErkJggg==",et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVR4nO2ZS0oDQRCGBwT1AD5AfN1E0KhJV1QSuzSuYqqCiOBar6AHiBHBA3gLieglfIsLcRPduFBQesKYjijCTLckWB/MIh3yd1X13wn8CQJBEP4vs8vFcUDaB6Q7hfwGyO9xHxV+nu4AqaryNOa9+OwizSjk5yRFw0+P5idYKqW8Tt5b8dhsIotro14aaNgmOnq6zGB5EhG7k2giYnd2kaZA89Wntua9wAcNrzY2McW71M6aJprDuXEjurLWB8hH0Wv7wiad/FeMnn2xg6TMFXgQkC+MYLRmezXwALjUV0iHX8U6qwFNjx3dAHwjJg38AsgJWIiFYgBiIQuxUAxALGQhFooBiIUsxEIxALGQhVgoBiAW+mUaHZVKqNZiu8I1zbe+ciFYKqWsoV0nFlSa7yPB+QINhZsgVa0I8Mps6iKZyyBPtyRzSJXkDSDXmsVSIVzL01gYwPrMRpHqTrJRhbxtebLWctTemqC6iRgDFywsr46A5pdm4Eob0XtmQuaYTYbp4v8BFepQxXkqDci71nRe7SY6golisRc0nbVMTdOJwvJKOlcejr6d2prp3PqAQj71eHGPvDeRTm/2KKQd+044eTSdmwg/+CvCi420BZqPze9E/AtMD4B0kMZS/58VLwhC0FZ8ALiaxMwFZ/dcAAAAAElFTkSuQmCC",tt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEElEQVR4nO2Xu4sUQRCHC8HHJYqgiAgmXqKpkQgqIjjTtRss9m/v9MBzqpbB9TA08MUECv4DcslhaCSYGZkoCAZiYCCoaGRwoKKooIi6K+OB2w4LB+exsyX9wUQzDPV1PbqbKBKpj2RmZqOD3GpCJ8li8OzlIUP7DF1MkO0ho8H3GdpzkFNkNfgUnTmyQBKDr4kkrnxNJP/ZyveHPl7eM+Q1Qx8x5KaDXuRjeujg7OyGWgUcZL4SbG9Zmb/E9Kvzcoe9TAOYGN8MYPnHQT8w9ErjeL6lbokeQ7vhN3yiu5lxckfa1v0OmbKX6wx9OlxEPjP0cpKcXT9WEsNoIN/JkAsMfTYkIy9cWw7QuEuUFEWxhpG1nNfHFYkfzsul8v3YS5SUgaZeOw76riJye2QT618lSprTuo293q1MrPtHkG8iKxJLZSVXK5m4V2smVnIfSNGZc15+huVUV08suindvZL/NCCnK+V0nqzdiRlybSAh38s9hSxRlD0RNraX5yPd7FaDo618+9LBsIZSWi0Y2g0EPpbHFLJWSg7y5M9U8lKQNRyydiDw1lwvFL8bWl4OplLWIms4L0W4uZE1mtDJQODT3jxfS9bgoIwakH1kDYYsBDe5c2QN5+XMYBrpDbJGis7h4GjxgKyRTOW7glPqK7JGgmxrIPCGrAFgIhilX8gaANYFAt/IGogCkUgkQiPgF1+GFsoZdsMBAAAAAElFTkSuQmCC",Ia=t=>(fe("data-v-54676e48"),t=t(),ve(),t),Ra={class:"flex gap-3"},Ea={class:"flex flex-col gap-1"},Sa={key:0,class:"w-10 h-10 rounded object-cover ml-auto"},Fa=["innerHTML"],Ba=["innerHTML"],Ua=["innerHTML"],Ma={key:3,class:"flex flex-col gap-3 my-1"},Ta=["onClick"],Oa=Ia(()=>c("div",{class:"my-0.5 w-2px rounded-full bg-blue-300 flex-shrink-0"},null,-1)),La={class:"flex flex-col gap-0.5 flex-grow overflow-hidden align-center justify-center"},Qa={class:"text-sm font-bold ellipsis"},_a={class:"text-xs multiline-ellipsis"},Va=["src"],Ka=O({__name:"TextMessageContent",props:{message:{}},setup(t){const e=t,a=Y(),s=h(()=>a.state.imkit.messages[e.message.replyId??""]),o=h(()=>{const g=s.value;return g?a.state.imkit.users[g.senderId]:null}),n=h(()=>e.message.isIncoming),r=h(()=>{const{urls:g}=e.message;return g?g.map(f=>a.state.imkit.linkPreviews[f]).filter(f=>f):[]}),i=h(()=>{if(s.value.type===E.Text)return s.value.text;if(s.value.type===E.Image){const{t:g}=pe();return{[E.Text]:g("text"),[E.Image]:g("image"),[E.Video]:g("video"),[E.Sticker]:g("sticker")}[s.value.type]}return""}),u=h(()=>{if(s.value.type===E.Image)return s.value.images[0]}),d=g=>{window.open(g,"_blank")},p=()=>{a.dispatch("imkit/navigateToMessage",e.message.replyId)};return(g,f)=>{const x=he("src");return l(),m(V,null,[s.value?(l(),m("div",{key:0,class:"flex flex-col gap-2 cursor-pointer",onClick:p},[c("div",Ra,[D(ee,{class:"row-span-2 h-24px w-24px rounded-lg text-sm flex-shrink-0",url:o.value.avatarUrl??"",name:o.value.nickname??""},null,8,["url","name"]),c("div",Ea,[c("div",{class:_(["text-sm font-bold",[n.value?"text-gray-600":"text-white"]])},v(o.value.nickname),3),c("div",{class:_(["text-xs multiline-ellipsis",[n.value?"text-gray-500":"text-gray-200"]])},v(i.value),3)]),u.value?$((l(),m("img",Sa,null,512)),[[x,u.value.thumbnailUrl]]):C("",!0)]),c("div",{class:_(["h-1px -mx-2",[n.value?"bg-gray-200":" bg-blue-300"]])},null,2),c("div",{class:"break-all",innerHTML:g.message.html},null,8,Fa)])):(l(),m("div",{key:1,class:"break-all",innerHTML:g.message.html},null,8,Ba)),n.value&&g.message.translatedText?(l(),m("div",{key:2,class:"break-all text-gray-400",innerHTML:g.$t("translation")+": "+g.message.translatedText},null,8,Ua)):C("",!0),r.value.length>0?(l(),m("div",Ma,[(l(!0),m(V,null,Z(r.value,B=>(l(),m("div",{key:B.url,class:"flex items-stretch justify-center gap-2 cursor-pointer",onClick:K=>d(B.url)},[Oa,c("div",La,[c("div",Qa,v(B.title),1),c("div",_a,v(B.description||g.$t("tapOpen")),1)]),B.images.length>0?(l(),m("img",{key:0,src:B.images[0],class:"h-12 w-12 my-auto rounded flex-shrink-0 object-cover"},null,8,Va)):C("",!0)],8,Ta))),128))])):C("",!0)],64)}}});const de=re(Ka,[["__scopeId","data-v-54676e48"]]),Na="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNklEQVR4nO2Z20sVURTGd9r9IlLmDYxuBEmBURBSkQWF2EsvUUT17EOFb9ZbFIRBQdEfYIUUBNlDd6KgIqOrhWU3MQiiIior7QLlL9Y5a07b0eM5xzPjmYnzgXj2ntnfWt+stfdes8eYLLLIIuMARgILgU3AdmArsBZYBOSaoANYDBwBvhEfH4BGoNIEDUAJcBLotRx+ChwHDgGHgWbgiUtUMzDLBAFAFfBOHfsE7AbKBrl/NrAL+KJjPgPVw+t1f6dWAz/UoRNAYQpjp2rEBL+BLf56G9+RcqBbHdk5RI4RMlZT8hew1HtPo4bG60qzUlLC6h8FPFYRezyws1e5JEXz03bcIp4JNAHfXZOzHVgH1Gn7GpDjgb0c4IpyNnglotqaiJK7rcBV4JUlSFLhDzDXE6MmYrdCOeXhFXlB1qPOylpf4rpeqcIiS2e6zrsBnFbuWpMOgJtKtC/BvKlN+6kNzL1Z7V9Ih2SBkryUyeyph8n7UKg+fEyHpM6rVSgd8G+BGTeUwcuAe0qQmY1JAXSqHzNMspA8tyaYU9DF9otMAHijvhwA1gCjEw2YYy2pnTrRUg+nxwDaXHvXe6B+wHkLTAE69MZTwEQTEAB5wBJgo27KUroI7vSr5YBjevFSplaoFKuMW1ZlkWcXe726e5eaEAAYq+WQoMnp3K8dB02IABQDXzUIFdJxX4UsNyED0BALgr6RCSb7ZExS4K6PZwKCNmn8jPyEMT4Zi8An7nyl75LGa22UhVDIBKXvlsZlbawPoZB5Sv9CGtu0cSaEQuqVvlEaBdYbYFVYhBB9D3LqsBqnc4d2vAWmh0TIUaVukdMXpzMXOG+JWRFUIUQj4YiQTCp33zAJOOcYBs4CG4BpCUtnn4UQdX6+zgknnWRXXxVvQK7e3EXquJGqEBnD0NDSLxJxDBTo0f9F3Wec0nkwXPdRSA/wXE9yamJzYjgxmJBQgayQgCGUEQEeAA/lpSeeEH0hegTcNkEFUQedz2zFbiEqQq4JWk1QQfSI0/lOIstlqbWEFlnXngX+fIC+T935b/+ORSvwoG9kbAQ/EkmICZ8IV5q161840ilBZJL+TJ2F+U/wF9Y5UmVGwaQRAAAAAElFTkSuQmCC",Pa={key:0,class:"relative flex items-center justify-center"},Da={class:"max-w-80vw max-h-80vh",alt:""},Ga={key:0,class:"absolute max-w-80vw max-h-80vh",alt:""},Ya=c("div",{class:"absolute inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1),Xa={key:1,class:"mt-4 flex gap-4"},ja=c("img",{class:"w-5 h-5",src:Na},null,-1),Wa=O({__name:"ImageModal",props:{image:{}},setup(t){const e=Be(),a=Y(),s=h(()=>a.state.imkit.downloadProgresses),o=h(()=>a.state.imkit.imageCache),n=r=>{const i=document.createElement("a"),u=o.value.get(r.originalUrl);i.href=u;const d=u.split(";")[0].replace("data:","").split("/")[1];i.download=`download.${d}`,i.click()};return(r,i)=>{const u=he("src");return l(),G(I(Ue),{class:"flex items-center justify-center","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:se(()=>[r.image?(l(),m("div",Pa,[$(c("img",Da,null,512),[[u,r.image.thumbnailUrl]]),r.image.thumbnailUrl!==r.image.originalUrl?$((l(),m("img",Ga,null,512)),[[u,r.image.originalUrl]]):C("",!0),(!s.value[r.image.originalUrl]||s.value[r.image.originalUrl]<1)&&r.image.thumbnailUrl!==r.image.originalUrl?(l(),m(V,{key:1},[Ya,D(I(Oe),{class:"!absolute",diameter:40,"completed-steps":s.value[r.image.originalUrl]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):C("",!0)])):C("",!0),r.image?(l(),m("div",Xa,[c("button",{class:"text-base border rounded-lg flex-grow text-white gap-1.5 font-400 px-3 py-2 flex items-center justify-center",onClick:i[0]||(i[0]=d=>n(r.image))},[ja,ae(" "+v(r.$t("download")),1)]),c("button",{class:"text-base border rounded-lg flex-grow text-white gap-1.5 font-400 px-3 py-2 flex items-center justify-center",onClick:i[1]||(i[1]=d=>I(e).closeAll())},v(r.$t("close")),1)])):C("",!0)]),_:1})}}}),za=["onClick"],Ja=c("div",{class:"absolute inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1),Ha=O({__name:"ImageMessageContent",props:{message:{}},setup(t){const e=t,a=Y(),s=h(()=>a.state.imkit.uploadProgresses),o=(r,i)=>{if(e.message.images.length===1){const{width:d,height:p}=i;return d<p?{width:"200px",height:`${200*p/d}px`}:{width:`${200*d/p}px`,height:"200px"}}else return r===e.message.images.length-1&&r%2===0?{width:`${200*2+1}px`,height:"200px"}:{width:"200px",height:"200px"}},n=r=>{const{open:i}=xe({component:Wa,attrs:{image:r}});i()};return(r,i)=>{const u=he("src");return l(),m("div",{class:_(["-m-2 grid gap-1px",[r.message.images.length>1?"grid-cols-2":"grid-cols-1"]])},[(l(!0),m(V,null,Z(r.message.images,(d,p)=>(l(),m("div",{key:d.thumbnailUrl,class:_(["relative flex items-center justify-center",{"col-span-2":r.message.images.length>1&&p===r.message.images.length-1&&p%2===0}]),onClick:g=>n(d)},[$(c("img",{src:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"border-0 object-cover transition",style:X(o(p,d))},null,4),[[u,d.thumbnailUrl]]),d.thumbnailUrl.startsWith("data")?(l(),m(V,{key:0},[Ja,D(I(Oe),{class:"!absolute",diameter:40,"completed-steps":s.value[`${d.id}-original`]===void 0?(s.value[`${d.id}-original`]+s.value[`${d.id}-thumbnail`])/2*100:s.value[`${d.id}-original`]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):C("",!0)],10,za))),128))],2)}}}),Za=["src"],qa=O({__name:"StickerMessageContent",props:{message:{}},setup(t){const e=t,a=h(()=>e.message.stickerUrl?e.message.stickerUrl:`/sticker/${e.message.stickerId.split("-")[0]}/${e.message.stickerId}.png`);return(s,o)=>(l(),m("img",{src:a.value,class:"border-0 object-contain w-30 h-30"},null,8,Za))}}),vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpUlEQVR4nO3bP68MURzH4RMhNIobEhoJFaFCKRI6Ha/AW9DSKeUqVVqlmkQv8ScUOoVGgUSnQCM8MpFJZJmz17V398zO9ym32nwyO7O/M+eUEhERERERK4Z9OLDq79EcnMIjfPfLB9zA3jJ1OIMv/u41zpUpw0t13VV1B/vL1OCYrXuLS2VKcN6/uzeZGzku2J6PuFrWne0H6j3AkbKu/H+gzidcw66ybiwmUO8xjpd1YrGBOl9xE3vKOrD4QL1XOFvGzs4F6nzDrW6+K2NlZwP13uBiGSPLCdT5gbujG1csL1DvPS6XsbD8QL37OFhaZ3WBxjGuWG2g3sNmxxVtBGp3XNFOoN/HlROlFdoL1Na4os1Avac4nEB1z7E7V1DdlQSqu51AdZsJVJefWMWz3KSHPcGhPOb/lD+KFRk1BmRYrchyx4AsmFVkyXVAFu0H5LVPRV4cDsir54psXmh+TFgE2UBVly14c2QT5xzZBjxHNpLPgaO2bnpHETp4MSfMdA+zdHAanwfi5DhUBydnDtS9w/UcqJvRBcHG7OcREREREVEm5icELZJIi+Y1dAAAAABJRU5ErkJggg==",$a=c("div",{class:"absolute inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1),en=c("img",{class:"absolute pointer-events-none",src:vt,width:"24",height:"24"},null,-1),tn={class:"absolute right-2 bottom-2 text-white font-bold bg-black bg-opacity-30 rounded-full text-xs py-1 px-2"},sn=O({__name:"VideoMessageContent",props:{message:{}},setup(t){const e=t,a=`vp-${Math.random()}`,s=U(),o=U(),n=U(!1),r=()=>{const{width:g,height:f}=e.message.video;return g<f?{width:"200px",height:`${200*f/g}px`}:{width:`${200*g/f}px`,height:"200px"}},i=Y(),u=async()=>{if(n.value)return;n.value=!0;const p=await i.dispatch("imkit/fetchVideoBlob",e.message.video.originalUrl);s.value&&(s.value.src=URL.createObjectURL(p)),o.value=Xt(a)},d=h(()=>i.state.imkit.uploadProgresses);return(p,g)=>{const f=he("src");return l(),m("div",{class:"-m-2 relative flex items-center justify-center cursor-pointer",style:X(r()),onClick:u},[$(c("video",{ref_key:"videoPlayer",ref:s,id:a,class:"video-js vjs-default-skin absolute inset-0 w-full h-full",controls:"",preload:"auto",autoplay:""},null,512),[[Yt,n.value]]),n.value?C("",!0):(l(),m(V,{key:0},[$(c("img",{src:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"border-0 object-cover transition",style:X(r())},null,4),[[f,p.message.video.thumbnailUrl]]),p.message.video.thumbnailUrl.startsWith("data")?(l(),m(V,{key:0},[$a,D(I(Oe),{class:"!absolute",diameter:40,"completed-steps":d.value[p.message.video.id]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):(l(),m(V,{key:1},[en,c("div",tn,v(Math.floor(p.message.video.duration/60))+":"+v(`${Math.floor(p.message.video.duration%60)}`.padStart(2,"0")),1)],64))],64))],4)}}}),on="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAABV0lEQVR4nO3aMUpDQRSF4VmI1m5HtLCxkMxxA86JazAz2Ygi2LkgbVWMpQpKFCyihSZ33r0x58As4GP+F17gpaRp2sbs6GS6nUu7RGlPYHuzPrm029HJdDdFwYL1vgd0Af2Sx5MDb2/6uNnO2FBodMr4C8n6HAqN/re6t4gG62tmPfyX4PT52MRBYwBwKDQGAodBY0BwCDQGBruj4QB2RcMJ7IaGI9gFDWfwfMes+z+9kXX5w4HOYJyebS2LBuvN2oEz6/Uq6LUDY4BH4k/zBglM3bDtECBbPcPUj5bdECBbJU0lbTcEyFZJU0nbDQGyVdJU0nZDgGyVNJW03RAgWyVNJW03BMhWSVNJ2w0BslXSVNJ2Q4BslTSVtN2wcUmXvh+XrnJyaY/2YNarsGDWc3PwaDzZyaU9eOO+ndLufvupxHJfxZd2AdaZO5R1Nr/ZblhN01LEvQM/68r6Ex4bqgAAAABJRU5ErkJggg==",kt=t=>(fe("data-v-24966336"),t=t(),ve(),t),an=kt(()=>c("img",{class:"w-8 object-contain",src:on},null,-1)),nn={class:"flex flex-col gap-0.5 font-400"},rn={class:"text-base break-all"},ln=kt(()=>c("div",{class:"absolute -m-2 inset-0 bg-gray-800 bg-opacity-50 fill-blue-300"},null,-1)),cn=O({__name:"FileMessageContent",props:{message:{}},setup(t){const e=t,a=Y(),s=h(()=>e.message.isIncoming),o=h(()=>a.state.imkit.uploadProgresses),n=h(()=>{const i=e.message.bytes;return i<1e3?i+"B":i<1e3*1e3?(i/1e3).toFixed(1)+"KB":i<1e3*1e3*1e3?(i/1e3/1e3).toFixed(1)+"MB":(i/1e3/1e3/1e3).toFixed(1)+"GB"}),r=async()=>{try{const{url:i,fileName:u,fileExtension:d}=e.message,p=await a.state.imkit.axios.get(i,{responseType:"arraybuffer",onDownloadProgress:x=>{const{total:B}=x;B&&a.commit("imkit/updateField",{key:"downloadProgresses",value:{[i]:x.loaded/B}})}}),g=btoa(new Uint8Array(p.data).reduce((x,B)=>x+String.fromCharCode(B),"")),f=document.createElement("a");f.href=`data:${p.headers["content-type"]};base64,${g}`,f.download=`${u}.${d}`,f.click()}catch(i){console.error(i)}};return(i,u)=>(l(),m("div",{class:"flex items-center justify-center gap-2 cursor-pointer relative",onClick:r},[an,c("div",nn,[c("div",rn,v(i.message.fileName)+"."+v(i.message.fileExtension),1),c("div",{class:_(["text-sm",{"text-gray-500":s.value}])},v(i.$t("fileSize"))+": "+v(n.value),3)]),i.message.url===""?(l(),m(V,{key:0},[ln,D(I(Oe),{class:"!absolute",diameter:40,"completed-steps":o.value[i.message.id]*100,"total-steps":100,"start-color":"#60a5fa","stop-color":"#60a5fa","stroke-width":4,"inner-stroke-width":4},null,8,["completed-steps"])],64)):C("",!0)]))}});const dn=re(cn,[["__scopeId","data-v-24966336"]]),le=t=>{t.type==="uri"&&window.open(t.uri,"_blank")},un={class:"w-250px text-base overflow-hidden cursor-pointer"},mn=["src"],gn={key:1,class:"py-3 flex flex-col gap-2 border-t"},pn=["onClick"],An=O({__name:"TemplateMessageButtonsContent",props:{message:{}},setup(t){const e=t,a=h(()=>e.message.isIncoming),s=h(()=>!a.value);return(o,n)=>{var r;return l(),m("div",un,[o.message.template.thumbnailImageUrl?(l(),m("img",{key:0,class:_(["object-cover",{"object-contain":o.message.template.imageSize==="contain"}]),style:X({"background-color":o.message.template.imageBackgroundColor??"#ffffff",height:`${o.message.template.imageAspectRatio==="square"?250:250/1.51}px`}),src:o.message.template.thumbnailImageUrl,onClick:n[0]||(n[0]=i=>I(le)(o.message.template.defaultAction))},null,14,mn)):C("",!0),c("div",{class:"p-3 flex flex-col gap-1",onClick:n[1]||(n[1]=i=>I(le)(o.message.template.defaultAction))},[c("div",null,v((r=o.message.template.title)==null?void 0:r.substring(0,40)),1),o.message.template.text?(l(),m("div",{key:0,class:_(["text-sm",{"text-gray-500":a.value,"text-gray-100":s.value}])},v(!o.message.template.thumbnailImageUrl&&!o.message.template.title?o.message.template.text.substring(0,160):o.message.template.text.substring(0,60)),3)):C("",!0)]),o.message.template.actions.length>0?(l(),m("div",gn,[(l(!0),m(V,null,Z(o.message.template.actions,i=>(l(),m("div",{key:i.label,class:_(["flex items-center justify-center text-sm p-0.5",{"text-slate-500":a.value,"text-slate-100":s.value}]),onClick:u=>I(le)(i)},v(i.label),11,pn))),128))])):C("",!0)])}}}),hn={class:"w-250px text-base overflow-hidden"},fn={class:"p-3"},vn={class:"flex border-t divide-x"},kn=["onClick"],yn=O({__name:"TemplateMessageConfirmContent",props:{message:{}},setup(t){const e=t,a=h(()=>e.message.isIncoming),s=h(()=>!a.value);return(o,n)=>(l(),m("div",hn,[c("div",fn,v(o.message.template.text.substring(0,240)),1),c("div",vn,[(l(!0),m(V,null,Z(o.message.template.actions.slice(0,2),r=>(l(),m("div",{key:r.label,class:_(["flex-grow flex items-center justify-center p-2 cursor-pointer",{"text-slate-500":a.value,"text-slate-100":s.value}]),onClick:i=>I(le)(r)},v(r.label),11,kn))),128))])]))}}),wn={class:"text-base overflow-auto cursor-pointer flex gap-2"},bn=["src","onClick"],xn=["onClick"],Cn={key:1,class:"py-3 flex flex-col gap-2 border-t"},In=["onClick"],Rn=O({__name:"TemplateMessageCarouselContent",props:{message:{}},setup(t){const e=t,a=h(()=>e.message.isIncoming),s=h(()=>!a.value);return(o,n)=>(l(),m("div",wn,[(l(!0),m(V,null,Z(o.message.template.columns,(r,i)=>{var u;return l(),m("div",{key:i,class:_(["w-250px text-base overflow-hidden cursor-pointer rounded-xl",[a.value?"bg-gray-100 text-gray-900":"bg-blue-400 text-white "]])},[r.thumbnailImageUrl?(l(),m("img",{key:0,class:_(["object-cover",{"object-contain":o.message.template.imageSize==="contain"}]),style:X({"background-color":r.imageBackgroundColor??"#ffffff",height:`${o.message.template.imageAspectRatio==="square"?250:250/1.51}px`}),src:r.thumbnailImageUrl,onClick:d=>I(le)(r.defaultAction)},null,14,bn)):C("",!0),c("div",{class:"p-3 flex flex-col gap-1",onClick:d=>I(le)(r.defaultAction)},[c("div",null,v((u=r.title)==null?void 0:u.substring(0,40)),1),r.text?(l(),m("div",{key:0,class:_(["text-sm",{"text-gray-500":a.value,"text-gray-100":s.value}])},v(!r.thumbnailImageUrl&&!r.title?r.text.substring(0,160):r.text.substring(0,60)),3)):C("",!0)],8,xn),r.actions.length>0?(l(),m("div",Cn,[(l(!0),m(V,null,Z(r.actions,d=>(l(),m("div",{key:d.label,class:_(["flex items-center justify-center text-sm p-0.5",{"text-slate-500":a.value,"text-slate-100":s.value}]),onClick:p=>I(le)(d)},v(d.label),11,In))),128))])):C("",!0)],2)}),128))]))}}),En={class:"text-base overflow-auto cursor-pointer flex gap-2"},Sn=["src","onClick"],Fn=O({__name:"TemplateMessageImageCarouselContent",props:{message:{}},setup(t){return(e,a)=>(l(),m("div",En,[(l(!0),m(V,null,Z(e.message.template.columns,(s,o)=>(l(),m("img",{key:o,src:s.imageUrl,class:"w-250px h-250px object-cover rounded-xl",onClick:n=>I(le)(s.action)},null,8,Sn))),128))]))}}),Bn=O({__name:"TemplateMessageContent",props:{message:{}},setup(t){const e={[Ae.Buttons]:An,[Ae.Confirm]:yn,[Ae.Carousel]:Rn,[Ae.ImageCarousel]:Fn};return(a,s)=>(l(),G(Le(e[a.message.templateType]),{message:a.message},null,8,["message"]))}}),Un=O({__name:"FlexMessageBoxComponent",props:{content:{}},setup(t){const e=a=>({none:"0",xs:"2px",sm:"4px",md:"8px",lg:"12px",xl:"16px",xxl:"20px"})[a]??a;return(a,s)=>(l(),m("div",{class:_(["flex",{"flex-col":a.content.layout==="vertical","flex-row":a.content.layout==="horizontal","flex-row items-baseline":a.content.layout==="baseline"}]),style:X({backgroundColor:a.content.backgroundColor??"#00000000",borderColor:a.content.borderColor,borderWidth:a.content.borderWidth,borderRadius:a.content.cornerRadius,width:a.content.width,maxWidth:a.content.maxWidth,height:a.content.height,maxHeight:a.content.maxHeight})},[(l(!0),m(V,null,Z(a.content.contents,(o,n)=>(l(),G(Ie,{key:n,content:o,style:X(a.content.layout==="vertical"?{marginTop:o.margin?e(o.margin):n===0?0:e(a.content.spacing)}:{marginLeft:o.margin?e(o.margin):n===0?0:e(a.content.spacing)})},null,8,["content","style"]))),128))],6))}}),Mn=O({__name:"FlexMessageButtonComponent",props:{content:{}},setup(t){const e=t,a=h(()=>e.content.style==="primary"?"#ffffff":e.content.style==="secondary"?"#000000":e.content.color||"#42659a"),s=h(()=>e.content.style==="primary"?e.content.color||"#17c950":e.content.style==="secondary"?e.content.color||"#dcdfe5":"");return(o,n)=>(l(),m("button",{class:_([[o.content.size==="md"?"h-52px":"h-40px"],"rounded-lg"]),style:X({color:a.value,backgroundColor:s.value}),onClick:n[0]||(n[0]=r=>I(le)(o.content.action))},v(o.content.action.label),7))}}),Tn=["src"],On=O({__name:"FlexMessageImageComponent",props:{content:{}},setup(t){const e=t,a=h(()=>e.content.aspectRatio?e.content.aspectRatio.replace(":","/"):"1/1");return(s,o)=>(l(),m("div",{class:_(["w-full bg-gray-300 overflow-hidden",[s.content.aspectMode==="cover"?"object-cover":"object-contain"]]),style:X({"aspect-ratio":a.value})},[c("img",{class:"w-full h-full",src:s.content.url},null,8,Tn)],6))}}),Ln=["src"],Qn=O({__name:"FlexMessageVideoComponent",props:{content:{}},setup(t){return(e,a)=>(l(),m("video",{src:e.content.url},null,8,Ln))}}),_n=O({__name:"FlexMessageIconComponent",props:{content:{}},setup(t){const e=t,a=h(()=>{const s=e.content.size;return{xxs:"12px",xs:"13px",sm:"14px",md:"16px",lg:"19px",xl:"22px",xxl:"29px","3xl":"35px","4xl":"48px","5xl":"74px"}[s]??"16px"});return(s,o)=>(l(),m("span",{style:X({overflow:"hidden",background:"no-repeat center",backgroundSize:"contain",backgroundImage:"url("+s.content.url+")",width:a.value,height:a.value})},null,4))}}),Vn=O({__name:"FlexMessageTextComponent",props:{content:{}},setup(t){const e=t,a=h(()=>{const s=e.content.size;return{xxs:"12px",xs:"13px",sm:"14px",md:"16px",lg:"19px",xl:"22px",xxl:"29px","3xl":"35px","4xl":"48px","5xl":"74px"}[s]??"16px"});return(s,o)=>(l(),m("div",{class:"basis-0",style:X({flexGrow:s.content.flex??0})},[c("p",{class:_([s.content.weight==="bold"?"font-700":"font-400",s.content.wrap?"overflow-clip whitespace-normal break-words overflow-hidden":"truncate whitespace-nowrap overflow-hidden"]),style:X({fontSize:a.value,color:s.content.color,"text-size-adjust":"100%"})},v(s.content.text),7)],4))}}),Kn=O({__name:"FlexMessageSpanComponent",props:{content:{}},setup(t){return(e,a)=>(l(),m("span",null,v(e.content.text),1))}}),Nn=O({__name:"FlexMessageSeparatorComponent",props:{content:{}},setup(t){return(e,a)=>(l(),m("div"))}}),Ie=O({__name:"FlexMessageComponent",props:{content:{}},setup(t){const e=t,a={box:Un,button:Mn,image:On,video:Qn,icon:_n,text:Vn,span:Kn,separator:Nn},s=h(()=>e.content.type);return(o,n)=>(l(),G(Le(a[s.value]),{content:o.content},null,8,["content"]))}}),yt=O({__name:"FlexMessageBubbleComponent",props:{content:{}},setup(t){const e=t,a=h(()=>e.content.header),s=h(()=>e.content.hero),o=h(()=>e.content.body),n=h(()=>e.content.footer),r=h(()=>{var g;return(g=e.content.styles)==null?void 0:g.header}),i=h(()=>{var g;return(g=e.content.styles)==null?void 0:g.hero}),u=h(()=>{var g;return(g=e.content.styles)==null?void 0:g.body}),d=h(()=>{var g;return(g=e.content.styles)==null?void 0:g.footer}),p=h(()=>{switch(e.content.size){case"nano":return"10px";case"micro":return"13px";case"kilo":return n.value?"13px 13px 17px 13px":"13px";case"mega":return n.value?"19px 20px 10px 20px":"20px";case"giga":return n.value?"19px 20px 10px 20px":"20px";default:return"20px"}});return(g,f)=>{var x,B,K,T,S,k,A,b,F,L,P,J;return l(),m("div",{class:_(["bg-gray-100 text-hex-444444 rounded-xl overflow-hidden",{"w-120px":g.content.size==="nano","w-160px":g.content.size==="micro","w-260px":g.content.size==="kilo","w-300px":g.content.size==="mega"||!g.content.size,"w-386px":g.content.size==="giga"}])},[a.value?(l(),G(Ie,{key:0,content:a.value,style:X({backgroundColor:(x=r.value)==null?void 0:x.backgroundColor,borderBottom:(B=r.value)!=null&&B.separator?`1px solid ${(K=r.value)==null?void 0:K.separatorColor}`:"none"})},null,8,["content","style"])):C("",!0),s.value?(l(),G(Ie,{key:1,content:s.value,style:X({backgroundColor:(T=i.value)==null?void 0:T.backgroundColor,borderBottom:(S=i.value)!=null&&S.separator?`1px solid ${(k=i.value)==null?void 0:k.separatorColor}`:"none"})},null,8,["content","style"])):C("",!0),o.value?(l(),G(Ie,{key:2,content:o.value,style:X({backgroundColor:(A=u.value)==null?void 0:A.backgroundColor,borderBottom:(b=u.value)!=null&&b.separator?`1px solid ${(F=u.value)==null?void 0:F.separatorColor}`:"none",padding:p.value})},null,8,["content","style"])):C("",!0),n.value?(l(),G(Ie,{key:3,content:n.value,class:"p-2.5",style:X({backgroundColor:(L=d.value)==null?void 0:L.backgroundColor,borderBottom:(P=d.value)!=null&&P.separator?`1px solid ${(J=d.value)==null?void 0:J.separatorColor}`:"none"})},null,8,["content","style"])):C("",!0)],2)}}}),Pn=O({__name:"FlexMessageBubbleContent",props:{message:{}},setup(t){return(e,a)=>(l(),G(yt,{content:e.message.contents},null,8,["content"]))}}),Dn={class:"flex items-start gap-2 overflow-auto"},Gn=O({__name:"FlexMessageCarouselContent",props:{message:{}},setup(t){return(e,a)=>(l(),m("div",Dn,[(l(!0),m(V,null,Z(e.message.contents.contents,(s,o)=>(l(),G(yt,{key:o,content:s},null,8,["content"]))),128))]))}}),Yn=O({__name:"FlexMessageContent",props:{message:{}},setup(t){const e={[De.Bubble]:Pn,[De.Carousel]:Gn};return(a,s)=>(l(),G(Le(e[a.message.flexType]),{message:a.message},null,8,["message"]))}}),Xn=t=>(fe("data-v-d84a2a16"),t=t(),ve(),t),jn={class:"p-2 w-300px <sm:w-250px underline"},Wn=Xn(()=>c("div",{class:"absolute inset-0"},null,-1)),zn=O({__name:"LocationMessageContent",props:{message:{}},setup(t){const e=t,s=Y().state.imkit.config.mapApiKey,o=h(()=>({lat:e.message.latitude,lng:e.message.longitude})),n=()=>{window.open(`https://www.google.com/maps/search/?api=1&query=${e.message.address}`,"_blank")};return(r,i)=>(l(),m("div",{class:"flex flex-col -m-2 cursor-pointer relative",onClick:n},[D(I(lt),{"api-key":I(s),center:o.value,zoom:15,disableDefaultUi:!0,class:"w-300px h-200px <sm:w-250px <sm:h-150px"},{default:se(()=>[D(I(it),{options:{position:o.value}},null,8,["options"])]),_:1},8,["api-key","center"]),c("div",jn,v(r.message.address),1),Wn]))}});const Jn=re(zn,[["__scopeId","data-v-d84a2a16"]]),Hn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACS0lEQVR4nO2bPYsUQRCGG1E0MRAFTQSNTjRSQxE0M9NfoGCwOv3O3k7XKpxR9e7hdyRGlxoan2B+4AcamBmYGKhgZqAmoitzB87eMh93595uz877QCcbLQ9dNV3V1cYQQgghhBBCpswV1T3Anf3T/h/BYZP+Cev0uXX+N8QPIPoFzt9qtx/tNk0HiZ6C+B9rYtYv6/z7OOmdMU0GTt/myRmSlO6qx1dv3t9rmkbcXTxaJmfdcvrROr1gmkSc9M5uWFAm6kljEjm6em7TglYl+a+R08tm1sFWBWW7aTmSxcNmVsH/ClqT9A3iO6q6w8waGIegLOxWrnf6c2aWwDgFpUcC0Z9w6lutpV1mFsCYBQ2Jehd1+6dN3cE2CVqV5PwvK3ovre9MXcE2ChpaHyLXO2/qCCYjKC1+/1jnl2pXrmBigv6F3Web9C6auoAJCxpK4k9bogdM6GBKgmpTrmCagrL1LNhyBWEICrdcQSiCsrBbiUWPmVBAaIJCK1cQoKBMlH9pb+ghCpJSSa9VdSd3kBRLikUvUZCU7CLnH1KQlOUjfUBBwhAbbO1cpK+YpKXwPPRifv72QX7mhQfFwcZDiqXGoCDXsFhF8c5huwP54cSGGYq/UGy5Ir9sYNMe+eUCr31QnIR5cYj8cOLVM4qTMIcXEHo/eRyAA1TlcASvAg5xVsAx4Ao4SF7BtY4e2UT7s3lPEVKs+DcV1y7NfcyS0pb+Sev0e4EcPodKaXf1+MiDuk9WdIEP6kZIhUQLd/eN/k4IIYQQQggxDeMvr6MHGaopSLgAAAAASUVORK5CYII=",Zn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4klEQVR4nO2bzy5DQRTGJ8GaDQ+ANZ4FXbDxZ9HoGTc1p01scA5SGmshfQLBAu+gkYgXYqEyjUhEae/0Ti/y/ZJZ3vnO/e733d0xBgAAAAAAgFhsVGSCKrJoK1L8cpwsJ9XDqaw1ycm0v7uz5v5CktTGTd6IyLBlObEsL5a19f2RV8t6WS7LWL+a/g7r9PpnPW2R02fr9NjPaPKCnDa6DfrpOG32M3Cx2Bgh1od0mnJm8oDKMveejN6H9V+WZTVYk2U9rZ6fsVSVGTNorJO99MO2B74N1SSndyGaxLqb7dv3MizreZBBTh5DNf2zgQadm1///+EPg55CNf2zQQY5bZhBQzAIBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAYhQTEhVAwGIUExIVQMBiFBMSFUDAb1lyDGKkKUZRZyemMGvcziZMcMmk13MBuyDmW3dCVU0zpd+zPrUCE1I5b7fhbq2huOTpsp03Nq8kJEhoml3l5/7PIVifWiuF0fzWIlk1iueqjyM7EcFQpXQyZvkqQ2XqrIfKcFW2JdKm3JZNaa/k5/dydNP8uvWOoFAAAAAADm3/IGGLsxyp+ApQ8AAAAASUVORK5CYII=",qn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVR4nO3bTy5DYRSG8ZuosU5qAWWMtZQJE38GVkGHiHGj6QoEA+yBSJpuiIFXGtesvPee77sp+vwS057zPcXsFAUAAADQFEmrknYkHc/42ZO01sDM9fKzZ83cltTJPTOyZEvSpaQ3/exd0o2kdoaZbUl38l4lnU93zPPa2LIj1fOcsrCkZUkvNWde5X119WW3yt+Mug4SZh4F5k133Mj7+mrL9hXzkDDzMTjzNO/rqy07DC47Tpg5Ds4c5n19M/9/vkwSZk4UM8r7+mrLjoLLEsggkEEgg0AGgQwCGQQyCGQQyCCQQSCDQAaBDAIZBDIIZBDIIJBBIINABoEMAhkEMghkEMggkEEgg0AGgQwCGQQyCGQQyCCQQSCDQAaBDAIZBDIIZCxMoGFw2YU5RegHl72fwzHLSd7XV1t2M3gOtZ8w8/DPnEMF/8yeEg/qWuVRXh2DYl70ufBFef7ovsVrSSuZTjJvK4SZ7nQmaSnPa9OW7kjqfXNguyup28DMbvnZs2b2fsVRLwAAAIp/6wPxkEFCV8mUxgAAAABJRU5ErkJggg==",$n=["onClick"],er={key:0,src:Hn,width:"24",height:"24"},tr={key:1,src:vt,width:"24",height:"24"},sr={key:1,class:"h-5 flex items-center justify-center"},or=c("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"},null,-1),ar=c("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"},null,-1),nr=[or,ar],rr={key:0,src:Zn,width:"24",height:"24"},ir={key:1,src:qn,width:"24",height:"24"},lr={class:"text-white font-bold bg-black bg-opacity-30 rounded-full text-xs py-1 px-2"},cr=O({__name:"AudioMessageContent",props:{message:{}},setup(t){const e=t,a=Y(),s=U(0),o=U(),n=U(0),r=U(),i=h(()=>e.message.isIncoming),u=()=>{o.value&&(n.value=o.value.seek()/o.value.duration()*100,o.value.playing()&&requestAnimationFrame(u))},d=async()=>{var g,f;switch(s.value){case 0:{const x=new jt.Howl({src:e.message.url,format:["m4a","mp3","wav","aac","webm"],onload:()=>{x.play(),s.value=3},onplay:()=>{requestAnimationFrame(u)},onend:()=>{s.value=2},onloaderror:(B,K)=>console.log(2,B,K),xhr:{headers:{"IM-Authorization":a.state.imkit.config.token,"IM-Client-Key":a.state.imkit.config.clientKey}}});o.value=x,s.value=1;break}case 2:case 4:(g=o.value)==null||g.play(),s.value=3;break;case 3:(f=o.value)==null||f.pause(),s.value=4;break}},p=async g=>{if(!o.value||!r.value)return;const{x:f,width:x}=r.value.getBoundingClientRect();n.value=(g.clientX-f)/x*100,o.value.seek(o.value.duration()*n.value/100)};return(g,f)=>(l(),m(V,null,[c("div",{class:_(["absolute top-0 bottom-0 left-0 pointer-events-none",[i.value?"bg-gray-300":"bg-blue-300"]]),style:X({width:`${n.value}%`})},null,6),c("div",{ref_key:"container",ref:r,class:"flex items-center justify-between w-250px p-3 relative -m-2",onClick:p},[c("button",{onClick:ne(d,["stop"])},[new Set([0,2,4]).has(s.value)?(l(),m(V,{key:0},[i.value?(l(),m("img",er)):(l(),m("img",tr))],64)):s.value===1?(l(),m("div",sr,[(l(),m("svg",{class:_(["w-5 h-5 animate-spin",[i.value?"text-gray-400 fill-gray-100":"text-gray-200 fill-blue-400"]]),viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nr,2))])):s.value===3?(l(),m(V,{key:2},[i.value?(l(),m("img",rr)):(l(),m("img",ir))],64)):C("",!0)],8,$n),c("div",lr,v(Math.floor(g.message.duration/60))+":"+v(`${Math.floor(g.message.duration%60)}`.padStart(2,"0")),1)],512)],64))}}),dr={class:"flex items-center justify-center"},ur={class:"bg-gray-100 rounded-lg py-1.5 px-2 my-3 text-sm text-gray-700"},mr=O({__name:"SystemMessageContent",props:{message:{}},setup(t){const e=t,a=Y(),s=h(()=>a.state.imkit.users),o=h(()=>{const{t:n}=pe(),r=s.value[e.message.senderId].nickname;switch(e.message.type){case E.Recall:return e.message.senderId===a.state.imkit.uid?n("youUnsentMessage"):n("someoneUnsentMessage",[r]);case E.JoinRoom:return n("someoneJoinedTheChat",[r]);case E.LeaveRoom:return n("someoneLeftTheChat",[r]);case E.AddMember:return n("someoneInvited",[r,e.message.members.map(i=>i.nickname).join(", ")]);case E.DeleteMember:return n("someoneKicked",[r,e.message.members.map(i=>i.nickname).join(", ")]);case E.AddMembers:return n("someoneInvited",[r,e.message.members.map(i=>i.nickname).join(", ")]);case E.Announcement:return e.message.text;default:return""}});return(n,r)=>(l(),m("div",dr,[c("div",ur,v(o.value),1)]))}}),gr={key:3,class:"text-gray-500 text-xs self-end flex flex-col items-end"},pr={key:0},Ar={key:4,class:"text-gray-500 text-xs self-end"},hr=O({__name:"MessageCell",props:{source:{}},setup(t){const e=t,a=e.source,s={[E.Text]:de,[E.Image]:Ha,[E.Sticker]:qa,[E.Video]:sn,[E.File]:dn,[E.Template]:Bn,[E.Flex]:Yn,[E.Location]:Jn,[E.Audio]:cr,[E.Recall]:de,[E.JoinRoom]:de,[E.LeaveRoom]:de,[E.AddMember]:de,[E.DeleteMember]:de,[E.AddMembers]:de,[E.Announcement]:de},o=Y(),n=h(()=>{if(o.state.imkit.uid!==e.source.senderId)return 0;const{rooms:k,uid:A,messages:b}=o.state.imkit,F=k[e.source.roomId];return F?Object.keys(F.lastReadMessageId).filter(L=>L!==A).map(L=>{const P=F.lastReadMessageId[L];return b[P]}).reduce((L,P)=>P&&P.createdAt>=e.source.createdAt?L+1:L,0):0}),r=h(()=>e.source.isIncoming),i=h(()=>!r.value),u=h(()=>o.state.imkit.messageGroupHead[e.source.id]),d=h(()=>o.state.imkit.messageGroupTail[e.source.id]),p=U(!1),g=k=>{p.value=!0,k.preventDefault()},f=()=>{o.commit("imkit/setState",{replyId:e.source.id})},x=()=>{let k="";switch(e.source.type){case E.Text:k=e.source.text;break;case E.Location:k=e.source.address;break}navigator.clipboard.writeText(k)},B=()=>{o.dispatch("imkit/recallMessage",{roomId:e.source.roomId,_id:e.source.id,messageType:"recall"})},K=h(()=>{const k=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g;if(e.source.type===E.Text){const A=e.source.text;for(let b=0;b<A.length;b++)if(!k.test(A[b]))return!1;return!0}return!1}),T=h(()=>e.source),S=h(()=>new Set([E.Recall,E.JoinRoom,E.LeaveRoom,E.AddMember,E.DeleteMember,E.AddMembers,E.Announcement]).has(e.source.type));return(k,A)=>S.value?(l(),G(mr,{key:0,message:k.source},null,8,["message"])):(l(),m("div",{key:1,class:_(["flex gap-2",[r.value?"justify-start":"justify-end",u.value?"mt-1":"mt-0.25",d.value?"mb-1":"mb-0.25"]]),onMouseleave:A[1]||(A[1]=b=>p.value=!1)},[i.value&&p.value?(l(),m("img",{key:0,src:Ca,class:"w-5 h-5 my-auto cursor-pointer",onClick:B})):C("",!0),i.value&&p.value?(l(),m("img",{key:1,src:et,class:"w-5 h-5 my-auto cursor-pointer",onClick:x})):C("",!0),i.value&&p.value?(l(),m("img",{key:2,src:tt,class:"w-5 h-5 my-auto cursor-pointer",onClick:f})):C("",!0),i.value&&d.value&&!p.value?(l(),m("div",gr,[n.value>0?(l(),m("div",pr,v(k.$t("read"))+" "+v(n.value),1)):C("",!0),c("div",null,v(I(W)(k.source.createdAt).format("H:mm")),1)])):C("",!0),c("div",{class:_(["rounded overflow-hidden relative <sm:max-w-3/4",[r.value?"bg-gray-100 text-gray-900 rounded-r-xl":"bg-blue-400 text-white rounded-l-xl",i.value&&u.value?"rounded-tr-xl":"",i.value&&d.value?"rounded-br-xl":"",r.value&&u.value?"rounded-tl-xl":"",r.value&&d.value?"rounded-bl-xl":"",[I(E).Sticker,I(E).Image].includes(k.source.type)?"!bg-white":"",K.value?"!bg-white !text-3xl":"",[I(E).Template,I(E).Flex].includes(k.source.type)?"!bg-white !rounded-none":"py-1.5 px-2 max-w-3/5",[I(Ae).ImageCarousel,I(Ae).Carousel].includes(T.value.templateType)?"!bg-white !rounded-none":""]]),onContextmenu:g,onMouseenter:A[0]||(A[0]=b=>p.value=!0)},[(l(),G(Le(s[k.source.type]),{message:I(a)},null,8,["message"]))],34),r.value&&d.value&&!p.value?(l(),m("div",Ar,v(I(W)(k.source.createdAt).format("H:mm")),1)):C("",!0),r.value&&p.value?(l(),m("img",{key:5,src:tt,class:"w-5 h-5 my-auto cursor-pointer",onClick:f})):C("",!0),r.value&&p.value?(l(),m("img",{key:6,src:et,class:"w-5 h-5 my-auto cursor-pointer",onClick:x})):C("",!0)],34))}});const fr=re(hr,[["__scopeId","data-v-f82e3ad2"]]),vr={class:"overflow-auto absolute right-0 bottom-[110%] rounded-xl h-80 w-80 bg-white border flex flex-col divide-y"},kr={class:"flex-grow grid grid-cols-4 p-4 gap-4 items-center justify-center overflow-y-auto"},yr=["src","onClick"],wr={class:"flex flex-shrink-0 h-14 w-full overflow-x-auto p-3 gap-4"},br=["src","onClick"],xr=O({__name:"StickerPanel",emits:["close"],setup(t,{emit:e}){const a=Y(),s=[{name:"FunFunFamily",number:40},{name:"animal",number:16},{name:"emoji",number:40},{name:"food",number:16},{name:"money",number:11},{name:"natural",number:30},{name:"people",number:16},{name:"sport",number:16}],o=U(s[0]),n=h(()=>a.state.imkit.rooms[a.state.imkit.selectedRoomId]),r=async i=>{const u={roomId:n.value.id,messageType:"sticker",sticker:i};await a.dispatch("imkit/sendMessage",u),e("close")};return(i,u)=>(l(),m("div",vr,[c("div",kr,[(l(!0),m(V,null,Z(o.value.number,d=>(l(),m("img",{src:`/sticker/${o.value.name}/${o.value.name}-${d}.png`,key:d,class:"border-0 cursor-pointer object-contain",onClick:p=>r(`${o.value.name}-${d}`)},null,8,yr))),128))]),c("div",wr,[(l(),m(V,null,Z(s,d=>c("img",{src:`/sticker/${d.name}/${d.name}-1.png`,key:d.name,class:"border-0 cursor-pointer object-contain h-full",onClick:p=>o.value=d},null,8,br)),64))])]))}}),Ke=t=>new Promise((e,a)=>{const s=new FileReader;s.onload=()=>{const o=new Image;o.src=s.result,o.onload=async()=>{e({id:await Pe(o.src),width:o.width,height:o.height,thumbnailUrl:o.src,originalUrl:o.src})},o.onerror=()=>a},s.onerror=()=>{a(s.error)},s.readAsDataURL(t)}),Cr=t=>new Promise((e,a)=>{const s=document.createElement("canvas"),o=s.getContext("2d");if(!o){a(new Error("Could not get canvas context"));return}const n=document.createElement("video");n.src=URL.createObjectURL(t),n.autoplay=!0,n.onloadedmetadata=()=>{s.width=n.videoWidth,s.height=n.videoHeight},n.onloadeddata=()=>{o.drawImage(n,0,0,s.width,s.height),s.toBlob(async r=>{if(!r){a(new Error("Could not create blob"));return}const i=new File([r],"snapshot.jpg",{type:"image/jpeg"}),u=new FileReader;u.readAsDataURL(r),u.onloadend=async()=>{e({id:await Pe(n.src),width:s.width,height:s.height,duration:n.duration,thumbnailUrl:u.result,originalUrl:"",thumbnailFile:{id:await Pe(s.toDataURL()),file:i}})}},"image/jpeg")},n.onerror=()=>a}),Ir={key:0,class:"bg-gray-200 rounded-lg mb-3 flex gap-2 p-2"},Rr={class:"flex flex-col gap-1"},Er={class:"text-sm font-bold text-gray-600"},Sr={class:"text-xs text-gray-500 multiline-ellipsis"},Fr={class:"flex gap-2 ml-auto"},Br={key:0,class:"w-10 h-10 rounded object-cover"},Ur=O({__name:"ReplyMessagePreview",setup(t){const e=Y(),a=h(()=>{const{replyId:i}=e.state.imkit;return e.state.imkit.messages[i]}),s=h(()=>{const i=a.value;if(i)return e.state.imkit.users[i.senderId]}),o=h(()=>{if(a.value.type===E.Text)return a.value.text;if(a.value.type===E.Image){const{t:i}=pe();return{[E.Text]:i("text"),[E.Image]:i("image"),[E.Video]:i("video"),[E.Sticker]:i("sticker")}[a.value.type]}return""}),n=h(()=>{if(a.value.type===E.Image)return a.value.images[0]}),r=()=>{e.commit("imkit/setState",{replyId:""})};return(i,u)=>{var p,g,f;const d=he("src");return a.value?(l(),m("div",Ir,[D(ee,{class:"bg-gray-300 row-span-2 h-24px w-24px rounded-lg text-sm flex-shrink-0",url:((p=s.value)==null?void 0:p.avatarUrl)??"",name:((g=s.value)==null?void 0:g.nickname)??""},null,8,["url","name"]),c("div",Rr,[c("div",Er,v((f=s.value)==null?void 0:f.nickname),1),c("div",Sr,v(o.value),1)]),c("div",Fr,[n.value?$((l(),m("img",Br,null,512)),[[d,n.value.thumbnailUrl]]):C("",!0),c("img",{src:ut,class:"w-5 h-5 cursor-pointer text-gray-400",onClick:r})])])):C("",!0)}}});const Mr=re(Ur,[["__scopeId","data-v-e952c252"]]),Tr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXElEQVR4nO2Zv2sUQRTHH4qKhYWFiljYSqLVFbl9M3aiQbAzWFgGrA0Wlrvz7oKKRLAMWomN9w8o2AdLG7EJgj8awUKy995GRFcWklxiSLxzf8zMMh/49vtlZt/37XcBAoFAIBAIBAL7oyidVsRGGXnUpfQCtBF8kB9TSTaviFcUSb4lwxLF6XloC2gkQuKnSJzuMLpNSPwQfEYvrp1A4gUkfreXyb9OOQHviPMDupddQuJnxTUdy+iW0mnwhW6fz2iSu2j4w2QmN8Ur4DpTcX5YGb6GJAMk/vl/RjeUZPPgKlG8fg4N31ckX0uZHA2rtJje4BLdpfyoNjKHhl8rw7+rMDoaVvIEXEETd5BkWRleq9TkdvW5a9fkve/HNfEtNPK2NpOjYfXewziRMu/vgmdxImVO90exnPgVJ1TmdGXgVZyokorM8EotRjGRG7u+TiwLiT8Wc6N6szS8attcox8KiuSOdXO7xL+inpytxfDF/vC0Mrxq3+QOvYK6p7LeXAvtm82LZ4GmV0UkzqwYNvJt9nF+BJpmZjE9VSwciuRzw+/vEthkqvHr7lCroWu/7o62GjN1XXeXW42qr7uTrcZ+IMmb1rQa44CJ3PS61ZiUznJ+SBn54lerUZJi4fei1aiKKE5PouF1J1uNulDEzyc6XcMvwGc0cWciw73sMvgOjhlRaPjT3CA/CL6DY0YUksTQBjpjRVSNrYaLEYVGXkKbiP4RURHxdWgbaq+IstVq2Isoy61G8xHlUKtRf0Q52mpU/GNu1UoFa4uNsv+27g1nrT1EIBAIBAJghT+Mm9s2KhDbfwAAAABJRU5ErkJggg==",wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACy0lEQVR4nO1Zu24TQRRdAaGg5FHx+AsQfIgFgj5NZOeeSQGi2Y7QWiQKiCaW0iFCAaHhD1JEAoUPIKQiMRKR7Jld4wy66weOsbUzuzO7RvKRrmTJo/U5O/feOXMdBHPMMUdu6ErlfHt5+Z4ieiqBt5LoqyT6KYE4id7nff6O17SAuzoMzwVloy3ETUn0XBEdKkBbxncJrLaq1RuFEz+pVq8p4JUkijIQPxOy94yNEyGuFkI+Ah5KomZe4hPiOAIeeCOuFxcXFPDaA3F9Johe8m+5Jn9JAh+9k8cwrXb4N12RXyiSvPobn3QYXswtoJC0wdTYyEW+TfSoRPKaIxLifibyv5aWriiio7IFSKJmphbLfb5s8moQROtW5Pl0tDqkhNBxvW5MKFkrhM0uRO1a7ZaxgMQeWJD/vburdberO1tb6eQ3N5O13b09rVZWzEUAq0bk2WSxT7EiP0CKiAH54fI9CxFEh2waUwUkrtIiFUYJDUTEjca/axuNyWvrFqkH3EkVwHbXpsDG3+qknZi2JjZIubFdeGKS/9tWD00R4Yw8kjp4ky4A2Ld98FQRp6e9cEBe9brRF5MdyGyVJ4pwRF71UujIRECuS0oiYvyt93cjF3kkKaRKFdApSEDTZwp1vKcQ/Bdxx3MRbzsh3y9Yk3NCuWyjrg6y0YJ1KOJxqgAeOs2slajVbpuZOaKDrGYu9mXmgG/G0zy2rlnsdOzTThM9MyI/kxcaQLWA64ENeCJgWWD+guhFYAsNXJ6FS70CjjPPTXlWWbaASIhKkAc8qyxRwFqQF3wPlcC7oslL4IMOwwu5BQyHu0Q7hZEneu9suDs2Xi+iM605e/OTwLNKT93pR+6CtZybrvMB4yDXFfd5bttB0eDTMbEdpt5pNIgO2B5Yn7A+wCaLh048t2HPzhcPvtmxHelHUwKf+Tu2xOwqZ+Jv1jnmCP5//AFGuxmMzLZJIgAAAABJRU5ErkJggg==",je=t=>(fe("data-v-1c7e6d91"),t=t(),ve(),t),Or={class:"relative flex justify-center"},Lr=je(()=>c("img",{class:"w-4 h-4",src:Qe},null,-1)),Qr=[Lr],_r={key:0,class:"transition duration-150 ease-in-out absolute flex items-center gap-1 bottom-2 bg-white bg-opacity-85 rounded-full shadow-lg p-2 text-xs"},Vr=je(()=>c("img",{class:"w-4 h-4",src:wt},null,-1)),Kr=["disabled"],Nr={key:0,class:"w-full h-10.5 flex items-center justify-center"},Pr=je(()=>c("svg",{class:"w-6 h-6 text-gray-200 animate-spin fill-blue-300",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),c("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})],-1)),Dr=[Pr],Gr={class:"text-base font-600"},Yr={class:"text-xs"},Xr=O({__name:"LocationModal",setup(t){class e{constructor(b,F,L=null){R(this,"lat");R(this,"lng");R(this,"address");this.lat=b,this.lng=F,this.address=L}get isValid(){return this.address!==null}}const a=Be(),{t:s}=pe(),o=Y(),n=o.state.imkit.config.mapApiKey,r=U(),i=U(new e(21.30895,-157.826182)),u=U({lat:i.value.lat,lng:i.value.lng}),d=h(()=>({position:{lat:i.value.lat,lng:i.value.lng}})),p=U(""),g=U(!1),f=U(10),x=U(!1),B=U(""),K=()=>new Promise((A,b)=>{g.value=!0,navigator.geolocation.getCurrentPosition(F=>{let{latitude:L,longitude:P}=F.coords;B.value="",g.value=!1,A({lat:L,lng:P})},F=>{switch(g.value=!1,F.code){case F.PERMISSION_DENIED:B.value=s("noAccessLocationPermission");break;case F.POSITION_UNAVAILABLE:B.value=s("locationInfoUnavailable");break;case F.TIMEOUT:B.value=s("requestLocationTimeout");break}b(F)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),T=async(A,b)=>{try{const{data:F}=await Se.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${A},${b}&key=${n}`);if(F.error_message)throw new Error(F.error_message);return F.results[0].formatted_address}catch(F){throw B.value=s("addressUnavailable"),F}},S=rt(700,async A=>{var b,F;try{if(A===0){const J=(b=r.value)==null?void 0:b.map.getCenter();if(J){const{lat:te,lng:ie}=J;i.value=new e(te(),ie())}}else if(A===1){const{lat:J,lng:te}=await K();i.value=new e(J,te),f.value=17,(F=r.value)==null||F.map.panTo({lat:J,lng:te})}let{lat:L,lng:P}=i.value;P=((P+180)%360+360)%360-180,L=Math.max(Math.min(L,90),-90),p.value=await T(L,P),i.value=new e(L,P,p.value)}catch(L){console.error(L)}},{noLeading:!1,noTrailing:!1}),k=async()=>{x.value=!0;const A={roomId:o.state.imkit.selectedRoomId,messageType:"location",message:p.value,latitude:d.value.position.lat,longitude:d.value.position.lng};a.closeAll(),await o.dispatch("imkit/sendMessage",A),x.value=!1};return S(1),(A,b)=>(l(),G(I(Ue),{class:"flex items-center justify-center","content-class":"flex flex-col bg-white rounded-lg overflow-hidden w-450px <sm:w-350px","content-transition":"vfm-fade","overlay-transition":"vfm-fade"},{default:se(()=>[c("div",Or,[D(I(lt),{ref_key:"mapRef",ref:r,"api-key":I(n),center:u.value,zoom:f.value,disableDefaultUi:!0,onCenter_changed:b[0]||(b[0]=F=>I(S)(0)),class:"w-450px h-350px <sm:w-350px <sm:h-250px"},{default:se(()=>[D(I(it),{options:d.value},null,8,["options"])]),_:1},8,["api-key","center","zoom"]),c("button",{class:"absolute top-2 right-2 flex items-center justify-center bg-white rounded-full shadow-lg w-9 h-9",onClick:b[1]||(b[1]=F=>I(a).closeAll())},Qr),c("button",{class:"absolute bottom-2 right-2 flex items-center justify-center bg-white rounded-full shadow-lg w-9 h-9",onClick:b[2]||(b[2]=F=>I(S)(1))},[c("img",{class:_(["w-5 h-5",{"animate-pulse":g.value}]),src:Tr},null,2)]),D(Xe,null,{default:se(()=>[B.value?(l(),m("div",_r,[Vr,ae(" "+v(B.value),1)])):C("",!0)]),_:1})]),c("button",{class:"flex flex-col items-center gap-0.5 bg-blue-400 disabled:cursor-not-allowed text-white rounded-lg m-2 p-2",disabled:g.value||x.value||!i.value.isValid,onClick:k},[x.value?(l(),m("div",Nr,Dr)):(l(),m(V,{key:1},[c("div",Gr,v(A.$t("sendCurrentLocation")),1),c("div",Yr,v(p.value),1)],64))],8,Kr)]),_:1}))}});const jr=re(Xr,[["__scopeId","data-v-1c7e6d91"]]),Wr=t=>(fe("data-v-3a9d3650"),t=t(),ve(),t),zr={class:"flex items-center gap-1 flex-grow"},Jr={class:"h-12 bg-gray-100 px-3 rounded-xl w-0 min-w-0 flex-grow flex items-center gap-3 relative"},Hr={key:0,class:"transition duration-150 ease-in-out flex items-center gap-1 bg-white rounded-xl p-2 text-xs text-gray-600"},Zr=Wr(()=>c("img",{class:"w-4 h-4",src:wt},null,-1)),qr={class:"volumes"},$r={class:"text-white font-bold bg-black bg-opacity-30 rounded-full text-xs py-1 px-2 ml-auto"},ei={key:1,class:"cursor-not-allowed ml-2 mr-1 w-6 h-6",src:ft},st="audio/webm",ti=180,si=O({__name:"AudioInput",setup(t){const{t:e}=pe(),a=Y(),s=U(3),o=U(),n=U(),r=U(0),i=U(0),u=U(),d=U(),p=Wt([]),g=U(""),f=h(()=>r.value>1),x=async()=>{var K,T;try{switch(s.value){case 3:{s.value=0,p.splice(0),r.value=0,i.value=0,o.value=await navigator.mediaDevices.getUserMedia({video:!1,audio:!0}),n.value=new Jt.RecordRTCPromisesHandler(o.value,{type:"audio",mimeType:st});let S=new AudioContext,k=S.createAnalyser();k.fftSize=64,k.smoothingTimeConstant=0,S.createMediaStreamSource(o.value).connect(k),d.value=window.setInterval(()=>{let b=new Uint8Array(k.frequencyBinCount);k.getByteFrequencyData(b);let F=b.reduce((P,J)=>P+J)/b.length;const L=Math.min(1,F/128);p.unshift(L)},100),await n.value.startRecording(),i.value=Date.now(),u.value=window.setInterval(()=>{r.value=(Date.now()-i.value)/1e3,r.value>=ti&&x()},1e3),s.value=1;break}case 1:s.value=2,await((K=n.value)==null?void 0:K.stopRecording()),(T=o.value)==null||T.getTracks().forEach(S=>S.stop()),clearInterval(u.value),clearInterval(d.value),s.value=3;break;default:break}}catch(S){console.error(S),g.value=e("noAccessMicrophonePermission")}},B=async()=>{var T;s.value!==3&&await x(),p.splice(0),r.value=0,i.value=0;let K=await((T=n.value)==null?void 0:T.getBlob());if(K){const S=await Ht(K),k=new File([K],`${Te()}.webm`),A={roomId:a.state.imkit.selectedRoomId,messageType:"audio",file:k,duration:S,originalUrl:"",extra:{mimeType:st,fileName:k.name.split(".").slice(0,-1).join("."),bytes:k.size,fileExtension:k.name.split(".").pop()}};await a.dispatch("imkit/sendMessage",A)}};return zt(()=>{clearInterval(u.value),clearInterval(d.value)}),(K,T)=>(l(),m("div",zr,[c("div",Jr,[c("div",{class:"w-8 h-8 border border-2px border-gray-300 rounded-full flex items-center justify-center flex-shrink-0",onClick:x},[c("div",{class:_(["bg-red-500 rounded-full w-6 h-6 transition-all ease-in duration-200",{"w-3.5 h-3.5 rounded":s.value==1,"bg-red-300 cursor-not-allowed":g.value}])},null,2)]),D(Xe,null,{default:se(()=>[g.value?(l(),m("div",Hr,[Zr,ae(" "+v(g.value),1)])):C("",!0)]),_:1}),c("div",qr,[(l(!0),m(V,null,Z(p,(S,k)=>(l(),m("div",{key:k,class:"w-0.5 bg-gray-400 rounded flex-shrink-0 !min-h-0.5",style:X({height:`${S*28}px`})},null,4))),128))]),c("div",$r,v(Math.floor(r.value/60))+":"+v(`${Math.floor(r.value%60)}`.padStart(2,"0")),1)]),f.value?(l(),m("img",{key:0,class:"cursor-pointer ml-2 mr-1 w-6 h-6",src:ht,onClick:B})):(l(),m("img",ei))]))}});const oi=re(si,[["__scopeId","data-v-3a9d3650"]]),Ce=t=>(fe("data-v-32000f08"),t=t(),ve(),t),ai=["onDrop"],ni={class:"flex items-center p-3 gap-3 border-b border-solid"},ri={key:2,class:"h-40px w-40px relative"},ii={class:"text-base text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap"},li={key:0,slot:"header",class:"w-full h-12 flex items-center justify-center"},ci=Ce(()=>c("svg",{class:"w-6 h-6 text-gray-200 animate-spin fill-blue-400",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[c("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),c("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})],-1)),di=[ci],ui={key:0,class:"text-sm text-gray-900 px-2"},mi={class:"flex items-end justify-center p-2 relative gap-3 pl-3"},gi={key:1,class:"absolute left-2 bottom-64px p-1.5 bg-white z-10 rounded-lg shadow-md flex items-stretch gap-1 text-gray-900"},pi=Ce(()=>c("img",{class:"w-6 h-6",src:va},null,-1)),Ai={class:"text-xs"},hi=Ce(()=>c("img",{class:"w-6 h-6",src:ka},null,-1)),fi={class:"text-xs"},vi={key:3,class:"bg-gray-100 p-3 rounded-lg flex flex-grow flex-col items-stretch relative"},ki={class:"flex items-center bg-gray-100 gap-3"},yi={class:"flex flex-col flex-grow justify-center items-stretch gap-3 w-0 min-w-0"},wi=["placeholder","onKeydown"],bi={key:0,class:"flex gap-3"},xi=["src"],Ci=["onClick"],Ii=Ce(()=>c("img",{src:wa,width:"24",height:"24"},null,-1)),Ri=[Ii],Ei=Ce(()=>c("img",{src:ba,width:"24",height:"24"},null,-1)),Si=[Ei],Fi=Ce(()=>c("img",{src:xa,width:"24",height:"24"},null,-1)),Bi={key:1,class:"cursor-not-allowed my-auto ml-0.5 mr-1 w-6 h-6",src:ft},Ui=O({__name:"ChatRoom",setup(t){const e=Y(),a=ct(),{open:s}=xe({component:jr}),o=h(()=>e.state.imkit.rooms[e.state.imkit.selectedRoomId]),n=h(()=>e.state.imkit.selectedRoomId),r=h(()=>!!e.state.imkit.isRequesting[`/rooms/${e.state.imkit.selectedRoomId}/messages/v3`]),i=h(()=>e.state.imkit.sortedMessages),u=h(()=>a.query.roomId),d=h(()=>i.value.at(-1)),p=h(()=>e.state.imkit.isRoomInfoVisible),g=h(()=>e.state.imkit.navigationTargetId),f=U(null),x=U(""),B=U(!1),K=U(!1),T=U(!1),S=U(!1),k=U(),A=U([]),b=U([]),F=U(!1),L=U(!1),P=U(!0),J=U(),te=U(W().subtract(5,"second")),ie=U(!1),We=h(()=>e.state.imkit.replyId),ze=h(()=>{const{t:M}=pe(),Q=Object.keys(e.state.imkit.isTyping);return Q.length>0?Q.map(N=>{var H;return((H=e.state.imkit.users[N])==null?void 0:H.nickname)??""}).join(", ")+M("isTyping"):""}),Je=async()=>{const M=async()=>{if(x.value){const{replyId:N}=e.state.imkit,H={roomId:o.value.id,messageType:"text",message:x.value.trim(),reply:N||null};x.value="",await e.dispatch("imkit/sendMessage",H),e.commit("imkit/setState",{replyId:null})}},Q=async()=>{if(A.value.length>0){const N={roomId:o.value.id,messageType:"image",images:A.value,files:b.value};A.value=[],b.value=[],await e.dispatch("imkit/sendMessage",N)}};await Promise.all([Q(),M()])},xt=async()=>{var Q;const M=await e.dispatch("imkit/fetchMessages",o.value.id);M&&M.length>0&&((Q=f.value)==null||Q.scrollToIndex(M.length))},Ct=()=>{L.value=!1},It=M=>{x.value+=M.i,T.value=!1},Rt=()=>{var M;(M=k.value)==null||M.click()},Et=async M=>{var ke;const N=Array.from(((ke=M==null?void 0:M.target)==null?void 0:ke.files)||[]).filter(q=>q.size<2e7);if(N.length===0||N.length>10)return;const H=N.filter(q=>q.type.startsWith("image")),j=N.filter(q=>q.type.startsWith("video")),ce=N.filter(q=>!q.type.startsWith("image")&&!q.type.startsWith("video"));if(H.length>0){const q=await Promise.all(H.map(Ke)),ye={roomId:o.value.id,messageType:"image",images:q,files:Array.from(N)};await e.dispatch("imkit/sendMessage",ye)}if(j.length>0)for(const q of j){const ye=await Cr(q),{width:Ot,height:Lt,duration:Qt}=ye,_t={roomId:o.value.id,messageType:"video",video:ye,file:q,width:Ot,height:Lt,duration:Qt};await e.dispatch("imkit/sendMessage",_t)}if(ce.length>0)for(const q of ce){const ye={roomId:o.value.id,messageType:"file",file:q,originalUrl:"",extra:{mimeType:q.type,fileName:q.name.split(".").slice(0,-1).join("."),bytes:q.size,fileExtension:q.name.split(".").pop()}};await e.dispatch("imkit/sendMessage",ye)}k.value&&(k.value.value="")},St=async M=>{const Q=((M==null?void 0:M.dataTransfer)||{}).files||[];if(Q.length===0||Q.length>10)return;const N=await Promise.all(Array.from(Q).map(Ke)),H={roomId:o.value.id,messageType:"image",images:N,files:Array.from(Q)};await e.dispatch("imkit/sendMessage",H)},He=M=>{M.preventDefault()},Ft=async M=>{const N=(M.clipboardData||{}).files;N.length===0||N.length>10||(M.preventDefault(),A.value=A.value.concat(await Promise.all(Array.from(N).map(Ke))),b.value=b.value.concat(Array.from(N)))},Bt=()=>{e.commit("imkit/setState",{selectedRoomId:""})},Ut=M=>{A.value.splice(M,1),b.value.splice(M,1)};me(n,async(M,Q)=>{M!==Q&&(F.value=!1,e.commit("imkit/clearChatRoom"),Promise.all([e.dispatch("imkit/fetchMessages",M),e.dispatch("imkit/fetchRoom",M)]).finally(()=>{var N,H;(((N=o.value)==null?void 0:N.numberOfUnread)??0)>0&&(e.dispatch("imkit/updateLastRead",M),e.dispatch("imkit/insertUnreadMessage"));for(const j of e.state.imkit.deliveringMessages.values())j.roomId===M&&e.commit("imkit/pushMessage",j);(H=f.value)==null||H.scrollToBottom(),F.value=!0}))},{immediate:!0}),me([()=>i.value.length,()=>d.value],([M],[Q])=>{var N,H,j,ce,ke;M-Q>1||(((N=f.value)==null?void 0:N.getOffset())+((H=f.value)==null?void 0:H.getClientSize())==((j=f.value)==null?void 0:j.getScrollSize())||((ce=i.value[i.value.length-1])==null?void 0:ce.senderId)===e.state.imkit.uid?(L.value=!1,(ke=f.value)==null||ke.scrollToBottom()):L.value=!0)}),me(g,M=>{var N;if(!M)return;const Q=i.value.findIndex(H=>H.id===M);Q!==-1&&((N=f.value)==null||N.scrollToIndex(Q)),e.commit("imkit/setState",{navigationTargetId:""})}),me(We,()=>{We.value&&(S.value=!1,setTimeout(()=>{var M;(M=J.value)==null||M.focus()},0))}),me(x,()=>{if(te.value.add(5,"second")>W())return;te.value=W();const{socket:M,selectedRoomId:Q}=e.state.imkit;M.emit("typing",Q)});const Mt=()=>{setTimeout(()=>{B.value=!1},0)},Tt=M=>{!B.value&&M.keyCode==13&&!M.shiftKey&&!P.value&&(M.preventDefault(),Je())};return(M,Q)=>{var H;const N=he("click-outside");return o.value?(l(),m("div",{key:0,class:"flex flex-col h-full bg-white",onDrop:ne(St,["prevent"]),onDragenter:He,onDragover:He},[c("div",ni,[u.value?C("",!0):(l(),m("img",{key:0,src:Aa,class:"cursor-pointer sm:hidden",width:"36",height:"36",onClick:Bt})),o.value.avatars.length===1?(l(),G(ee,{key:1,url:o.value.avatars[0].url,name:o.value.avatars[0].name,class:"h-40px w-40px text-lg"},null,8,["url","name"])):(l(),m("div",ri,[D(ee,{url:o.value.avatars[1].url,name:o.value.avatars[1].name,class:"h-28px w-28px text-sm rounded-xl absolute top-0 right-0"},null,8,["url","name"]),D(ee,{url:o.value.avatars[0].url,name:o.value.avatars[0].name,class:"h-30px w-30px text-sm rounded-xl absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100"},null,8,["url","name"])])),c("div",ii,v(o.value.displayName),1),c("img",{src:ha,class:"cursor-pointer ml-auto",width:"30",height:"30",onClick:Q[0]||(Q[0]=j=>I(e).commit("imkit/setState",{isRoomInfoVisible:!p.value}))})]),D(I(Ye),{class:_(["p-2 h-100vh overflow-auto",{"opacity-0":!F.value&&!r.value}]),ref_key:"vl",ref:f,"data-key":"id","data-sources":i.value,"data-component":fr,"wrap-class":"flex flex-col","estimated-size":66,keeps:50,onTotop:xt,onTobottom:Ct},{header:se(()=>[r.value?(l(),m("div",li,di)):C("",!0)]),footer:se(()=>[ze.value?(l(),m("div",ui,v(ze.value),1)):C("",!0)]),_:1},8,["class","data-sources"]),c("div",mi,[L.value?(l(),m("div",{key:0,class:"absolute -top-10 h-10 bg-gray-200 bg-opacity-90 w-full flex items-center px-3 cursor-pointer",onClick:Q[1]||(Q[1]=(...j)=>f.value.scrollToBottom&&f.value.scrollToBottom(...j))},v((H=o.value.lastMessage)==null?void 0:H.string),1)):C("",!0),c("img",{src:fa,class:_(["w-5 h-12 cursor-pointer object-contain transform transition flex-shrink-0",{"rotate-45":S.value}]),onClick:Q[2]||(Q[2]=()=>{S.value?S.value=!1:ie.value=!0})},null,2),ie.value?$((l(),m("div",gi,[c("div",{class:"flex flex-col items-center justify-center gap-1 p-2 w-16 cursor-pointer",onClick:Q[3]||(Q[3]=(...j)=>I(s)&&I(s)(...j))},[pi,c("div",Ai,v(M.$t("location")),1)]),c("div",{class:"flex flex-col items-center justify-center gap-1 p-2 w-16 cursor-pointer",onClick:Q[4]||(Q[4]=()=>{ie.value=!1,S.value=!0})},[hi,c("div",fi,v(M.$t("audio")),1)])])),[[N,()=>{ie.value=!1}]]):C("",!0),S.value?(l(),G(oi,{key:2})):(l(),m("div",vi,[D(Mr),c("div",ki,[c("div",yi,[$(c("textarea",{ref_key:"input",ref:J,type:"text",class:_(["bg-gray-100 outline-none h-6 resize-none flex-grow",{"!h-12":x.value.split(`
`).length===2,"!h-18":x.value.split(`
`).length>2}]),placeholder:M.$t("TypeMessage"),"onUpdate:modelValue":Q[5]||(Q[5]=j=>x.value=j),onCompositionstart:Q[6]||(Q[6]=j=>B.value=!0),onCompositionend:Mt,onKeydown:Zt(Tt,["enter"]),onPaste:Ft},null,42,wi),[[Ee,x.value]]),A.value.length>0?(l(),m("div",bi,[(l(!0),m(V,null,Z(A.value,(j,ce)=>(l(),m("div",{key:`${j.id}-${ce}`,class:"relative w-12 h-12 group"},[c("img",{src:j.thumbnailUrl,class:"w-full h-full absolute left-0 bottom-0 rounded-lg object-cover bg-gray-200"},null,8,xi),c("img",{src:ya,class:"w-5 h-5 absolute -right-2 -top-2 cursor-pointer hidden group-hover:block",onClick:ke=>Ut(ce)},null,8,Ci)]))),128))])):C("",!0)]),c("button",{class:"flex-shrink-0",onClick:Q[7]||(Q[7]=j=>K.value=!0)},Ri),c("button",{class:"flex-shrink-0",onClick:Q[8]||(Q[8]=j=>T.value=!0)},Si),c("button",{class:"flex-shrink-0",onClick:Rt},[Fi,c("input",{ref_key:"fileInput",ref:k,type:"file",multiple:"true",onChange:Et,class:"hidden"},null,544)])]),K.value?$((l(),G(xr,{key:0,onClose:Q[9]||(Q[9]=()=>{K.value=!1})},null,512)),[[N,()=>{K.value=!1}]]):C("",!0),T.value?$((l(),G(I(qt),{key:1,class:"overflow-auto absolute right-0 bottom-[110%]",native:!0,onSelect:It},null,512)),[[N,()=>{T.value=!1}]]):C("",!0)])),P.value&&!S.value?(l(),m(V,{key:4},[x.value.length>0?(l(),m("img",{key:0,class:"cursor-pointer my-auto ml-0.5 mr-1 w-6 h-6",src:ht,onClick:Je})):(l(),m("img",Bi))],64)):C("",!0)])],40,ai)):C("",!0)}}});const ot=re(Ui,[["__scopeId","data-v-32000f08"]]),Mi={count:0,config:{},uid:"",axios:Se,isRequesting:{},socket:dt({autoConnect:!1}),imageCache:Ze(),translationCache:Ze(),users:{},rooms:{},sortedRooms:[],numberOfFetchedRooms:0,numberOfTotalRooms:0,uploadProgresses:{},downloadProgresses:{},linkPreviews:{},actionMenuRoomId:"",folders:{},sortedFolderIds:[],roomIdsInFolders:{},selectedRoomIdsForCreateFolder:{},selectedFolderId:"",searchKeyword:"",searchType:oe.RoomName,searchRooms:{},roomTag:"",deliveringMessages:new Map,selectedRoomId:"",messages:{},sortedMessages:[],numberOfTotalMessages:-1,messageGroupHead:{},messageGroupTail:{},replyId:"",navigationTargetId:"",isRoomInfoVisible:!1,isTyping:{}};var w=(t=>(t.increment="increment",t.fetchRooms="fetchRooms",t.fetchRoom="fetchRoom",t.fetchMessages="fetchMessages",t.updateLastRead="updateLastRead",t.handleMessageFromSocket="handleMessageFromSocket",t.handleRoomFromSocket="handleRoomFromSocket",t.handleLastReadFromSocket="handleLastReadFromSocket",t.sendMessage="sendMessage",t.recallMessage="recallMessage",t.uploadMedia="uploadMedia",t.fetchLinkPreview="fetchLinkPreview",t.handleLinkPreviews="handleLinkPreviews",t.fetchVideoBlob="fetchVideoBlob",t.navigateToMessage="navigateToMessage",t.uploadImage="uploadImage",t.updateRoomPrefs="updateRoomPrefs",t.fetchPrefs="fetchPrefs",t.updatePref="updatePref",t.deletePref="deletePref",t.updateFolder="updateFolder",t.removeFolder="removeFolder",t.handlePrefChangeFromSocket="handlePrefChangeFromSocket",t.handlePrefDeleteFromSocket="handlePrefDeleteFromSocket",t.aggregateRoomsAndFolders="aggregateRoomsAndFolders",t.removeMembers="removeMembers",t.handleTypingFromSocket="handleTypingFromSocket",t.insertUnreadMessage="insertUnreadMessage",t.translate="translate",t.searchRooms="searchRooms",t.subscribe="subscribe",t.unsubscribe="unsubscribe",t.removeRoomFromFolder="removeRoomFromFolder",t.addRoomToFolder="addRoomToFolder",t.fetchRoomsInFolders="fetchRoomsInFolders",t))(w||{}),y=(t=>(t.increment="increment",t.setState="setState",t.updateField="updateField",t.deleteField="deleteField",t.updateRoom="updateRoom",t.updateLastRead="updateLastRead",t.concatMessages="concatMessages",t.pushMessage="pushMessage",t.replaceMessage="replaceMessage",t.clearChatRoom="clearChatRoom",t.deleteRoom="deleteRoom",t.recallMessage="recallMessage",t.insertUnreadMessage="insertUnreadMessage",t.setMap="setMap",t.deleteMap="deleteMap",t))(y||{});class we{constructor(e,a,s){R(this,"id");R(this,"name");R(this,"roomIds");this.id=e,this.name=a,this.roomIds=s}get payload(){return{children:this.roomIds.map(e=>({id:e,type:"room"}))}}}const Ti={[w.increment]({commit:t}){t(y.increment)},async[w.fetchRooms]({state:t,commit:e,dispatch:a},{pageSize:s}={pageSize:void 0}){if(t.isRequesting[ue.FetchRooms])return;const{numberOfFetchedRooms:o,uid:n}=t;if(o===t.numberOfTotalRooms&&o>0)return;const r=s!==void 0?s:Math.min(Math.max(30,o),120),{data:{result:i}}=await t.axios.get(ue.FetchRooms,{params:{skip:o,limit:r,q:t.roomTag?`{ "members": "${n}", "roomTags": "${t.roomTag}" }`:`{ "members": "${n}" }`}}),{data:u,totalCount:d}=i,p={},g={};for(const f of u){p[f._id]=new Re(f);for(const x of f.members)g[x.id]||(g[x.id]=new ge(x))}e(y.updateField,{key:"rooms",value:p}),e(y.updateField,{key:"users",value:g}),e(y.setState,{numberOfTotalRooms:d,numberOfFetchedRooms:o+r}),a(w.aggregateRoomsAndFolders)},async[w.handleMessageFromSocket]({state:t,commit:e,dispatch:a},s){let o=t.rooms[s.roomId];if(o){const{id:n,numberOfUnread:r}=o;if(s.roomId===t.selectedRoomId){if(await a(w.handleLinkPreviews,[s]),t.config.translationApiKey&&s.type===E.Text&&s.senderId!==t.uid){const i=s.text;try{const u=await a(w.translate,i);s.translatedText=u!==i?u:null}catch(u){console.error(u)}}e(y.pushMessage,s),e(y.updateRoom,{id:n,updatedAt:s.createdAt,lastMessage:s,numberOfUnread:0}),a(w.updateLastRead,n),e(y.setState,{numberOfTotalMessages:t.numberOfTotalMessages+1})}else e(y.updateRoom,{id:n,updatedAt:s.createdAt,lastMessage:s,numberOfUnread:r+1});a(w.aggregateRoomsAndFolders)}else await a(w.fetchRoom,s.roomId),o=t.rooms[s.roomId]},async[w.fetchMessages]({state:t,commit:e,dispatch:a},s){var K;const o=`/rooms/${s}/messages/v3`;if(t.isRequesting[o]||t.sortedMessages.length>=t.numberOfTotalMessages&&t.numberOfTotalMessages!==-1)return;const{data:{result:n}}=await t.axios.get(o,{params:{limit:30,beforeMessage:(K=t.sortedMessages[0])==null?void 0:K.id}}),{data:r,totalCount:i}=n,u={},d=T=>{const S=z.fromRaw(T);return S?[S].concat(d(T.reply)):[]};if(r.flatMap(T=>d(T)).forEach(T=>{u[T.id]=T}),await a(w.handleLinkPreviews,Object.values(u)),t.config.translationApiKey){const T=Object.values(u).filter(k=>k.type===E.Text&&k.senderId!==t.uid),S=await Promise.allSettled(T.map(k=>a(w.translate,k.text)));for(let k=0;k<T.length;k++){const A=S[k];A.status==="fulfilled"&&A.value!==T[k].text&&(T[k].translatedText=Fe.linkfy(A.value))}}const p={};for(const T of r)p[T.sender.id]||(p[T.sender.id]=new ge(T.sender));e(y.updateField,{key:"users",value:p}),e(y.concatMessages,{messages:u,messageIds:r.map(T=>T._id)}),i>t.numberOfTotalMessages&&e(y.setState,{numberOfTotalMessages:i});let g=[];const f={},x={};let B=null;for(const T of t.sortedMessages)T.groupId!==B&&(g.length>0&&(f[g[0].id]=!0,x[g[g.length-1].id]=!0),g=[],B=T.groupId),g.push(T);return g.length>0&&(f[g[0].id]=!0,x[g[g.length-1].id]=!0),e(y.setState,{messageGroupHead:f,messageGroupTail:x}),r},async[w.fetchRoom]({state:t,commit:e},a){const{data:{result:s}}=await t.axios.get(`/rooms/${a}`),o=new Re(s),n={};n[o.id]=o,e(y.updateField,{key:"rooms",value:n});const r={};s.members.flatMap(i=>[...i.members,i]).forEach(i=>{r[i.id]||(r[i.id]=new ge(i))}),e(y.updateField,{key:"users",value:r})},async[w.updateLastRead]({state:t,commit:e},a){var r;const s=`/rooms/${a}/lastRead`;if(t.isRequesting[s])return;const o=t.rooms[a],{data:{result:n}}=await t.axios.put(s,{message:(r=o.lastMessage)==null?void 0:r.id});n&&e(y.updateRoom,{id:a,numberOfUnread:0})},async[w.handleRoomFromSocket]({commit:t,dispatch:e},a){const s={};s[a.id]=a,await t(y.updateField,{key:"rooms",value:s}),e(w.aggregateRoomsAndFolders)},async[w.handleLastReadFromSocket]({commit:t},e){t(y.updateLastRead,e)},async[w.sendMessage]({state:t,commit:e,dispatch:a},s){const{roomId:o}=s;if(!o)return;const n=z.fromPayload(s,t.uid);if(!n)return;if(e(y.setMap,{mapName:"deliveringMessages",key:n.id,value:n}),e(y.pushMessage,n),s.messageType===E.Image){const{files:u}=s,d=await Promise.all(s.images.map((g,f)=>a(w.uploadImage,{image:g,file:u[f]}))),p=[];s.images.forEach((g,f)=>{t.imageCache.set(d[f].thumbnailUrl,g.thumbnailUrl);const{id:x,width:B,height:K}=g;p.push({originalUrl:d[f].originalUrl,thumbnailUrl:d[f].thumbnailUrl,width:B,height:K}),e(y.deleteField,{key:"uploadProgresses",value:`${x}-original`}),e(y.deleteField,{key:"uploadProgresses",value:`${x}-thumbnail`})}),s.images=p,delete s.files}else if(s.messageType===E.Video){const{file:u,video:d}=s,p=d.thumbnailFile;if(!p)return;const g=await Promise.all([a(w.uploadMedia,{id:p.id,file:p.file}),a(w.uploadMedia,{id:d.id,file:u})]);s.width=d.width,s.height=d.height,s.duration=d.duration,s.thumbnailUrl=g[0],s.originalUrl=g[1],t.imageCache.set(g[0],d.thumbnailUrl),delete s.file,e(y.deleteField,{key:"uploadProgresses",value:d.id})}else if(s.messageType===E.File){const{file:u}=s,d=await a(w.uploadMedia,{id:n.id,file:u});s.originalUrl=d,delete s.file,e(y.deleteField,{key:"uploadProgresses",value:n.id})}else if(s.messageType===E.Audio){const{file:u}=s,d=await a(w.uploadMedia,{id:n.id,file:u});s.originalUrl=d,delete s.file,e(y.deleteField,{key:"uploadProgresses",value:n.id})}const{data:{result:r}}=await t.axios.post(`/rooms/${o}/message`,s),i=z.fromRaw(r);if(i)return e(y.deleteMap,{mapName:"deliveringMessages",key:n.id}),await a(w.handleLinkPreviews,[i]),i.roomId===t.selectedRoomId?e(y.replaceMessage,{message:i,targetMessageId:n.id}):e(y.updateRoom,{id:i.roomId,updatedAt:i.createdAt,lastMessage:i}),i},async[w.recallMessage]({state:t,commit:e},a){const{roomId:s}=a;if(!s)return;const{data:{result:o}}=await t.axios.post(`/rooms/${s}/message`,a),n=z.fromRaw(o);n&&e(y.recallMessage,n)},async[w.uploadMedia]({state:t,commit:e},{id:a,file:s}){const o=new FormData;o.append("file",s);const{data:{result:{_id:n}}}=await t.axios.post("/files/chatserver-upload",o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:r=>{const{total:i}=r;i&&e(y.updateField,{key:"uploadProgresses",value:{[a]:r.loaded/i}})}});return`${t.config.domain}/files/chatserver-upload/${n}`},async[w.uploadImage]({dispatch:t},{image:e,file:a}){if(a.size>1024*1024)try{const o=await $t(a,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}),n=await Promise.all([t(w.uploadMedia,{id:`${e.id}-original`,file:a}),t(w.uploadMedia,{id:`${e.id}-thumbnail`,file:o})]);return{originalUrl:n[0],thumbnailUrl:n[1]}}catch(o){console.error(o)}const s=await t(w.uploadMedia,{id:`${e.id}-original`,file:a});return{originalUrl:s,thumbnailUrl:s}},async[w.fetchLinkPreview](t,e){const{data:a}=await Se.get(encodeURI(`https://url.imkit.io/?url=${e}`));return a},async[w.handleLinkPreviews]({state:t,commit:e,dispatch:a},s){const o=Array.from(new Set(s.flatMap(i=>(i==null?void 0:i.urls)||[]).filter(i=>!t.linkPreviews[i])));if(o.length===0)return;const n={};(await Promise.allSettled(o.map(i=>a(w.fetchLinkPreview,i)))).forEach((i,u)=>{i.status==="fulfilled"&&(n[o[u]]=i.value)}),e(y.updateField,{key:"linkPreviews",value:n})},async[w.fetchVideoBlob]({state:t},e){const{data:a}=await t.axios.get(e,{responseType:"blob"});return a},async[w.navigateToMessage]({state:t,commit:e,dispatch:a},s){let o=!1;for(;!o;)if(o=t.messages[s]!==void 0&&t.sortedMessages.findIndex(n=>n.id===s)>-1,o)e(y.setState,{navigationTargetId:s});else if(t.sortedMessages.length<t.numberOfTotalMessages||t.numberOfTotalMessages===-1)await a(w.fetchMessages,t.selectedRoomId);else break},async[w.updateRoomPrefs]({state:t,commit:e,dispatch:a},{roomId:s,prefs:o}){await t.axios.post(`/roomPrefs/${s}`,o);const n=t.rooms[s];n&&(e(y.updateRoom,{id:s,pref:{...n.pref,...o}}),a(w.aggregateRoomsAndFolders))},async[w.fetchPrefs]({state:t,commit:e}){const{data:{result:a}}=await t.axios.get("/me/pref"),s={},o=[],n={},r={},i={};for(const u of a)if(u.key==="folders-meta")for(const d of u.data)n[d.key]=d.name,o.push(d.key);else{if(u.key==="blackList")continue;r[u.key]=u.data.children.map(d=>d.id)}for(const u of o){s[u]=new we(u,n[u],r[u]||[]);for(const d of r[u]||[])i[d]=!0}e(y.setState,{folders:s,sortedFolderIds:o,roomIdsInFolders:i})},async[w.fetchRoomsInFolders]({state:t,dispatch:e}){const a=Object.keys(t.roomIdsInFolders).length;for(;t.numberOfFetchedRooms<a;)await e(w.fetchRooms,{pageSize:200});const s=es(6),o=Object.keys(t.roomIdsInFolders).filter(n=>!t.rooms[n]).map(n=>s(()=>e(w.fetchRoom,n)));await Promise.allSettled(o)},async[w.updatePref]({state:t},{key:e,value:a}){return await t.axios.post(`/me/pref/${e}`,a)},async[w.deletePref]({state:t},e){return await t.axios.delete(`/me/pref/${e}`)},async[w.updateFolder]({state:t,dispatch:e,commit:a},{folderKey:s,name:o}){const n=Object.keys(t.selectedRoomIdsForCreateFolder).filter(i=>t.selectedRoomIdsForCreateFolder[i]);await e(w.updatePref,{key:"folders-meta",value:t.sortedFolderIds.map(i=>t.folders[i]).filter(i=>!!i&&i.id!==s).map(i=>({key:i.id,name:i.name})).concat([{key:s,name:o}]).sort((i,u)=>i.key.localeCompare(u.key))}),await e(w.updatePref,{key:s,value:{children:n.map(i=>({id:i,type:"room"}))}}),t.folders[s]&&a(y.updateField,{key:"roomIdsInFolders",value:t.folders[s].roomIds.reduce((i,u)=>(i[u]=!1,i),{})});const r=new we(s,o,n);a(y.updateField,{key:"folders",value:{[s]:r}}),a(y.updateField,{key:"roomIdsInFolders",value:n.reduce((i,u)=>(i[u]=!0,i),{})}),a(y.setState,{sortedFolderIds:[...new Set([...t.sortedFolderIds,s])],selectedRoomIdsForCreateFolder:{}}),e(w.aggregateRoomsAndFolders)},async[w.removeFolder]({state:t,dispatch:e},a){await e(w.deletePref,a),await e(w.updatePref,{key:"folders-meta",value:t.sortedFolderIds.map(s=>t.folders[s]).filter(s=>!!s&&s.id!==a).map(s=>({key:s.id,name:s.name}))}),e(w.handlePrefDeleteFromSocket)},async[w.handlePrefChangeFromSocket]({state:t,commit:e,dispatch:a},s){const{key:o,data:n}=s;if(o==="folders-meta"){const r={},i=[];for(const{key:u,name:d}of n){const p=t.folders[u]||new we(u,d,[]);r[u]=p,i.push(u)}e(y.setState,{folders:r,sortedFolderIds:i})}else{const{id:r,name:i}=t.folders[o];if(r){const u=n.children.map(p=>p.id),d=new we(r,i,u);e(y.updateField,{key:"folders",value:{[o]:d}}),e(y.updateField,{key:"roomIdsInFolders",value:u.reduce((p,g)=>(p[g]=!0,p),{})})}}a(w.aggregateRoomsAndFolders)},async[w.handlePrefDeleteFromSocket]({state:t,commit:e,dispatch:a},s){const o=t.folders[s];if(!o)return;const n={};for(const r of o.roomIds)n[r]=!1;e(y.deleteField,{key:"folders",value:s}),e(y.updateField,{key:"roomIdsInFolders",value:n}),e(y.setState,{sortedFolderIds:t.sortedFolderIds.filter(r=>r!==s)}),a(w.aggregateRoomsAndFolders)},async[w.aggregateRoomsAndFolders]({state:t,commit:e}){const a=Object.values(t.rooms).filter(s=>!t.roomIdsInFolders[s.id]).sort((s,o)=>{var n,r,i;return((n=s.pref)==null?void 0:n.sticky)===((r=o.pref)==null?void 0:r.sticky)?o.updatedAt-s.updatedAt:(i=s.pref)!=null&&i.sticky?-1:1});e(y.setState,{sortedRooms:a})},async[w.removeMembers]({state:t,commit:e},{roomId:a,uids:s}){var n;if(t.rooms[a]&&(await t.axios.post(`/rooms/${a}/delete/members`,{systemMessage:!0,members:s}),s.includes(t.uid))){e(y.deleteRoom,a);const r=(n=t.sortedRooms.find(i=>i.numberOfUnread===0))==null?void 0:n.id;r&&e(y.setState,{selectedRoomId:r})}},async[w.handleTypingFromSocket]({state:t,commit:e},a){const{room:s,sender:o}=a;if(s!==t.selectedRoomId||o===t.uid)return;const n=t.isTyping[o];n!==void 0&&clearTimeout(n);const r=setTimeout(()=>{e(y.deleteField,{key:"isTyping",value:o})},6e3);e(y.updateField,{key:"isTyping",value:{[o]:r}})},async[w.insertUnreadMessage]({state:t,commit:e}){const a=t.rooms[t.selectedRoomId];if(!a)return;const s=a.lastReadMessageId[t.uid];if(!s)return;const o=t.messages[s];if(!o)return;const n=z.fromPayload({messageType:E.Announcement,message:"以下為尚未閱讀的訊息",createdAtMS:o.createdAt+1},t.uid);n&&e(y.insertUnreadMessage,{lastReadMessageId:s,message:n})},async[w.translate]({state:t},e){if(t.translationCache.has(e))return t.translationCache.get(e)||e;let a=navigator.language.split("-")[0];const s={am:"am",ar:"ar",eu:"eu",bn:"bn","en-gb":"en-GB","pt-br":"pt-BR",bg:"bg",ca:"ca",chr:"chr",hr:"hr",cs:"cs",da:"da",nl:"nl",en:"en",et:"et",fil:"fil",fi:"fi",fr:"fr",de:"de",el:"el",gu:"gu",iw:"iw",hi:"hi",hu:"hu",is:"is",id:"id",it:"it",ja:"ja",kn:"kn",ko:"ko",lv:"lv",lt:"lt",ms:"ms",ml:"ml",mr:"mr",no:"no",pl:"pl","pt-pt":"pt-PT",ro:"ro",ru:"ru",sr:"sr","zh-cn":"zh-CN",sk:"sk",sl:"sl",es:"es",sw:"sw",sv:"sv",ta:"ta",te:"te",th:"th","zh-tw":"zh-TW",tr:"tr",ur:"ur",uk:"uk",vi:"vi",cy:"cy"};s[navigator.language.toLowerCase()]&&(a=s[navigator.language.toLowerCase()]);const o=await fetch("https://translation.googleapis.com/language/translate/v2",{method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:new URLSearchParams({q:e,key:t.config.translationApiKey,target:a}),redirect:"follow"}).then(n=>n.json()).then(n=>{var r;return(r=n.data)==null?void 0:r.translations[0].translatedText});return t.translationCache.set(e,o),o},async[w.searchRooms]({state:t,commit:e},a){if(t.isRequesting[ue.SearchRooms])return;const s=Object.values(oe),{data:{result:o}}=await t.axios.post(ue.SearchRooms,{type:s,keyword:a}),n={},r={},i={};for(const p of s)o[p].forEach(g=>{n[g._id]=new Re(g),i[p]||(i[p]=[]),i[p].push(n[g._id]);for(const f of g.members)r[f.id]||(r[f.id]=new ge(f))});for(const p of Object.values(t.folders))p.name.includes(a)&&(i[oe.RoomPrefFolder]||(i[oe.RoomPrefFolder]=[]),i[oe.RoomPrefFolder].push(p));const u=Object.keys(i),d=u.length>0?u[0]:oe.RoomName;e(y.updateField,{key:"rooms",value:n}),e(y.updateField,{key:"users",value:r}),e(y.setState,{searchRooms:i,searchType:d,searchKeyword:a})},async[w.subscribe]({state:t}){if(!t.config.firebaseConfig||!t.config.firebaseVapidKey||await Notification.requestPermission()!=="granted")return;const a=ts(t.config.firebaseConfig),s=ss(a),o=await os(s,{vapidKey:t.config.firebaseVapidKey});if(!o)return;let n=localStorage.getItem("imkit-deviceId");n||(n=Te(),localStorage.setItem("imkit-deviceId",n)),await t.axios.post(ue.Subscribe,{type:"fcm",token:o,deviceId:n})},async[w.unsubscribe]({state:t}){let e=localStorage.getItem("imkit-deviceId");e||(e=Te(),localStorage.setItem("imkit-deviceId",e)),await t.axios.post(ue.Unsubscribe,{type:"fcm",deviceId:e})},async[w.removeRoomFromFolder]({state:t,commit:e,dispatch:a},s){if(!t.roomIdsInFolders[s])return;const o=t.folders[t.selectedFolderId];if(!o)return;const n=o.id,r=o.roomIds.filter(u=>u!==s);await a(w.updatePref,{key:n,value:{children:r.map(u=>({id:u,type:"room"}))}});const i=new we(n,o.name,r);e(y.updateField,{key:"folders",value:{[n]:i}}),e(y.updateField,{key:"roomIdsInFolders",value:{[s]:!1}}),a(w.aggregateRoomsAndFolders)},async[w.addRoomToFolder]({state:t,commit:e,dispatch:a},{roomId:s,folderId:o}){const n=t.folders[o];if(!n)return;const r=Array.from(new Set([...n.roomIds,s]));await a(w.updatePref,{key:o,value:{children:r.map(u=>({id:u,type:"room"}))}});const i=new we(o,n.name,r);e(y.updateField,{key:"folders",value:{[o]:i}}),e(y.updateField,{key:"roomIdsInFolders",value:{[s]:!0}}),a(w.aggregateRoomsAndFolders)}},Oi={doubleCount:t=>t.count*2},Li={[y.increment](t){t.count++},[y.setState](t,e){Object.assign(t,e)},[y.updateField](t,e){const{key:a,value:s}=e;Object.assign(t[a],s)},[y.deleteField](t,e){const{key:a,value:s}=e;delete t[a][s]},[y.updateRoom](t,e){const{id:a}=e,s=t.rooms[a];s&&Object.assign(s,e)},[y.updateLastRead](t,e){const{roomId:a,uid:s,messageId:o}=e,n=t.rooms[a];n&&(n.lastReadMessageId[s]=o)},[y.concatMessages](t,e){const{messages:a,messageIds:s}=e;Object.assign(t.messages,a),t.sortedMessages=t.sortedMessages.concat(s.map(o=>t.messages[o])).sort((o,n)=>o.createdAt-n.createdAt)},[y.pushMessage](t,e){if(e.roomId!==t.selectedRoomId||t.messages[e.id])return;const a=t.sortedMessages,s=a.length>0?a[a.length-1].groupId:null;e.groupId===s?(t.messageGroupTail[a[a.length-1].id]=!1,t.messageGroupTail[e.id]=!0):(t.messageGroupHead[e.id]=!0,t.messageGroupTail[e.id]=!0),t.messages[e.id]=e;for(let o=t.sortedMessages.length-1;o>=0;o--)if(e.createdAt>=t.sortedMessages[o].createdAt){t.sortedMessages.push(e);break}},[y.replaceMessage](t,e){const{targetMessageId:a,message:s}=e;if(s.roomId===t.selectedRoomId){for(let o=t.sortedMessages.length-1;o>=0;o--)if(t.sortedMessages[o].id===a){t.sortedMessages.splice(o,1);break}if(delete t.messages[a],!t.messages[s.id]){t.messages[s.id]=s;let o=0;for(let i=t.sortedMessages.length-1;i>=0;i--)if(s.createdAt>=t.sortedMessages[i].createdAt){o=i+1;break}t.sortedMessages.splice(o,0,s),o-1>=0&&t.sortedMessages[o-1].groupId===s.groupId?t.messageGroupTail[t.sortedMessages[o-1].id]=!1:t.messageGroupHead[s.id]=!0,o+1<t.sortedMessages.length&&t.sortedMessages[o+1].groupId===s.groupId?t.messageGroupHead[t.sortedMessages[o+1].id]=!1:t.messageGroupTail[s.id]=!0}}},[y.clearChatRoom](t){t.messages={},t.sortedMessages=[],t.numberOfTotalMessages=-1,t.messageGroupHead={},t.messageGroupTail={},t.replyId="",t.navigationTargetId="",t.isRoomInfoVisible=!1,t.isTyping={}},[y.deleteRoom](t,e){delete t.rooms[e],delete t.roomIdsInFolders[e],delete t.selectedRoomIdsForCreateFolder[e],t.sortedRooms=t.sortedRooms.filter(a=>a.id!==e)},[y.recallMessage](t,e){const a=t.sortedMessages;for(let s=t.sortedMessages.length-1;s>=0;s--)if(a[s].id===e.id){a.splice(s,1,e);break}t.messages[e.id]=e},[y.insertUnreadMessage](t,e){const{lastReadMessageId:a,message:s}=e,o=t.sortedMessages;for(let n=t.sortedMessages.length-1;n>=0;n--)if(o[n].id===a){o.splice(n+1,0,s);break}},[y.setMap](t,e){const{mapName:a,key:s,value:o}=e;t[a].set(s,o)},[y.deleteMap](t,e){const{mapName:a,key:s}=e;t[a].delete(s)}},bt={state:Mi,mutations:Li,getters:Oi,actions:Ti,namespaced:!0};function Me(t,e,a){const{url:s}=e,o=s==null?void 0:s.split("?")[0];if(!o)return;const n={};n[o]=t==0?new Date:null,a.commit("imkit/updateField",{key:"isRequesting",value:n})}const Qi=async t=>{localStorage.getItem("imkit-token")&&(localStorage.removeItem("imkit-token"),window.location.reload())};function _i(t,e){const{domain:a}=t,s=Se.create({baseURL:a});return s.interceptors.request.use(o=>{Me(0,o,e);const n=new qe({"IM-Authorization":e.state.imkit.config.token,"IM-Client-Key":e.state.imkit.config.clientKey});return o.headers=n,o},o=>{const{config:n}=o;return Me(1,n,e),Promise.reject(o)}),s.interceptors.response.use(o=>{const{config:n}=o;return Me(1,n,e),o},async o=>{const{config:n}=o;if(Me(1,n,e),o.response.status===401){await Qi();const r=new qe({"IM-Authorization":e.state.imkit.config.token,"IM-Client-Key":e.state.imkit.config.clientKey});return n.headers=r,Se.request(n)}return Promise.reject(o)}),s}function Vi(t,e){const{domain:a,clientKey:s,token:o}=t,n=dt(a,{forceBase64:!0,transports:["websocket"]});return n.on("connect",()=>{n.emit("auth2",o,{CLIENT_KEY:s,Authorization:o},r=>{console.log(r)})}),n.on("disconnect",r=>{console.log(r)}),n.on("chat message",r=>{e.dispatch("imkit/handleMessageFromSocket",z.fromRaw(r))}),n.on("room",r=>{const i=new Re(r);if(!i.id)return;const u={};for(const d of r.members)u[d.id]||(u[d.id]=new ge(d));e.dispatch("imkit/handleRoomFromSocket",i),e.commit("imkit/updateField",{key:"users",value:u})}),n.on("lastRead",r=>{const{roomID:i,memberID:u,messageID:d}=r;e.dispatch("imkit/handleLastReadFromSocket",{roomId:i,uid:u,messageId:d})}),n.on("roomPref",r=>{const{room:i,...u}=r;i&&(e.commit("imkit/updateRoom",{id:i,pref:u}),u.sticky!==void 0&&e.dispatch("imkit/aggregateRoomsAndFolders"))}),n.on("myPrefChange",r=>{e.dispatch("imkit/handlePrefChangeFromSocket",r)}),n.on("myPrefDelete",r=>{e.dispatch("imkit/handlePrefDeleteFromSocket",r)}),n.on("typing",r=>{e.dispatch("imkit/handleTypingFromSocket",r)}),n}const Ki="Close",Ni="Confirm",Pi="Folder Name",Di="Create Folder",Gi="Tag",Yi="Input Tag",Xi="Input Tag Color #02B13F",ji="Download",Wi="{0} unsent a message",zi="Read",Ji="Pin",Hi="Unpin",Zi="Empty Chat",qi="Members",$i="Created At",el="Updated At",tl="Leave Group",sl="Text",ol="Image",al="Video",nl="Sticker",rl="Message",il="{0} sent",ll="{0} sent a {1}",cl="Tap here to open the link.",dl="Type a message...",ul="{0} is typing...",ml="{0} joined the chat",gl="{0} left the chat",pl="{0} invited {1}",Al="{0} kicked {1}",hl="You unsent a message",fl="File size",vl="File",kl="Translation",yl="Search",wl="Location",bl="Send Current Location",xl="No access location permission.",Cl="The request to get location timed out.",Il="The address is unavailable.",Rl="Audio Message",El="No access microphone permission.",Sl="Remove from folder",Fl="Edit Folder",Bl="Add to Folder",Ul="{n} Chatrooms",Ml="Room Name",Tl="Member",Ol="Tag",Ll="Folder",Ql="Attribute",_l={close:Ki,confirm:Ni,folderName:Pi,createFolder:Di,tag:Gi,inputTag:Yi,inputTagPlaceholder:Xi,download:ji,someoneUnsentMessage:Wi,read:zi,pin:Ji,unpin:Hi,emptyChat:Zi,members:qi,createdAt:$i,updatedAt:el,leaveGroup:tl,text:sl,image:ol,video:al,sticker:nl,message:rl,youSent:il,someoneSent:ll,tapOpen:cl,TypeMessage:dl,isTyping:ul,someoneJoinedTheChat:ml,someoneLeftTheChat:gl,someoneInvited:pl,someoneKicked:Al,youUnsentMessage:hl,fileSize:fl,file:vl,translation:kl,search:yl,location:wl,sendCurrentLocation:bl,noAccessLocationPermission:xl,"locationInfoUnavailable.":"Location information is unavailable.",requestLocationTimeout:Cl,addressUnavailable:Il,audio:Rl,noAccessMicrophonePermission:El,removeFromFolder:Sl,editFolder:Fl,addToFolder:Bl,numberOfChatroom:Ul,roomName:Ml,roomMember:Tl,roomPrefTags:Ol,roomPrefFolder:Ll,roomTags:Ql},Vl="關閉",Kl="確認",Nl="資料夾名稱",Pl="建立資料夾",Dl="標籤",Gl="輸入標籤名稱",Yl="請輸入自訂色彩例如 #02B13F",Xl="下載",jl="{0} 已收回訊息",Wl="已讀",zl="置頂",Jl="取消置頂",Hl="沒有成員",Zl="成員",ql="創建時間",$l="更新時間",ec="退出群組",tc="文字",sc="圖片",oc="影片",ac="貼圖",nc="訊息",rc="{0}已傳送",ic="{0}向您傳送了{1}",lc="點選此處以開啟此連結。",cc="輸入訊息...",dc="{0} 正在輸入...",uc="{0}加入聊天",mc="{0}離開聊天",gc="{0}邀請{1}加入",pc="{0}將{1}踢出",Ac="您已收回訊息",hc="檔案大小",fc="檔案",vc="翻譯",kc="搜尋",yc="位置",wc="傳送目前位置",bc="無存取位置權限",xc="請求位置逾時",Cc="無法取得地址",Ic="語音訊息",Rc="無存取麥克風權限",Ec="從資料夾中移除",Sc="編輯資料夾",Fc="新增至資料夾",Bc="{n} 個聊天室",Uc="聊天室名稱",Mc="成員",Tc="標籤",Oc="資料夾",Lc="屬性",Qc={close:Vl,confirm:Kl,folderName:Nl,createFolder:Pl,tag:Dl,inputTag:Gl,inputTagPlaceholder:Yl,download:Xl,someoneUnsentMessage:jl,read:Wl,pin:zl,unpin:Jl,emptyChat:Hl,members:Zl,createdAt:ql,updatedAt:$l,leaveGroup:ec,text:tc,image:sc,video:oc,sticker:ac,message:nc,youSent:rc,someoneSent:ic,tapOpen:lc,TypeMessage:cc,isTyping:dc,someoneJoinedTheChat:uc,someoneLeftTheChat:mc,someoneInvited:gc,someoneKicked:pc,youUnsentMessage:Ac,fileSize:hc,file:fc,translation:vc,search:kc,location:yc,sendCurrentLocation:wc,noAccessLocationPermission:bc,"locationInfoUnavailable.":"無法取得位置資訊",requestLocationTimeout:xc,addressUnavailable:Cc,audio:Ic,noAccessMicrophonePermission:Rc,removeFromFolder:Ec,editFolder:Sc,addToFolder:Fc,numberOfChatroom:Bc,roomName:Uc,roomMember:Mc,roomPrefTags:Tc,roomPrefFolder:Oc,roomTags:Lc},at={"en-US":_l,"zh-TW":Qc},_c=as({legacy:!1,locale:navigator.language in at?navigator.language:"en-US",messages:at}),Vc=t=>{try{return JSON.parse(atob(t.split(".")[1]))}catch{return{id:""}}},Kc={install:async(t,e)=>{const{store:a,config:s}=e;a.hasModule("imkit")||a.registerModule("imkit",bt);const{id:o,_id:n}=Vc(s.token),r=o||n,i=_i(s,a),u=Vi(s,a);a.commit("imkit/setState",{config:s,uid:r,axios:i,socket:u}),t.use(ns()),t.use(rs),t.use(_c),t.directive("src",async(d,p)=>{const{value:g,oldValue:f}=p;if(g.startsWith("data:")){d.src=g;return}const{imageCache:x}=a.state.imkit;if(f===void 0||g!==f){if(x.has(g)){d.src=x.get(g);return}try{d.classList.add("opacity-0");const B=await i.get(g,{responseType:"arraybuffer",onDownloadProgress:S=>{const{total:k}=S;k&&a.commit("imkit/updateField",{key:"downloadProgresses",value:{[g]:S.loaded/k}})}}),K=btoa(new Uint8Array(B.data).reduce((S,k)=>S+String.fromCharCode(k),"")),T=`data:${B.headers["content-type"]};base64,${K}`;x.set(g,T),d.src=T}catch{d.src=g}d.classList.remove("opacity-0")}})}},Nc=[],Ne=is({plugins:Nc,modules:{imkit:bt}}),Pc={class:"flex flex-col divide-y"},Dc={class:"flex items-center gap-4 px-3 h-64px"},Gc={class:"h-50px w-50px relative"},Yc={class:"text-base text-gray-900 overflow-ellipsis overflow-hidden whitespace-nowrap"},Xc={class:"p-2 flex flex-col gap-4 overflow-auto"},jc={class:"text-base text-gray-500 mb-2"},Wc={class:"flex flex-col gap-3"},zc={class:"h-50px w-50px relative"},Jc={class:"flex flex-col text-base overflow-ellipsis overflow-hidden whitespace-nowrap"},Hc={class:"text-base text-gray-900"},Zc={key:0,class:"text-sm text-gray-500"},qc={class:"text-gray-500"},$c={class:"text-gray-500"},ed=O({__name:"ChatRoomInfo",setup(t){W.extend(Ge);const e=Y(),a=h(()=>e.state.imkit.rooms[e.state.imkit.selectedRoomId]),s=h(()=>e.state.imkit.users),o=h(()=>e.state.imkit.uid);return(n,r)=>(l(),m("div",Pc,[c("div",Dc,[c("div",Gc,[a.value.avatars.length===1?(l(),G(ee,{key:0,url:a.value.avatars[0].url,name:a.value.avatars[0].name,class:"relative"},null,8,["url","name"])):(l(),m(V,{key:1},[D(ee,{url:a.value.avatars[1].url,name:a.value.avatars[1].name,class:"h-36px w-36px text-16px absolute top-0 right-0"},null,8,["url","name"]),D(ee,{url:a.value.avatars[0].url,name:a.value.avatars[0].name,class:"h-38px w-38px text-16px absolute bottom-0 left-0 border-2 border-white group-hover:border-gray-100"},null,8,["url","name"])],64))]),c("div",Yc,v(a.value.displayName),1)]),c("div",Xc,[c("div",null,[c("div",jc,v(n.$t("members")),1),c("div",Wc,[(l(!0),m(V,null,Z(a.value.memberIds,i=>(l(),m("div",{key:i,class:"flex items-center gap-4"},[c("div",zc,[D(ee,{url:s.value[i].avatarUrl??"",name:s.value[i].nickname,class:"relative h-50px w-50px text-lg"},null,8,["url","name"])]),c("div",Jc,[c("div",Hc,v(s.value[i].nickname),1),s.value[i].city&&s.value[i].country?(l(),m("div",Zc,v(s.value[i].city)+", "+v(s.value[i].country),1)):C("",!0)])]))),128))])]),c("div",null,[c("div",qc,v(n.$t("createdAt"))+" "+v(I(W)(a.value.createdAt).format("lll")),1),c("div",$c,v(n.$t("updatedAt"))+" "+v(I(W)(a.value.updatedAt).format("lll")),1)]),a.value.type===I(mt).Group?(l(),m("button",{key:0,class:"w-full text-gray-500 border rounded-lg p-2",onClick:r[0]||(r[0]=i=>I(e).dispatch("imkit/removeMembers",{roomId:a.value.id,uids:[o.value]}))},v(n.$t("leaveGroup")),1)):C("",!0)])]))}}),td={class:"flex divide-x relative h-screen"},sd=O({__name:"MainView",setup(t){const e=Y(),a=ct(),s=h(()=>e.state.imkit.selectedRoomId),o=h(()=>e.state.imkit.isRoomInfoVisible),n=h(()=>!!a.query.roomId);return e.commit("imkit/setState",{roomTag:a.query.roomTag??"",selectedRoomId:a.query.roomId??""}),(r,i)=>(l(),m("div",td,[n.value?(l(),m(V,{key:0},[s.value?(l(),G(ot,{key:0,class:"w-full <md:w-full <md:absolute <md:inset-0"})):C("",!0)],64)):(l(),m(V,{key:1},[D(pa,{class:"w-1/4 min-w-300px <md:w-full"}),D(Xe,{name:"slide-fade"},{default:se(()=>[s.value?(l(),G(ot,{key:0,class:"w-3/4 <md:w-full <md:absolute <md:inset-0"})):C("",!0)]),_:1})],64)),s.value&&o.value?(l(),G(ed,{key:2,class:"w-1/4 min-w-300px <md:w-full <md:absolute <md:inset-0"})):C("",!0)]))}});const od=re(sd,[["__scopeId","data-v-c2c2a96f"]]),ad=async()=>{const t=ls(ms);t.use(Ne);const e=cs({history:ds(),routes:[{path:"/",component:od}]});t.use(e);const a=window.location.href,s=a.substring(a.indexOf("?")),o=new URLSearchParams(s.lastIndexOf("#/")==-1?s:s.substring(0,s.lastIndexOf("#/"))),r=await(await fetch("/config.json")).json();if(r.token=o.get("token")||r.token,us("localStorage"))if(o.has("token")){localStorage.setItem("imkit-token",r.token);const i=new URL(window.location.href);i.searchParams.delete("token"),window.history.replaceState(null,"",i.toString())}else localStorage.getItem("imkit-token")&&(r.token=localStorage.getItem("imkit-token")||"");t.use(Kc,{store:Ne,config:r}),t.mount("#app"),Ne.dispatch("imkit/subscribe")};ad();
